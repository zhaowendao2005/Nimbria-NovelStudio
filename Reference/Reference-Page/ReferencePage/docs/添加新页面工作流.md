# 添加新页面工作流

## 工作流概述

本工作流指导如何在 Reference Page 项目中快速添加一个新的独立页面原型。

---

## 📋 前置条件

- ✅ 已完成项目依赖安装（`npm install`）
- ✅ 了解基本的 Vue 3 组件开发
- ✅ 明确要创建的页面功能需求

---

## 🚀 标准工作流程

### 步骤 1：创建页面目录结构

在 `src/pages/` 下创建新的页面目录。

**命名规范：**
- 使用 kebab-case（小写字母+连字符）
- 名称应简洁明确，反映页面功能

**示例：**
```bash
# 创建文本编辑器页面
src/pages/text-editor/

# 创建资源管理器页面
src/pages/resource-manager/

# 创建 LLM 对话页面
src/pages/llm-chat/
```

**目录结构：**
```
src/pages/your-page-name/
├── index.html          # HTML 入口（必需）
├── main.ts            # JavaScript 入口（必需）
├── App.vue            # 页面根组件（必需）
├── components/        # 页面专用组件（可选）
├── composables/       # 页面专用组合式函数（可选）
└── styles/            # 页面专用样式（可选）
```

---

### 步骤 2：创建核心文件

#### 2.1 创建 `index.html`

```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>页面标题</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
```

**关键点：**
- ✅ 保持 `<div id="app"></div>` 作为 Vue 挂载点
- ✅ 引入路径必须是 `./main.ts`（相对路径）
- ✅ 修改 `<title>` 为实际页面名称

---

#### 2.2 创建 `main.ts`

**基础版本（不使用素材库）：**
```typescript
import { createApp } from 'vue'
import App from './App.vue'

const app = createApp(App)
app.mount('#app')
```

**使用 Element Plus 素材库：**
```typescript
import { createApp } from 'vue'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'
import App from './App.vue'

// 如需中文
import zhCn from 'element-plus/dist/locale/zh-cn.mjs'

const app = createApp(App)
app.use(ElementPlus, { locale: zhCn })
app.mount('#app')
```

**使用其他素材库（如 Ant Design Vue）：**
```typescript
import { createApp } from 'vue'
import Antd from 'ant-design-vue'
import 'ant-design-vue/dist/reset.css'
import App from './App.vue'

const app = createApp(App)
app.use(Antd)
app.mount('#app')
```

**关键点：**
- ✅ 必须从 `./App.vue` 导入根组件
- ✅ 素材库的 CSS 必须在这里引入
- ✅ 所有全局插件在这里注册

---

#### 2.3 创建 `App.vue`

**基础模板：**
```vue
<template>
  <div class="page-container">
    <h1>{{ pageTitle }}</h1>
    <!-- 页面内容 -->
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const pageTitle = ref('我的页面标题')

// 页面逻辑
</script>

<style scoped>
.page-container {
  width: 100%;
  min-height: 100vh;
  padding: 20px;
}

/* 页面样式 */
</style>
```

**使用 Element Plus 的模板：**
```vue
<template>
  <div class="page-container">
    <el-card>
      <template #header>
        <h2>{{ pageTitle }}</h2>
      </template>
      
      <!-- 使用 Element Plus 组件 -->
      <el-form :model="formData" label-width="120px">
        <el-form-item label="示例输入">
          <el-input v-model="formData.example" />
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="handleSubmit">
            提交
          </el-button>
        </el-form-item>
      </el-form>
    </el-card>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { ElMessage } from 'element-plus'

const pageTitle = ref('表单示例')
const formData = reactive({
  example: ''
})

const handleSubmit = () => {
  ElMessage.success('提交成功！')
  console.log(formData)
}
</script>

<style scoped>
.page-container {
  padding: 40px;
  background: #f5f5f5;
  min-height: 100vh;
}
</style>
```

---

### 步骤 3：添加构建脚本（可选但推荐）

在 `package.json` 的 `scripts` 中添加：

```json
{
  "scripts": {
    "dev:your-page-name": "vite --open /src/pages/your-page-name/index.html",
    "build:your-page-name": "cross-env BUILD_PAGE=your-page-name vite build"
  }
}
```

**示例：**
```json
{
  "scripts": {
    "dev:text-editor": "vite --open /src/pages/text-editor/index.html",
    "build:text-editor": "cross-env BUILD_PAGE=text-editor vite build"
  }
}
```

---

### 步骤 4：开发与测试

#### 4.1 启动开发服务器

**方式一：使用自定义脚本（推荐）**
```bash
npm run dev:your-page-name
```

**方式二：手动访问**
```bash
npm run dev
# 然后在浏览器访问：
# http://localhost:5173/src/pages/your-page-name/index.html
```

#### 4.2 开发调试

- ✅ 使用浏览器开发者工具调试
- ✅ 支持 Vue DevTools
- ✅ 支持热更新（修改代码后自动刷新）

---

### 步骤 5：构建生产版本

#### 5.1 执行构建

**构建单个页面：**
```bash
npm run build:your-page-name
```

**构建所有页面：**
```bash
npm run build
```

#### 5.2 检查构建结果

构建输出位置：`dist/your-page-name.html`

**验证清单：**
- ✅ 文件是否存在于 `dist/` 目录
- ✅ 在浏览器中打开 HTML 文件，功能是否正常
- ✅ 所有样式和交互是否正确
- ✅ 查看文件大小是否合理

---

## 🎯 高级技巧

### 使用共享组件

#### 1. 创建共享组件

在 `src/shared/components/` 下创建：

```vue
<!-- src/shared/components/CommonButton.vue -->
<template>
  <button class="common-btn" :class="type" @click="handleClick">
    <slot></slot>
  </button>
</template>

<script setup lang="ts">
defineProps<{
  type?: 'primary' | 'secondary' | 'danger'
}>()

const emit = defineEmits<{
  click: []
}>()

const handleClick = () => {
  emit('click')
}
</script>

<style scoped>
.common-btn {
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  border: none;
}

.primary {
  background: #409eff;
  color: white;
}
</style>
```

#### 2. 在页面中使用

```vue
<script setup lang="ts">
import CommonButton from '@shared/components/CommonButton.vue'
</script>

<template>
  <CommonButton type="primary" @click="handleAction">
    点击我
  </CommonButton>
</template>
```

---

### 使用共享工具函数

#### 1. 创建工具函数

```typescript
// src/shared/utils/format.ts
export function formatDate(date: Date): string {
  return date.toLocaleDateString('zh-CN')
}

export function formatCurrency(amount: number): string {
  return `¥${amount.toFixed(2)}`
}
```

#### 2. 在页面中使用

```vue
<script setup lang="ts">
import { formatDate, formatCurrency } from '@shared/utils/format'

const today = formatDate(new Date())
const price = formatCurrency(99.99)
</script>
```

---

### 添加素材库依赖

#### 1. 安装素材库

```bash
# Element Plus
npm install element-plus

# Ant Design Vue
npm install ant-design-vue

# Naive UI
npm install naive-ui

# Vant（移动端）
npm install vant
```

#### 2. 在 main.ts 中引入

参考步骤 2.2 中的示例。

---

## 📐 页面类型模板

### 模板 1：表单页面

适用于数据收集、设置配置等场景。

```vue
<template>
  <div class="form-page">
    <el-card>
      <template #header>
        <h2>{{ title }}</h2>
      </template>
      
      <el-form 
        ref="formRef"
        :model="formData" 
        :rules="rules"
        label-width="120px"
      >
        <el-form-item label="字段1" prop="field1">
          <el-input v-model="formData.field1" />
        </el-form-item>
        
        <el-form-item label="字段2" prop="field2">
          <el-select v-model="formData.field2">
            <el-option label="选项1" value="1" />
            <el-option label="选项2" value="2" />
          </el-select>
        </el-form-item>
        
        <el-form-item>
          <el-button type="primary" @click="handleSubmit">
            提交
          </el-button>
          <el-button @click="handleReset">重置</el-button>
        </el-form-item>
      </el-form>
    </el-card>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import type { FormInstance, FormRules } from 'element-plus'
import { ElMessage } from 'element-plus'

const title = ref('表单页面')
const formRef = ref<FormInstance>()

const formData = reactive({
  field1: '',
  field2: ''
})

const rules: FormRules = {
  field1: [
    { required: true, message: '请输入字段1', trigger: 'blur' }
  ],
  field2: [
    { required: true, message: '请选择字段2', trigger: 'change' }
  ]
}

const handleSubmit = async () => {
  if (!formRef.value) return
  
  await formRef.value.validate((valid) => {
    if (valid) {
      console.log('表单数据：', formData)
      ElMessage.success('提交成功！')
    } else {
      ElMessage.error('请检查表单填写')
    }
  })
}

const handleReset = () => {
  formRef.value?.resetFields()
}
</script>

<style scoped>
.form-page {
  padding: 40px;
  background: #f5f5f5;
  min-height: 100vh;
}
</style>
```

---

### 模板 2：列表/表格页面

适用于数据展示、内容管理等场景。

```vue
<template>
  <div class="table-page">
    <el-card>
      <template #header>
        <div class="header">
          <h2>{{ title }}</h2>
          <el-button type="primary" @click="handleAdd">
            添加
          </el-button>
        </div>
      </template>
      
      <el-table :data="tableData" stripe>
        <el-table-column prop="id" label="ID" width="80" />
        <el-table-column prop="name" label="名称" />
        <el-table-column prop="status" label="状态" />
        <el-table-column label="操作" width="180">
          <template #default="{ row }">
            <el-button size="small" @click="handleEdit(row)">
              编辑
            </el-button>
            <el-button 
              size="small" 
              type="danger" 
              @click="handleDelete(row)"
            >
              删除
            </el-button>
          </template>
        </el-table-column>
      </el-table>
    </el-card>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { ElMessage, ElMessageBox } from 'element-plus'

interface TableItem {
  id: number
  name: string
  status: string
}

const title = ref('数据列表')
const tableData = ref<TableItem[]>([
  { id: 1, name: '项目A', status: '进行中' },
  { id: 2, name: '项目B', status: '已完成' },
])

const handleAdd = () => {
  ElMessage.info('添加功能')
}

const handleEdit = (row: TableItem) => {
  ElMessage.info(`编辑：${row.name}`)
}

const handleDelete = async (row: TableItem) => {
  try {
    await ElMessageBox.confirm(
      `确定要删除 ${row.name} 吗？`,
      '警告',
      { type: 'warning' }
    )
    
    tableData.value = tableData.value.filter(item => item.id !== row.id)
    ElMessage.success('删除成功')
  } catch {
    // 用户取消
  }
}
</script>

<style scoped>
.table-page {
  padding: 40px;
  background: #f5f5f5;
  min-height: 100vh;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
</style>
```

---

### 模板 3：编辑器页面

适用于富文本编辑、代码编辑等场景。

```vue
<template>
  <div class="editor-page">
    <div class="toolbar">
      <el-button type="primary" @click="handleSave">
        保存
      </el-button>
      <el-button @click="handleClear">清空</el-button>
    </div>
    
    <div class="editor-container">
      <textarea
        v-model="content"
        class="editor"
        placeholder="在此输入内容..."
      />
    </div>
    
    <div class="preview">
      <h3>预览</h3>
      <div class="preview-content">{{ content }}</div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { ElMessage } from 'element-plus'

const content = ref('')

const handleSave = () => {
  console.log('保存内容：', content.value)
  ElMessage.success('保存成功！')
}

const handleClear = () => {
  content.value = ''
  ElMessage.info('已清空')
}
</script>

<style scoped>
.editor-page {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: #f5f5f5;
}

.toolbar {
  padding: 16px;
  background: white;
  border-bottom: 1px solid #e0e0e0;
}

.editor-container {
  flex: 1;
  padding: 20px;
}

.editor {
  width: 100%;
  height: 100%;
  padding: 16px;
  font-size: 14px;
  line-height: 1.6;
  border: 1px solid #ddd;
  border-radius: 4px;
  resize: none;
}

.preview {
  height: 200px;
  padding: 20px;
  background: white;
  border-top: 1px solid #e0e0e0;
}

.preview-content {
  padding: 16px;
  background: #fafafa;
  border-radius: 4px;
  min-height: 100px;
}
</style>
```

---

## ⚠️ 注意事项

### 1. 页面独立性
- ❌ **禁止**页面之间相互引用组件
- ✅ 共享代码必须放在 `src/shared/` 目录
- ✅ 每个页面应该能独立构建和运行

### 2. 资源管理
- ⚠️ 图片会被 Base64 编码内联，避免使用大图
- ⚠️ 素材库会完整打包，单个 HTML 文件可能较大
- ✅ 适度使用外部依赖，保持文件大小合理

### 3. 样式作用域
- ✅ 使用 `<style scoped>` 避免样式污染
- ✅ 全局样式放在 `src/shared/styles/`
- ❌ 避免在 `main.ts` 中导入过多全局样式

### 4. 类型安全
- ✅ 充分利用 TypeScript 类型检查
- ✅ 为组件 props 定义类型
- ✅ 为函数参数和返回值定义类型

---

## 🔍 常见问题排查

### 问题 1：构建后页面空白

**可能原因：**
- Vue 未正确挂载到 `#app`
- main.ts 中有语法错误
- 缺少必要的依赖

**解决方法：**
1. 检查 `index.html` 是否有 `<div id="app"></div>`
2. 检查 `main.ts` 中的 `app.mount('#app')`
3. 查看浏览器控制台的错误信息

---

### 问题 2：素材库样式不生效

**可能原因：**
- CSS 未正确导入
- 构建配置问题

**解决方法：**
1. 确保在 `main.ts` 中导入了 CSS
2. 检查 `vite.config.ts` 中的 `cssCodeSplit: false`
3. 重新构建

---

### 问题 3：图片无法显示

**可能原因：**
- 图片路径错误
- 图片过大导致内联失败

**解决方法：**
1. 使用相对路径或 `@shared/assets/` 别名
2. 压缩图片大小
3. 考虑使用外部图片链接（CDN）

---

## 📊 构建优化建议

### 1. 减小文件大小
- 按需导入素材库组件（如 Element Plus 的按需引入）
- 压缩图片资源
- 移除未使用的依赖

### 2. 提升加载速度
- 优化初始渲染逻辑
- 使用懒加载（动态 import）
- 避免在 `main.ts` 中执行耗时操作

### 3. 代码质量
- 运行 `npm run lint` 检查代码规范
- 使用 TypeScript 类型检查
- 添加必要的注释

---

## ✅ 完成检查清单

在完成新页面开发后，请检查：

- [ ] 页面能在开发模式下正常运行
- [ ] 页面能成功构建为单个 HTML 文件
- [ ] 构建后的 HTML 文件在浏览器中功能正常
- [ ] 所有交互功能都已测试
- [ ] 代码符合项目规范（通过 lint 检查）
- [ ] 已添加相应的构建脚本到 `package.json`
- [ ] 文件大小合理（建议 < 5MB）
- [ ] 已清理临时文件和调试代码

---

## 📚 相关资源

- [Vue 3 官方文档](https://cn.vuejs.org/)
- [Vite 官方文档](https://cn.vitejs.dev/)
- [Element Plus 官方文档](https://element-plus.org/zh-CN/)
- [TypeScript 官方文档](https://www.typescriptlang.org/zh/)

---

**工作流版本：** v1.0  
**最后更新：** 2025-10-03




