# JiuZhang LLMé…ç½®ç³»ç»Ÿäº¤äº’è®¾è®¡åˆ†æ

> åˆ†ææ—¶é—´ï¼š2025å¹´10æœˆ11æ—¥  
> ç›®æ ‡ï¼šæ·±åº¦ç†è§£JiuZhangé¡¹ç›®çš„LLMé…ç½®äº¤äº’æµç¨‹ï¼Œä¸ºNimbriaé¡¹ç›®æä¾›å‚è€ƒ

---

## ğŸ“‹ ç›®å½•

1. [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
2. [é¡µé¢ç»“æ„](#é¡µé¢ç»“æ„)
3. [æ ¸å¿ƒäº¤äº’æµç¨‹](#æ ¸å¿ƒäº¤äº’æµç¨‹)
4. [æ¨¡å‹å¡ç‰‡äº¤äº’](#æ¨¡å‹å¡ç‰‡äº¤äº’)
5. [æ·»åŠ æä¾›å•†æµç¨‹](#æ·»åŠ æä¾›å•†æµç¨‹)
6. [æ¨¡å‹é…ç½®æµç¨‹](#æ¨¡å‹é…ç½®æµç¨‹)
7. [æä¾›å•†é…ç½®æµç¨‹](#æä¾›å•†é…ç½®æµç¨‹)
8. [æ´»åŠ¨æ¨¡å‹ç®¡ç†](#æ´»åŠ¨æ¨¡å‹ç®¡ç†)
9. [æ•°æ®æµä¸çŠ¶æ€ç®¡ç†](#æ•°æ®æµä¸çŠ¶æ€ç®¡ç†)
10. [äº¤äº’ç»†èŠ‚æ€»ç»“](#äº¤äº’ç»†èŠ‚æ€»ç»“)

---

## 1. æ•´ä½“æ¶æ„

### 1.1 æ–‡ä»¶ç»„ç»‡ç»“æ„

```
Settings/
â”œâ”€â”€ SettingsSidebar.vue              # å·¦ä¾§å¯¼èˆªæ 
â”œâ”€â”€ ModelProviders.vue               # ä¸»å®¹å™¨ï¼ˆæä¾›å•†åˆ—è¡¨é¡µï¼‰
â”œâ”€â”€ ModelProviderCard.vue            # å•ä¸ªæä¾›å•†å¡ç‰‡
â”œâ”€â”€ AddProviderModal.vue             # æ·»åŠ æä¾›å•†å¯¹è¯æ¡†ï¼ˆå®Œæ•´æµç¨‹ï¼‰
â”œâ”€â”€ AddOpenAIModal.vue               # å¿«é€Ÿæ·»åŠ OpenAIå…¼å®¹æœåŠ¡
â”œâ”€â”€ ModelConfigModal.vue             # å•ä¸ªæ¨¡å‹é…ç½®å¯¹è¯æ¡†
â”œâ”€â”€ ProviderConfigModal.vue          # æä¾›å•†é…ç½®å¯¹è¯æ¡†
â”œâ”€â”€ AdvancedSettings.vue             # é«˜çº§è®¾ç½®é¡µé¢
â””â”€â”€ Advanced/
    â””â”€â”€ CacheManagement.vue          # ç¼“å­˜ç®¡ç†ç»„ä»¶
```

### 1.2 åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SettingsPage.vue (æ ¹é¡µé¢)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Sidebar    â”‚  â”‚ Content Area     â”‚  â”‚
â”‚  â”‚            â”‚  â”‚ - ModelProviders â”‚  â”‚
â”‚  â”‚ å·¥ä½œç©ºé—´   â”‚  â”‚ - Workspace      â”‚  â”‚
â”‚  â”‚ æ¨¡å‹æä¾›å•† â”‚  â”‚ - Appearance     â”‚  â”‚
â”‚  â”‚ å¤–è§‚       â”‚  â”‚ - Advanced       â”‚  â”‚
â”‚  â”‚ é«˜çº§       â”‚  â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        stores/settings.ts (çŠ¶æ€å±‚)      â”‚
â”‚  - providers[]                          â”‚
â”‚  - activeModels{}                       â”‚
â”‚  - loading, error, retryCount          â”‚
â”‚  - modelRefreshStatus{}                 â”‚
â”‚  - validationErrors{}                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Service/settings/service.ts         â”‚
â”‚  SettingsService (ä¸šåŠ¡é€»è¾‘å±‚)           â”‚
â”‚  - getProviders()                       â”‚
â”‚  - addProvider()                        â”‚
â”‚  - refreshProviderModels()              â”‚
â”‚  - validateProviderConfig()             â”‚
â”‚  - testProviderConnection()             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Service/llm-provider/service.ts       â”‚
â”‚  LlmProviderService (æ•°æ®è®¿é—®å±‚)        â”‚
â”‚  - getAll()                             â”‚
â”‚  - add(), update(), remove()            â”‚
â”‚  - activateProvider()                   â”‚
â”‚  - setActiveModel()                     â”‚
â”‚  â””â”€â†’ IPCè°ƒç”¨ â†’ Electron Main Process   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. é¡µé¢ç»“æ„

### 2.1 ModelProviders.vueï¼ˆä¸»é¡µé¢ï¼‰

**å¸ƒå±€ç»“æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒŸ æ´»åŠ¨æ¨¡å‹ (å›ºå®šé¡¶éƒ¨)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ’¡ æ´»åŠ¨æ¨¡å‹                                  â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚ â”‚ LLM â”‚ â”‚TEXT_â”‚ â”‚TEXT_TO_    â”‚  ...        â”‚   â”‚
â”‚  â”‚ â”‚     â”‚ â”‚EMBEDâ”‚ â”‚SPEECH      â”‚             â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜ï¸ å·²å®‰è£…çš„æä¾›å•†                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ´»åŠ¨ (provider.status === 'active')         â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚ â”‚  ModelProviderCard (OpenAI)           â”‚   â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å¯ç”¨ (provider.status === 'available')      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚ â”‚  ModelProviderCard (Anthropic)        â”‚   â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å·²å®‰è£… (provider.status === 'inactive')     â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚ â”‚  ModelProviderCard (Custom)           â”‚   â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â• æ·»åŠ æ›´å¤šæä¾›å•†                                   â”‚
â”‚  [â• å®‰è£…æ›´å¤šæ¨¡å‹æä¾›å•†]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹æ€§ï¼š**
- é¡¶éƒ¨æ˜¾ç¤ºå½“å‰æ‰€æœ‰**æ´»åŠ¨çš„æ¨¡å‹ç±»å‹**ï¼ˆchipæ ‡ç­¾ï¼‰
- æä¾›å•†æŒ‰**çŠ¶æ€åˆ†ç»„**ï¼šactive â†’ available â†’ inactive
- ç©ºçŠ¶æ€æç¤ºï¼š"æš‚æ— å·²å®‰è£…çš„æ¨¡å‹æä¾›å•†"
- loading overlay å…¨å±åŠ è½½

---

## 3. æ ¸å¿ƒäº¤äº’æµç¨‹

### 3.1 åˆå§‹åŒ–æµç¨‹

```
ç”¨æˆ·æ‰“å¼€è®¾ç½®é¡µé¢
    â†“
SettingsPage mounted
    â†“
æ ¹æ®activeCategoryé€‰æ‹©å†…å®¹
    â†“
ModelProviders mounted
    â†“
settingsStore.initialize()
    â”œâ”€â†’ loadCategories() (åŒæ­¥)
    â”œâ”€â†’ setupEventListeners() (è®¾ç½®IPCäº‹ä»¶ç›‘å¬)
    â”œâ”€â†’ loadProviders() (å¼‚æ­¥)
    â””â”€â†’ loadActiveModels() (å¼‚æ­¥)
         â†“
    è°ƒç”¨ settingsService.getProviders()
         â†“
    è°ƒç”¨ llmProviderService.getAll()
         â†“
    IPC: 'llm-provider:get-all'
         â†“
    è¿”å›providersæ•°ç»„
         â†“
    æ›´æ–°store: providers.value = data
         â†“
    UIåˆ·æ–° â†’ æ˜¾ç¤ºæä¾›å•†å¡ç‰‡åˆ—è¡¨
```

**é”™è¯¯å¤„ç†ï¼š**
- åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤º`error.value`
- æ˜¾ç¤ºé‡è¯•æŒ‰é’®ï¼ˆå¦‚æœ`canRetry.value`ä¸ºtrueï¼‰
- é‡è¯•è®¡æ•°å™¨`retryCount`ï¼Œæœ€å¤šé‡è¯•3æ¬¡

---

## 4. æ¨¡å‹å¡ç‰‡äº¤äº’ (ModelProviderCard.vue)

### 4.1 å¡ç‰‡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¦ Provider Header                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LOGO â”‚  â”‚ OpenAI                     â”‚  â”‚ âš™ï¸ ğŸ”„ âš¡â”‚ â”‚
â”‚ â”‚      â”‚  â”‚ OpenAIå®˜æ–¹APIæœåŠ¡          â”‚  â”‚        â”‚ â”‚
â”‚ â”‚ ğŸ¤–   â”‚  â”‚ âœ…æ´»åŠ¨ | 15ä¸ªæ¨¡å‹ | 2å°æ—¶å‰ â”‚  â”‚        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”½ [æ˜¾ç¤ºæ¨¡å‹] â–¼ (q-expansion-item)                    â”‚
â”‚                                                        â”‚
â”‚ å½“å±•å¼€æ—¶ï¼š                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ğŸ¤– LLM (5ä¸ª)                                    â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚ â”‚ âœ… gpt-3.5-turbo                âš¡è®¾ä¸ºæ´»åŠ¨ âš™â”‚  â”‚  â”‚
â”‚ â”‚ â”‚    [âœ…æ´»åŠ¨] [ğŸ“è‡ªå®šä¹‰]                     â”‚   â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚ â”‚ âŒ gpt-4                        âš¡è®¾ä¸ºæ´»åŠ¨ âš™â”‚  â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚ ...                                             â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ğŸ“ TEXT_EMBEDDING (3ä¸ª)                         â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚ â”‚ âŒ text-embedding-ada-002     âš¡è®¾ä¸ºæ´»åŠ¨ âš™â”‚  â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚ ...                                             â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å¡ç‰‡æ“ä½œ

**é¡¶éƒ¨æ“ä½œæŒ‰é’®ï¼š**

| æŒ‰é’® | å›¾æ ‡ | åŠŸèƒ½ | äº‹ä»¶ |
|------|------|------|------|
| é…ç½®æä¾›å•† | âš™ï¸ `settings` | æ‰“å¼€æä¾›å•†é…ç½®å¯¹è¯æ¡† | `@click="$emit('configure', provider)"` |
| åˆ·æ–°æ¨¡å‹ | ğŸ”„ `refresh` | åˆ·æ–°æ­¤æä¾›å•†çš„æ¨¡å‹åˆ—è¡¨ | `@click="refreshModels"` |
| æ¿€æ´»å¼€å…³ | âš¡ `q-toggle` | æ¿€æ´»/åœç”¨æä¾›å•† | `@update:model-value="toggleStatus"` |

**åˆ·æ–°æ¨¡å‹æµç¨‹ï¼š**

```
ç”¨æˆ·ç‚¹å‡»ğŸ”„åˆ·æ–°æŒ‰é’®
    â†“
refreshModels()
    â†“
refreshing.value = true
    â†“
settingsStore.refreshProviderModels(provider.id)
    â†“
modelRefreshStatus[providerId] = 'loading'
    â†“
settingsService.refreshProviderModels(providerId)
    â”œâ”€â†’ è·å–providerä¿¡æ¯
    â”œâ”€â†’ è°ƒç”¨ llmClient.getModels()
    â”‚   (ä½¿ç”¨providerçš„apiKeyã€baseUrl)
    â”œâ”€â†’ å°†è¿”å›çš„æ¨¡å‹æŒ‰ç±»å‹åˆ†ç±»
    â”‚   (LLM, TEXT_EMBEDDING, etc.)
    â””â”€â†’ æ›´æ–°provider.supportedModels
         â†“
modelRefreshStatus[providerId] = 'success'
lastRefreshTime[providerId] = new Date()
    â†“
é‡æ–°åŠ è½½providers
    â†“
UIæ›´æ–°ï¼Œæ˜¾ç¤ºæ–°æ¨¡å‹åˆ—è¡¨
```

### 4.3 æ¨¡å‹åˆ—è¡¨äº¤äº’

**q-expansion-itemå±•å¼€/æ”¶èµ·ï¼š**

```
åˆå§‹çŠ¶æ€ï¼šæŠ˜å 
    â†“
ç”¨æˆ·ç‚¹å‡» "æ˜¾ç¤ºæ¨¡å‹ â–¼ (15ä¸ªæ¨¡å‹)"
    â†“
expanded.value = true
    â†“
æ˜¾ç¤ºæ¨¡å‹åˆ—è¡¨ï¼ˆæŒ‰ç±»å‹åˆ†ç»„ï¼‰
```

**æ¨¡å‹é¡¹çŠ¶æ€ï¼š**

```
æ¯ä¸ªæ¨¡å‹æ˜¾ç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ…/âŒ gpt-3.5-turbo                    â”‚
â”‚    [âœ…æ´»åŠ¨] [ğŸ“è‡ªå®šä¹‰]                 â”‚
â”‚                      [âš¡Toggle] [âš™ï¸]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

çŠ¶æ€åˆ¤æ–­ï¼š
- isActiveModel(): æ£€æŸ¥æ­¤æ¨¡å‹æ˜¯å¦ä¸ºå½“å‰ç±»å‹çš„æ´»åŠ¨æ¨¡å‹
  activeModels[modelType] === 'providerId.modelName'
  
- hasCustomConfig: model.configå­˜åœ¨
  è¡¨ç¤ºæ­¤æ¨¡å‹æœ‰è‡ªå®šä¹‰é…ç½®ï¼ˆè¦†ç›–provideré»˜è®¤é…ç½®ï¼‰
```

**æ¨¡å‹æ“ä½œï¼š**

1. **è®¾ä¸ºæ´»åŠ¨æ¨¡å‹ (q-toggle)**
   ```
   ç”¨æˆ·åˆ‡æ¢toggle
       â†“
   toggleActiveModel(modelType, modelName, active)
       â†“
   if (active):
       settingsStore.setActiveModel(modelType, providerId, modelName)
           â†“
       åˆ›å»ºmodelId: 'providerId.modelName'
           â†“
       llmProviderService.setActiveModel(modelType, providerId, modelName)
           â†“
       IPC: 'llm-provider:set-active-model'
           â†“
       activeModels[modelType] = 'providerId.modelName'
   else:
       settingsStore.clearActiveModel(modelType)
   ```

2. **é…ç½®æ¨¡å‹å‚æ•° (âš™ï¸)**
   ```
   ç”¨æˆ·ç‚¹å‡»âš™ï¸æŒ‰é’®
       â†“
   openModelConfig(modelName)
       â†“
   emit('model-config', provider, modelName)
       â†“
   ModelProvidersæ¥æ”¶äº‹ä»¶
       â†“
   selectedProvider = provider
   selectedModelName = modelName
   selectedModelConfig = æŸ¥æ‰¾model.config
       â†“
   showModelConfigModal = true
       â†“
   æ‰“å¼€ ModelConfigModal
   ```

---

## 5. æ·»åŠ æä¾›å•†æµç¨‹ (AddProviderModal.vue)

### 5.1 ä¸‰æ­¥éª¤æµç¨‹

JiuZhangä½¿ç”¨**q-stepper**å®ç°ä¸‰æ­¥æµç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤1: åŸºæœ¬ä¿¡æ¯                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ˜¾ç¤ºåç§° *  [              ]     â”‚ â”‚
â”‚ â”‚ å†…éƒ¨åç§° *  [              ]     â”‚ â”‚
â”‚ â”‚ æè¿°        [              ]     â”‚ â”‚
â”‚ â”‚ APIåœ°å€ *   [              ] â“  â”‚ â”‚
â”‚ â”‚ APIå¯†é’¥ *   [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢] ğŸ‘ â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚            [ä¸‹ä¸€æ­¥ â†’]            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ éªŒè¯é€šè¿‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤2: é»˜è®¤é…ç½®                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¯·æ±‚è¶…æ—¶(ms)      [30000      ]  â”‚ â”‚
â”‚ â”‚ æœ€å¤§é‡è¯•æ¬¡æ•°      [3          ]  â”‚ â”‚
â”‚ â”‚ é»˜è®¤ä¸Šä¸‹æ–‡é•¿åº¦    [4096       ]  â”‚ â”‚
â”‚ â”‚ é»˜è®¤æœ€å¤§Token     [4096       ]  â”‚ â”‚
â”‚ â”‚ å®Œæˆæ¨¡å¼          [å¯¹è¯â–¼]        â”‚ â”‚
â”‚ â”‚ Agentæ€è€ƒæ”¯æŒ     [ä¸æ”¯æŒâ–¼]      â”‚ â”‚
â”‚ â”‚ å‡½æ•°è°ƒç”¨æ”¯æŒ      [ä¸æ”¯æŒâ–¼]      â”‚ â”‚
â”‚ â”‚ ç»“æ„åŒ–è¾“å‡ºæ”¯æŒ    [ä¸æ”¯æŒâ–¼]      â”‚ â”‚
â”‚ â”‚ ç³»ç»Ÿæç¤ºåˆ†éš”ç¬¦    [\n\n      ]   â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚    [â† ä¸Šä¸€æ­¥]    [ä¸‹ä¸€æ­¥ â†’]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤3: è¿æ¥æµ‹è¯•                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æµ‹è¯•è¿æ¥å¹¶è‡ªåŠ¨è·å–æ¨¡å‹åˆ—è¡¨        â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚ æœªæµ‹è¯•æ—¶ï¼š                        â”‚ â”‚
â”‚ â”‚   ğŸ“¡ å›¾æ ‡                         â”‚ â”‚
â”‚ â”‚   "ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•è¿æ¥"      â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚ æµ‹è¯•ä¸­ï¼š                          â”‚ â”‚
â”‚ â”‚   â³ Spinner                      â”‚ â”‚
â”‚ â”‚   "æ­£åœ¨æµ‹è¯•è¿æ¥..."               â”‚ â”‚
â”‚ â”‚   "éªŒè¯é…ç½®... / æµ‹è¯•è¿æ¥... /    â”‚ â”‚
â”‚ â”‚    è·å–æ¨¡å‹åˆ—è¡¨..."               â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚ æˆåŠŸæ—¶ï¼š                          â”‚ â”‚
â”‚ â”‚   âœ… æ¨ªå¹… (ç»¿è‰²)                  â”‚ â”‚
â”‚ â”‚   "è¿æ¥æµ‹è¯•æˆåŠŸ"                  â”‚ â”‚
â”‚ â”‚   "å»¶è¿Ÿ: 120ms | å‘ç°æ¨¡å‹: 15ä¸ª"  â”‚ â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚   â”‚ å‘ç°çš„æ¨¡å‹:                â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ â€¢ gpt-3.5-turbo           â”‚ â”‚ â”‚
â”‚ â”‚   â”‚   ä¸Šä¸‹æ–‡:4096 | æœ€å¤§Token: â”‚ â”‚ â”‚
â”‚ â”‚   â”‚   4096                    â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ â€¢ gpt-4                   â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ â€¢ ...                     â”‚ â”‚ â”‚
â”‚ â”‚   â”‚ è¿˜æœ‰10ä¸ªæ¨¡å‹...            â”‚ â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚ å¤±è´¥æ—¶ï¼š                          â”‚ â”‚
â”‚ â”‚   âŒ æ¨ªå¹… (çº¢è‰²)                  â”‚ â”‚
â”‚ â”‚   "è¿æ¥æµ‹è¯•å¤±è´¥"                  â”‚ â”‚
â”‚ â”‚   "é”™è¯¯: æ— æ³•è¿æ¥åˆ°APIç«¯ç‚¹"       â”‚ â”‚
â”‚ â”‚                                  â”‚ â”‚
â”‚ â”‚    [â† ä¸Šä¸€æ­¥]  [æµ‹è¯•è¿æ¥]        â”‚ â”‚
â”‚ â”‚    (æˆåŠŸå) [âœ… å®Œæˆ]             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 æµ‹è¯•è¿æ¥è¯¦ç»†æµç¨‹

```
æ­¥éª¤3 - ç”¨æˆ·ç‚¹å‡»"æµ‹è¯•è¿æ¥"
    â†“
testConnection()
    â”œâ”€â†’ testStarted = true
    â”œâ”€â†’ testing = true
    â”œâ”€â†’ testingStatus = 'éªŒè¯é…ç½®...'
    â”‚
    â”œâ”€â†’ è°ƒç”¨ settingsStore.validateProvider(form)
    â”‚       â†“
    â”‚   InputValidator.validateProviderConfig()
    â”‚       â†“
    â”‚   éªŒè¯ï¼šdisplayName, name, baseUrl, apiKey
    â”‚       â†“
    â”‚   è¿”å› { isValid, errors[], warnings[] }
    â”‚
    â”œâ”€â†’ testingStatus = 'æµ‹è¯•è¿æ¥...'
    â”‚
    â”œâ”€â†’ import LlmClient
    â”‚       â†“
    â”‚   llmClient.testConnection({
    â”‚       apiKey, baseUrl, timeout, maxRetries
    â”‚   })
    â”‚       â†“
    â”‚   å®é™…å‘é€HTTPè¯·æ±‚åˆ°API
    â”‚       â†“
    â”‚   è¿”å› { success, latency, error? }
    â”‚
    â”œâ”€â†’ å¦‚æœè¿æ¥æˆåŠŸï¼š
    â”‚   testingStatus = 'è·å–æ¨¡å‹åˆ—è¡¨...'
    â”‚       â†“
    â”‚   llmClient.getModels({...})
    â”‚       â†“
    â”‚   è¿”å›æ¨¡å‹æ•°ç»„
    â”‚       â†“
    â”‚   discoveredModels = models
    â”‚       â†“
    â”‚   testResult = {
    â”‚       success: true,
    â”‚       latency: 120,
    â”‚       modelsCount: 15
    â”‚   }
    â”‚
    â””â”€â†’ testing = false
        testingStatus = ''
```

### 5.3 ä¿å­˜æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"âœ… å®Œæˆ"
    â†“
saveProvider()
    â”œâ”€â†’ saving = true
    â”‚
    â”œâ”€â†’ æ„å»ºnewProviderå¯¹è±¡ï¼š
    â”‚   {
    â”‚       name: form.name,
    â”‚       displayName: form.displayName,
    â”‚       description: form.description,
    â”‚       status: 'available',
    â”‚       apiKey: form.apiKey,
    â”‚       baseUrl: form.baseUrl,
    â”‚       defaultConfig: form.defaultConfig,
    â”‚       supportedModels: categorizeDiscoveredModels()
    â”‚   }
    â”‚
    â”œâ”€â†’ categorizeDiscoveredModels():
    â”‚   éå†discoveredModels[]
    â”‚       â†“
    â”‚   æ ¹æ®æ¨¡å‹åç§°æ¨æ–­ç±»å‹ï¼š
    â”‚   - åŒ…å«'embedding' â†’ TEXT_EMBEDDING
    â”‚   - åŒ…å«'whisper' â†’ SPEECH_TO_TEXT
    â”‚   - åŒ…å«'tts' â†’ TEXT_TO_SPEECH
    â”‚   - åŒ…å«'dall-e' â†’ IMAGE_GENERATION
    â”‚   - é»˜è®¤ â†’ LLM
    â”‚       â†“
    â”‚   æŒ‰ç±»å‹åˆ†ç»„ï¼š
    â”‚   [
    â”‚       { type: 'LLM', models: [{name: 'gpt-3.5-turbo'}, ...] },
    â”‚       { type: 'TEXT_EMBEDDING', models: [...] }
    â”‚   ]
    â”‚
    â”œâ”€â†’ settingsStore.addProvider(newProvider)
    â”‚       â†“
    â”‚   llmProviderService.add(provider)
    â”‚       â†“
    â”‚   IPC: 'llm-provider:add'
    â”‚       â†“
    â”‚   è¿”å›å®Œæ•´çš„providerå¯¹è±¡ï¼ˆå¸¦idï¼‰
    â”‚
    â”œâ”€â†’ emit('save', result)
    â”œâ”€â†’ closeModal()
    â””â”€â†’ $q.notify({ type: 'positive', message: 'æ¨¡å‹æä¾›å•†æ·»åŠ æˆåŠŸ' })
```

---

## 6. æ¨¡å‹é…ç½®æµç¨‹ (ModelConfigModal.vue)

### 6.1 å¯¹è¯æ¡†ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é…ç½®æ¨¡å‹: gpt-3.5-turbo                     âœ•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ ğŸ“¦ æ¨¡å‹ä¿¡æ¯                      [å·²è‡ªå®šä¹‰]     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ æä¾›å•†: OpenAI                          â”‚   â”‚
â”‚ â”‚ æ¨¡å‹åç§°: gpt-3.5-turbo                 â”‚   â”‚
â”‚ â”‚ æ¨èé…ç½®ç½®ä¿¡åº¦: 85%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’ (è¿›åº¦æ¡) â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ âš™ï¸ æ¨¡å‹å‚æ•°                                    â”‚
â”‚     [ğŸ”„é‡ç½®ä¸ºé»˜è®¤] [âœ¨åº”ç”¨æ¨èé…ç½®]             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ä¸Šä¸‹æ–‡é•¿åº¦    [4096   ] ğŸ“è¦†ç›–æ ‡è¯†       â”‚   â”‚
â”‚ â”‚ æœ€å¤§Token     [2048   ] ğŸ“è¦†ç›–æ ‡è¯†       â”‚   â”‚
â”‚ â”‚ å®Œæˆæ¨¡å¼      [å¯¹è¯â–¼  ]                  â”‚   â”‚
â”‚ â”‚ Agentæ€è€ƒ     [æ”¯æŒâ–¼  ]                  â”‚   â”‚
â”‚ â”‚ å‡½æ•°è°ƒç”¨      [æ”¯æŒâ–¼  ] ğŸ“è¦†ç›–æ ‡è¯†       â”‚   â”‚
â”‚ â”‚ ç»“æ„åŒ–è¾“å‡º    [ä¸æ”¯æŒâ–¼]                  â”‚   â”‚
â”‚ â”‚ ç³»ç»Ÿæç¤ºåˆ†éš”ç¬¦ [\n\n  ]                  â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ ğŸ“‹ é»˜è®¤é…ç½®ç»§æ‰¿            [æ˜¾ç¤ºâ–¼/éšè—â–²]       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ (æŠ˜å æ—¶ä¸æ˜¾ç¤º)                           â”‚   â”‚
â”‚ â”‚ (å±•å¼€æ—¶):                                â”‚   â”‚
â”‚ â”‚ â€¢ è¯·æ±‚è¶…æ—¶                               â”‚   â”‚
â”‚ â”‚   é»˜è®¤å€¼: 30000 â†’ å½“å‰å€¼: 30000          â”‚   â”‚
â”‚ â”‚ â€¢ ä¸Šä¸‹æ–‡é•¿åº¦ ğŸ“                          â”‚   â”‚
â”‚ â”‚   é»˜è®¤å€¼: 4096 â†’ å½“å‰å€¼: 4096            â”‚   â”‚
â”‚ â”‚ ...                                      â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ ğŸ§  æ™ºèƒ½æ¨è         [ç½®ä¿¡åº¦ 85%]               â”‚
â”‚ â–¶ æ¨èä¾æ®                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ (å±•å¼€æ—¶):                                â”‚   â”‚
â”‚ â”‚ ğŸ’¡ æ¨¡å‹åç§°åŒ…å«'turbo'ï¼Œå»ºè®®ä¸Šä¸‹æ–‡4096    â”‚   â”‚
â”‚ â”‚ ğŸ’¡ æ­¤æ¨¡å‹æ”¯æŒå‡½æ•°è°ƒç”¨                     â”‚   â”‚
â”‚ â”‚ ğŸ’¡ æ¨èä½¿ç”¨å¯¹è¯æ¨¡å¼                       â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚                      [å–æ¶ˆ]  [ä¿å­˜]  (ç¦ç”¨çŠ¶æ€) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ ¸å¿ƒäº¤äº’é€»è¾‘

**1. åˆå§‹åŒ–é…ç½®**

```
ModelConfigModalæ‰“å¼€
    â†“
watch(() => props.modelValue)
    â†“
config.value = getEffectiveConfig()
    â†“
getEffectiveConfig():
    è¿”å› {
        ...provider.defaultConfig,  // æä¾›å•†é»˜è®¤
        ...props.modelConfig        // æ¨¡å‹ç‰¹å®šè¦†ç›–
    }
    â†“
loadRecommendedConfig()
    â†“
llmClient.getModelRecommendedConfig(modelName)
    â†“
è¿”å› {
    config: { contextLength: 4096, ... },
    confidence: 0.85,
    reasoning: ['æ¨èä¾æ®1', 'æ¨èä¾æ®2', ...]
}
```

**2. å­—æ®µè¦†ç›–æ ‡è¯†**

```
isFieldOverridden(field):
    æ£€æŸ¥ props.modelConfig[field] æ˜¯å¦å­˜åœ¨
    â†“
å¦‚æœå­˜åœ¨ï¼š
    æ˜¾ç¤º ğŸ“ å›¾æ ‡ (æ©™è‰²)
    Tooltip: "å·²è¦†ç›–é»˜è®¤é…ç½®"
```

**3. åº”ç”¨æ¨èé…ç½®**

```
ç”¨æˆ·ç‚¹å‡»"âœ¨åº”ç”¨æ¨èé…ç½®"
    â†“
applyRecommendedConfig()
    â†“
config.value = {
    ...config.value,
    ...recommendedConfig.value.config
}
    â†“
UIæ›´æ–°æ‰€æœ‰å­—æ®µ
```

**4. é‡ç½®ä¸ºé»˜è®¤**

```
ç”¨æˆ·ç‚¹å‡»"ğŸ”„é‡ç½®ä¸ºé»˜è®¤"
    â†“
resetToDefault()
    â†“
config.value = { ...provider.defaultConfig }
    â†“
emit('reset')
```

**5. ä¿å­˜é…ç½®**

```
ç”¨æˆ·ç‚¹å‡»"ä¿å­˜"
    â†“
saveConfig()
    â†“
è®¡ç®—å·®å¼‚ï¼ˆåªä¿å­˜ä¸é»˜è®¤ä¸åŒçš„éƒ¨åˆ†ï¼‰:
    configToSave = {}
    for (key, value) in config.value:
        if (defaultConfig[key] !== value):
            configToSave[key] = value
    â†“
if (configToSaveä¸ºç©º):
    settingsStore.resetModelConfig(providerId, modelName)
else:
    settingsStore.updateModelConfig(providerId, modelName, configToSave)
    â†“
settingsService.updateModelConfig()
    â†“
æ‰¾åˆ°provider.supportedModelsä¸­çš„å¯¹åº”model
    â†“
æ›´æ–° model.config = { ...existingConfig, ...config }
    â†“
llmProviderService.update(providerId, updatedProvider)
    â†“
IPC: 'llm-provider:update'
    â†“
emit('save', configToSave)
closeModal()
$q.notify('æ¨¡å‹é…ç½®å·²ä¿å­˜')
```

---

## 7. æä¾›å•†é…ç½®æµç¨‹ (ProviderConfigModal.vue)

### 7.1 Tabç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é…ç½®æä¾›å•†: OpenAI                          âœ•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [åŸºæœ¬è®¾ç½®] [é»˜è®¤é…ç½®] [é«˜çº§è®¾ç½®]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ Tab1: åŸºæœ¬è®¾ç½®                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“ åŸºæœ¬ä¿¡æ¯                              â”‚   â”‚
â”‚ â”‚ æ˜¾ç¤ºåç§° *  [OpenAI        ]            â”‚   â”‚
â”‚ â”‚ å†…éƒ¨åç§° *  [openai        ] (åªè¯»)     â”‚   â”‚
â”‚ â”‚ æè¿°        [OpenAIå®˜æ–¹API   ]          â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ ğŸ”Œ è¿æ¥è®¾ç½®                              â”‚   â”‚
â”‚ â”‚ APIåœ°å€ *   [https://api... ] â“        â”‚   â”‚
â”‚ â”‚ APIå¯†é’¥ *   [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢     ] ğŸ‘        â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ [æµ‹è¯•è¿æ¥] âœ…è¿æ¥æˆåŠŸ                    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ Tab2: é»˜è®¤é…ç½®                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ âš™ï¸ é»˜è®¤æ¨¡å‹é…ç½®      [ğŸ”„é‡ç½®ä¸ºæ¨èå€¼]    â”‚   â”‚
â”‚ â”‚ "è¿™äº›è®¾ç½®å°†ä½œä¸ºæ‰€æœ‰æ¨¡å‹çš„é»˜è®¤é…ç½®ï¼Œ      â”‚   â”‚
â”‚ â”‚  å•ä¸ªæ¨¡å‹å¯ä»¥è¦†ç›–è¿™äº›è®¾ç½®"               â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ è¯·æ±‚è¶…æ—¶(ms)      [30000   ]            â”‚   â”‚
â”‚ â”‚ æœ€å¤§é‡è¯•æ¬¡æ•°      [3       ]            â”‚   â”‚
â”‚ â”‚ é»˜è®¤ä¸Šä¸‹æ–‡é•¿åº¦    [4096    ]            â”‚   â”‚
â”‚ â”‚ é»˜è®¤æœ€å¤§Token     [4096    ]            â”‚   â”‚
â”‚ â”‚ å®Œæˆæ¨¡å¼          [å¯¹è¯â–¼   ]            â”‚   â”‚
â”‚ â”‚ Agentæ€è€ƒæ”¯æŒ     [ä¸æ”¯æŒâ–¼ ]            â”‚   â”‚
â”‚ â”‚ å‡½æ•°è°ƒç”¨æ”¯æŒ      [ä¸æ”¯æŒâ–¼ ]            â”‚   â”‚
â”‚ â”‚ ç»“æ„åŒ–è¾“å‡ºæ”¯æŒ    [ä¸æ”¯æŒâ–¼ ]            â”‚   â”‚
â”‚ â”‚ ç³»ç»Ÿæç¤ºåˆ†éš”ç¬¦    [\n\n    ]            â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ Tab3: é«˜çº§è®¾ç½®                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ”„ æ¨¡å‹ç®¡ç†                              â”‚   â”‚
â”‚ â”‚ [åˆ·æ–°æ¨¡å‹åˆ—è¡¨]  ä¸Šæ¬¡åˆ·æ–°: 2å°æ—¶å‰        â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ âœ… æ¨ªå¹…: æˆåŠŸåˆ·æ–°æ¨¡å‹åˆ—è¡¨ï¼Œå‘ç°15ä¸ªæ¨¡å‹   â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ âš¡ çŠ¶æ€ç®¡ç†                              â”‚   â”‚
â”‚ â”‚ æä¾›å•†çŠ¶æ€  [æ´»åŠ¨â–¼]                      â”‚   â”‚
â”‚ â”‚ è‡ªåŠ¨åˆ·æ–°    [âœ…Toggle]                   â”‚   â”‚
â”‚ â”‚                                          â”‚   â”‚
â”‚ â”‚ âš ï¸ å±é™©æ“ä½œ                              â”‚   â”‚
â”‚ â”‚ [ğŸ—‘ï¸ åˆ é™¤æä¾›å•†]                         â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚                      [å–æ¶ˆ]  [ä¿å­˜] (ç¦ç”¨çŠ¶æ€)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å…³é”®äº¤äº’

**1. æµ‹è¯•è¿æ¥**

```
ç”¨æˆ·ç‚¹å‡»"æµ‹è¯•è¿æ¥"
    â†“
testConnection()
    â†“
settingsStore.testProviderConnection(provider.id)
    â†“
settingsService.testProviderConnection({
    apiKey, baseUrl, timeout, maxRetries
})
    â†“
llmClient.testConnection()
    â†“
testResult = { success: true/false, error? }
    â†“
æ˜¾ç¤ºç»“æœchip: âœ…è¿æ¥æˆåŠŸ / âŒè¿æ¥å¤±è´¥
```

**2. åˆ·æ–°æ¨¡å‹åˆ—è¡¨**

```
ç”¨æˆ·ç‚¹å‡»"åˆ·æ–°æ¨¡å‹åˆ—è¡¨"
    â†“
refreshModels()
    â†“
refreshing = true
    â†“
settingsStore.refreshProviderModels(provider.id)
    â†“
(æµç¨‹åŒä¹‹å‰)
    â†“
refreshResult = { success: true, modelsCount: 15 }
    â†“
æ˜¾ç¤ºæ¨ªå¹…ï¼šâœ…æˆåŠŸåˆ·æ–°æ¨¡å‹åˆ—è¡¨ï¼Œå‘ç°15ä¸ªæ¨¡å‹
lastRefreshTime = new Date()
```

**3. åˆ é™¤æä¾›å•†**

```
ç”¨æˆ·ç‚¹å‡»"åˆ é™¤æä¾›å•†"
    â†“
confirmDelete = true (æ‰“å¼€ç¡®è®¤å¯¹è¯æ¡†)
    â†“
ç”¨æˆ·ç¡®è®¤
    â†“
deleteProvider()
    â†“
settingsStore.removeProvider(provider.id)
    â†“
llmProviderService.remove(providerId)
    â†“
IPC: 'llm-provider:remove'
    â†“
ä»providersæ•°ç»„ä¸­åˆ é™¤
æ¸…ç†ç›¸å…³çš„activeModels
    â†“
emit('delete', providerId)
closeModal()
$q.notify('æä¾›å•†å·²åˆ é™¤')
```

**4. ä¿å­˜é…ç½®**

```
ç”¨æˆ·ç‚¹å‡»"ä¿å­˜"
    â†“
saveConfig()
    â†“
validateAllFields()
    â†“
if (isNewProvider):
    settingsStore.addProvider(providerData)
else:
    æ›´æ–°æµç¨‹ï¼š
    â”œâ”€â†’ updateProviderConfig(providerId, {
    â”‚       displayName, description,
    â”‚       baseUrl, apiKey, defaultConfig
    â”‚   })
    â”‚
    â””â”€â†’ å¦‚æœstatusæ”¹å˜:
        if (status === 'active'):
            activateProvider(providerId)
        else:
            deactivateProvider(providerId)
    â†“
emit('save', result)
closeModal()
$q.notify('æä¾›å•†é…ç½®å·²ä¿å­˜')
```

---

## 8. æ´»åŠ¨æ¨¡å‹ç®¡ç†

### 8.1 æ´»åŠ¨æ¨¡å‹æ•°æ®ç»“æ„

```typescript
// Storeä¸­çš„æ´»åŠ¨æ¨¡å‹
activeModels: {
    'LLM': 'openai.gpt-3.5-turbo',
    'TEXT_EMBEDDING': 'openai.text-embedding-ada-002',
    'IMAGE_GENERATION': 'openai.dall-e-3'
}

// ModelIdæ ¼å¼: "providerId.modelName"
// è§£æå‡½æ•°:
parseModelId(modelId: string): { providerId, modelName }
createModelId(providerId, modelName): string
```

### 8.2 æ´»åŠ¨æ¨¡å‹æ ‡ç­¾æ˜¾ç¤º

```
ModelProviders.vue é¡¶éƒ¨:
    â†“
activeModelTypes (computed):
    éå† activeModels çš„ keys
        â†“
    for each type:
        modelId = activeModels[type]
            â†“
        { providerId, modelName } = parseModelId(modelId)
            â†“
        provider = providers.find(p => p.id === providerId)
            â†“
        è¿”å› {
            type,
            provider,
            model: modelName
        }
    â†“
UIæ¸²æŸ“:
    <q-chip
        v-for="modelType in activeModelTypes"
        :key="modelType.type"
        :label="modelType.type"
    />
```

### 8.3 è®¾ç½®æ´»åŠ¨æ¨¡å‹

```
ä»ModelProviderCardä¸­çš„toggleè§¦å‘
    â†“
toggleActiveModel(modelType, modelName, active)
    â†“
if (active):
    settingsStore.setActiveModel(modelType, providerId, modelName)
        â†“
    createModelId(providerId, modelName)
        â†’ 'openai.gpt-3.5-turbo'
        â†“
    settingsService.setActiveModel(modelType, modelId)
        â†“
    llmProviderService.setActiveModel(modelType, providerId, modelName)
        â†“
    IPC: 'llm-provider:set-active-model'
        â†’ { modelType, providerId, modelName }
        â†“
    Main processæ›´æ–°é…ç½®æ–‡ä»¶
        â†“
    è¿”å›success
        â†“
    activeModels[modelType] = modelId
        â†“
    è§¦å‘äº‹ä»¶: 'active-models-changed'
        â†“
    æ‰€æœ‰ç›‘å¬è€…æ›´æ–°UI
else:
    settingsStore.clearActiveModel(modelType)
```

---

## 9. æ•°æ®æµä¸çŠ¶æ€ç®¡ç†

### 9.1 çŠ¶æ€å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Store State (stores/settings.ts)       â”‚
â”‚                                         â”‚
â”‚ providers: Ref<ModelProvider[]>        â”‚
â”‚ activeModels: Ref<ActiveModelConfig>   â”‚
â”‚ loading: Ref<boolean>                  â”‚
â”‚ error: Ref<string | null>              â”‚
â”‚ retryCount: Ref<number>                â”‚
â”‚ modelRefreshStatus: Ref<Record>        â”‚
â”‚ lastRefreshTime: Ref<Record>           â”‚
â”‚ validationErrors: Ref<Record>          â”‚
â”‚ batchRefreshProgress: Ref<Object>      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ â†‘
        æ•°æ®æµåŠ¨
           â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Service Layer                           â”‚
â”‚                                         â”‚
â”‚ SettingsService                         â”‚
â”‚  â†“ â†‘                                    â”‚
â”‚ LlmProviderService                      â”‚
â”‚  â†“ â†‘                                    â”‚
â”‚ IPC Bridge (Electron)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main Process                            â”‚
â”‚ - è¯»å†™YAMLé…ç½®æ–‡ä»¶                       â”‚
â”‚ - ç®¡ç†providersæ•°æ®                      â”‚
â”‚ - å‘é€å˜æ›´äº‹ä»¶                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 äº‹ä»¶ç³»ç»Ÿ

**è®¾ç½®äº‹ä»¶ç›‘å¬ï¼š**

```
setupEventListeners():
    eventCleanup = settingsService.onProvidersChanged(handleProviderChanged)
        â†“
    llmProviderService.onChanged(callback)
        â†“
    window.ipcRenderer.on('llm-provider:changed', (event) => {
        callback(event)
    })
```

**äº‹ä»¶ç±»å‹ï¼š**

```typescript
type LLMProviderChangedEvent = {
    type: 'provider-updated' | 'provider-added' | 'provider-removed' |
          'active-models-changed' | 'models-refreshed' | 'config-reloaded',
    provider?: ModelProvider,
    providerId?: string,
    activeModels?: ActiveModelConfig
}
```

**äº‹ä»¶å¤„ç†ï¼š**

```
handleProviderChanged(event):
    switch (event.type):
        case 'provider-updated':
            æ›´æ–°providersæ•°ç»„ä¸­çš„å¯¹åº”é¡¹
        
        case 'provider-added':
            æ·»åŠ åˆ°providersæ•°ç»„
        
        case 'provider-removed':
            ä»providersæ•°ç»„ä¸­åˆ é™¤
            æ¸…ç†ç›¸å…³activeModels
        
        case 'active-models-changed':
            activeModels.value = event.activeModels
        
        case 'models-refreshed':
            modelRefreshStatus[event.providerId] = 'success'
            lastRefreshTime[event.providerId] = new Date()
        
        case 'config-reloaded':
            é‡æ–°åŠ è½½æ‰€æœ‰æ•°æ®
```

### 9.3 é”™è¯¯å¤„ç†ä¸é‡è¯•

```
åŠ è½½å¤±è´¥æ—¶:
    â†“
error.value = 'åŠ è½½æä¾›å•†å¤±è´¥'
retryCount.value++
    â†“
UIæ˜¾ç¤º:
    hasError (computed) = true
    canRetry (computed) = retryCount < maxRetries (3)
    â†“
    [âš ï¸ é”™è¯¯æç¤º]
    [ğŸ”„ é‡è¯•æŒ‰é’®] (å¦‚æœcanRetry)
    â†“
ç”¨æˆ·ç‚¹å‡»é‡è¯•:
    retry()
        â†“
    Promise.all([loadProviders(), loadActiveModels()])
        â†“
    æˆåŠŸå:
        error.value = null
        retryCount.value = 0
```

---

## 10. äº¤äº’ç»†èŠ‚æ€»ç»“

### 10.1 å…³é”®äº¤äº’ç‰¹æ€§

#### A. æ¸è¿›å¼ä¿¡æ¯å±•ç¤º
- é»˜è®¤æŠ˜å æ¨¡å‹åˆ—è¡¨
- Expansion itemå±•å¼€æŸ¥çœ‹è¯¦æƒ…
- Tabåˆ†é¡µç»„ç»‡å¤æ‚é…ç½®

#### B. å³æ—¶åé¦ˆ
- LoadingçŠ¶æ€ï¼ˆæŒ‰é’®ã€spinnerã€overlayï¼‰
- æˆåŠŸ/å¤±è´¥é€šçŸ¥ï¼ˆ$q.notifyï¼‰
- é”™è¯¯æ¨ªå¹…ï¼ˆq-bannerï¼‰
- è¿›åº¦æŒ‡ç¤ºï¼ˆæµ‹è¯•è¿æ¥æ—¶çš„å¤šé˜¶æ®µçŠ¶æ€ï¼‰

#### C. æ™ºèƒ½æ¨è
- æ¨¡å‹é…ç½®æ¨èï¼ˆåŸºäºæ¨¡å‹åç§°æ¨æ–­ï¼‰
- ç½®ä¿¡åº¦æ˜¾ç¤º
- æ¨èä¾æ®å±•ç¤º

#### D. å®‰å…¨ç¡®è®¤
- åˆ é™¤æä¾›å•†ç¡®è®¤æ¡†
- å±é™©æ“ä½œäºŒæ¬¡ç¡®è®¤
- æ¸…ç†æ“ä½œç¡®è®¤ï¼ˆCacheManagementï¼‰

#### E. çŠ¶æ€å¯è§†åŒ–
- æ´»åŠ¨æ¨¡å‹chipæ ‡ç­¾
- æä¾›å•†çŠ¶æ€chipï¼ˆæ´»åŠ¨/åœç”¨/å¯ç”¨ï¼‰
- æ¨¡å‹è‡ªå®šä¹‰é…ç½®æ ‡è¯†ï¼ˆğŸ“å›¾æ ‡ï¼‰
- åˆ·æ–°çŠ¶æ€ï¼ˆloading/success/errorï¼‰
- ä¸Šæ¬¡åˆ·æ–°æ—¶é—´

#### F. é…ç½®ç»§æ‰¿ä½“ç³»
- Provideré»˜è®¤é…ç½®
- Modelç‰¹å®šè¦†ç›–é…ç½®
- åªä¿å­˜å·®å¼‚
- å­—æ®µçº§è¦†ç›–æ ‡è¯†

#### G. è¡¨å•éªŒè¯
- å®æ—¶éªŒè¯ï¼ˆ@blurè§¦å‘ï¼‰
- é”™è¯¯æç¤ºï¼ˆ:error-messageï¼‰
- ç¦ç”¨ä¿å­˜æŒ‰é’®ï¼ˆhasErrors || !hasChangesï¼‰
- å¿…å¡«å­—æ®µæ ‡è¯†ï¼ˆ*ï¼‰

#### H. æ•°æ®æŒä¹…åŒ–
- è‡ªåŠ¨ä¿å­˜åˆ°é…ç½®æ–‡ä»¶
- IPCåŒå‘é€šä¿¡
- äº‹ä»¶é©±åŠ¨æ›´æ–°
- ä¹è§‚UIæ›´æ–°

---

### 10.2 ç”¨æˆ·æ“ä½œæµç¨‹å›¾ï¼ˆå®Œæ•´ï¼‰

```
ç”¨æˆ·æ‰“å¼€è®¾ç½®
    â†“
æŸ¥çœ‹å·²å®‰è£…æä¾›å•†åˆ—è¡¨
    â”‚
    â”œâ†’ ç‚¹å‡»"æ·»åŠ æ›´å¤šæä¾›å•†"
    â”‚   â†“
    â”‚   è¿›å…¥AddProviderModal
    â”‚   â†“
    â”‚   å¡«å†™æ­¥éª¤1: åŸºæœ¬ä¿¡æ¯
    â”‚   â†“ [ä¸‹ä¸€æ­¥]
    â”‚   å¡«å†™æ­¥éª¤2: é»˜è®¤é…ç½®
    â”‚   â†“ [ä¸‹ä¸€æ­¥]
    â”‚   æ­¥éª¤3: æµ‹è¯•è¿æ¥
    â”‚   â†“ [æµ‹è¯•è¿æ¥]
    â”‚   ç­‰å¾…éªŒè¯â†’æµ‹è¯•â†’è·å–æ¨¡å‹
    â”‚   â†“ âœ…æˆåŠŸ
    â”‚   [å®Œæˆ] â†’ æ·»åŠ åˆ°providersåˆ—è¡¨
    â”‚
    â”œâ†’ ç‚¹å‡»æä¾›å•†å¡ç‰‡çš„"âš™ï¸é…ç½®"
    â”‚   â†“
    â”‚   è¿›å…¥ProviderConfigModal
    â”‚   â†“
    â”‚   Tab1: ä¿®æ”¹åŸºæœ¬ä¿¡æ¯
    â”‚   Tab2: è°ƒæ•´é»˜è®¤é…ç½®
    â”‚   Tab3: åˆ·æ–°æ¨¡å‹/åˆ é™¤æä¾›å•†
    â”‚   â†“ [ä¿å­˜]
    â”‚   æ›´æ–°æä¾›å•†é…ç½®
    â”‚
    â”œâ†’ ç‚¹å‡»æä¾›å•†å¡ç‰‡çš„"ğŸ”„åˆ·æ–°"
    â”‚   â†“
    â”‚   è°ƒç”¨refreshProviderModels
    â”‚   â†“
    â”‚   æ˜¾ç¤ºloadingçŠ¶æ€
    â”‚   â†“
    â”‚   æ›´æ–°æ¨¡å‹åˆ—è¡¨
    â”‚   â†“
    â”‚   æ˜¾ç¤ºæˆåŠŸ/å¤±è´¥çŠ¶æ€
    â”‚
    â”œâ†’ åˆ‡æ¢æä¾›å•†çš„"âš¡æ¿€æ´»å¼€å…³"
    â”‚   â†“
    â”‚   activateProvider / deactivateProvider
    â”‚   â†“
    â”‚   æ›´æ–°provider.status
    â”‚   â†“
    â”‚   UIè‡ªåŠ¨æ›´æ–°åˆ†ç»„ä½ç½®
    â”‚
    â””â†’ å±•å¼€æ¨¡å‹åˆ—è¡¨
        â†“
        æŸ¥çœ‹æŒ‰ç±»å‹åˆ†ç»„çš„æ¨¡å‹
        â”‚
        â”œâ†’ åˆ‡æ¢æ¨¡å‹çš„"è®¾ä¸ºæ´»åŠ¨"toggle
        â”‚   â†“
        â”‚   setActiveModel / clearActiveModel
        â”‚   â†“
        â”‚   æ›´æ–°activeModelsé…ç½®
        â”‚   â†“
        â”‚   é¡¶éƒ¨æ´»åŠ¨æ¨¡å‹æ ‡ç­¾æ›´æ–°
        â”‚
        â””â†’ ç‚¹å‡»æ¨¡å‹çš„"âš™ï¸é…ç½®"
            â†“
            è¿›å…¥ModelConfigModal
            â†“
            æŸ¥çœ‹å½“å‰é…ç½®ï¼ˆå«ç»§æ‰¿ï¼‰
            â†“
            ä¿®æ”¹å­—æ®µ / åº”ç”¨æ¨è / é‡ç½®
            â†“ [ä¿å­˜]
            æ›´æ–°model.config
            â†“
            æ˜¾ç¤ºğŸ“è¦†ç›–æ ‡è¯†
```

---

### 10.3 äº¤äº’è®¾è®¡äº®ç‚¹

1. **ä¸‰æ­¥å¼æ·»åŠ æµç¨‹**
   - åŸºæœ¬ä¿¡æ¯ â†’ é»˜è®¤é…ç½® â†’ è¿æ¥æµ‹è¯•
   - é€æ­¥éªŒè¯ï¼Œé™ä½é”™è¯¯ç‡
   - è‡ªåŠ¨å‘ç°æ¨¡å‹ï¼Œå‡å°‘æ‰‹åŠ¨é…ç½®

2. **é…ç½®ç»§æ‰¿ä¸è¦†ç›–**
   - Provideré»˜è®¤ â†’ Modelç‰¹å®šè¦†ç›–
   - åªä¿å­˜å·®å¼‚ï¼ŒèŠ‚çœå­˜å‚¨
   - å­—æ®µçº§å¯è§†åŒ–æ ‡è¯†

3. **æ™ºèƒ½æ¨èç³»ç»Ÿ**
   - åŸºäºæ¨¡å‹åç§°æ¨æ–­é…ç½®
   - ç½®ä¿¡åº¦è¯„åˆ†
   - æ¨èä¾æ®é€æ˜åŒ–

4. **å®æ—¶çŠ¶æ€åŒæ­¥**
   - IPCäº‹ä»¶é©±åŠ¨æ›´æ–°
   - å¤šç»„ä»¶è‡ªåŠ¨åŒæ­¥
   - ä¹è§‚UIæ›´æ–°

5. **æ¸è¿›å¼ä¿¡æ¯æŠ«éœ²**
   - é»˜è®¤æŠ˜å è¯¦æƒ…
   - ExpansionæŒ‰éœ€å±•å¼€
   - Tabåˆ†é¡µå¤æ‚é…ç½®

6. **å®Œæ•´çš„é”™è¯¯å¤„ç†**
   - åˆ†æ­¥éªŒè¯
   - å³æ—¶åé¦ˆ
   - é‡è¯•æœºåˆ¶
   - é”™è¯¯æ—¥å¿—

---

## 11. Nimbriaè¿ç§»å»ºè®®

åŸºäºJiuZhangçš„è®¾è®¡ï¼ŒNimbriaéœ€è¦å®ç°ï¼š

### 11.1 å¿…é¡»ä¿ç•™çš„æ ¸å¿ƒæµç¨‹

âœ… **ä¸‰æ­¥å¼æ·»åŠ æä¾›å•†æµç¨‹**
   - æ­¥éª¤1: åŸºæœ¬ä¿¡æ¯éªŒè¯
   - æ­¥éª¤2: é»˜è®¤é…ç½®è®¾ç½®
   - æ­¥éª¤3: è¿æ¥æµ‹è¯•ä¸æ¨¡å‹å‘ç°

âœ… **æ¨¡å‹é…ç½®çš„ç»§æ‰¿ä½“ç³»**
   - Provideré»˜è®¤é…ç½®
   - Modelç‰¹å®šè¦†ç›–
   - å­—æ®µçº§è¦†ç›–æ ‡è¯†
   - æ™ºèƒ½æ¨èç³»ç»Ÿ

âœ… **æ´»åŠ¨æ¨¡å‹ç®¡ç†**
   - `providerId.modelName`æ ¼å¼
   - Toggleè®¾ç½®æ´»åŠ¨æ¨¡å‹
   - é¡¶éƒ¨æ´»åŠ¨æ¨¡å‹æ ‡ç­¾æ˜¾ç¤º
   - æŒ‰æ¨¡å‹ç±»å‹åˆ†ç»„ç®¡ç†

âœ… **æä¾›å•†çŠ¶æ€ç®¡ç†**
   - active / available / inactive ä¸‰æ€
   - æŒ‰çŠ¶æ€åˆ†ç»„æ˜¾ç¤º
   - Toggleæ¿€æ´»/åœç”¨
   - åˆ·æ–°æ¨¡å‹åˆ—è¡¨åŠŸèƒ½

âœ… **å®æ—¶éªŒè¯ä¸æµ‹è¯•**
   - è¿æ¥æµ‹è¯•æµç¨‹
   - å®æ—¶å­—æ®µéªŒè¯
   - æ¨¡å‹è‡ªåŠ¨å‘ç°
   - é”™è¯¯å¤„ç†ä¸é‡è¯•

### 11.2 éœ€è¦é€‚é…çš„éƒ¨åˆ†

ğŸ”„ **UIæ¡†æ¶å·®å¼‚**
   - JiuZhangä½¿ç”¨Quasar (q-stepper, q-expansion-item)
   - Nimbriaä½¿ç”¨Element Plus + Quasaræ··åˆ
   - éœ€è¦ç”¨Element Plusç»„ä»¶æ›¿æ¢éƒ¨åˆ†Quasarç»„ä»¶

ğŸ”„ **çŠ¶æ€ç®¡ç†å·®å¼‚**
   - JiuZhang: å•ä¸€settings store
   - Nimbria: å·²æ‹†åˆ†ä¸ºsettings.llm.storeç­‰å¤šä¸ªæ¨¡å—
   - éœ€è¦ä¿æŒæ¨¡å—åŒ–è®¾è®¡ï¼Œä½†æ¥å£éœ€å…¼å®¹

ğŸ”„ **æ•°æ®æºå·®å¼‚**
   - JiuZhang: ç›´æ¥IPCè°ƒç”¨
   - Nimbria: DataSourceå±‚ï¼ˆç›®å‰ç”¨mockï¼‰
   - éœ€è¦åœ¨DataSourceä¸­å®ç°å®Œæ•´çš„IPCè°ƒç”¨

### 11.3 å¯ä»¥æ”¹è¿›çš„åœ°æ–¹

ğŸ’¡ **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
   - æ·»åŠ æ¨¡å‹æœç´¢/è¿‡æ»¤åŠŸèƒ½
   - æ”¯æŒæ‰¹é‡æ“ä½œï¼ˆæ‰¹é‡æ¿€æ´»ã€æ‰¹é‡åˆ·æ–°ï¼‰
   - æ·»åŠ å¿«æ·é”®æ”¯æŒ
   - ä¼˜åŒ–ç§»åŠ¨ç«¯é€‚é…

ğŸ’¡ **åŠŸèƒ½å¢å¼º**
   - æ¨¡å‹ä½¿ç”¨ç»Ÿè®¡
   - æˆæœ¬è¿½è¸ª
   - é…ç½®æ¨¡æ¿ç³»ç»Ÿ
   - é…ç½®å¯¼å…¥/å¯¼å‡º

ğŸ’¡ **æ€§èƒ½ä¼˜åŒ–**
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§é‡æ¨¡å‹æ—¶ï¼‰
   - æ‡’åŠ è½½æ¨¡å‹åˆ—è¡¨
   - ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

---

## ğŸ“ ç»“è®º

JiuZhangçš„LLMé…ç½®ç³»ç»Ÿè®¾è®¡**ä¸¥è°¨ã€å®Œæ•´ã€ç”¨æˆ·å‹å¥½**ï¼š

1. **å®Œæ•´çš„æ·»åŠ æµç¨‹** - ä¸‰æ­¥éªŒè¯ï¼Œè‡ªåŠ¨å‘ç°ï¼Œé™ä½é”™è¯¯
2. **çµæ´»çš„é…ç½®ç»§æ‰¿** - Provideré»˜è®¤ + Modelè¦†ç›–ï¼ŒèŠ‚çœé…ç½®
3. **æ™ºèƒ½çš„æ¨èç³»ç»Ÿ** - åŸºäºæ¨¡å‹åç§°æ¨æ–­ï¼Œæé«˜æ•ˆç‡
4. **å®æ—¶çš„çŠ¶æ€åŒæ­¥** - IPCäº‹ä»¶é©±åŠ¨ï¼Œå¤šç»„ä»¶è‡ªåŠ¨æ›´æ–°
5. **å‹å¥½çš„äº¤äº’è®¾è®¡** - æ¸è¿›å¼æŠ«éœ²ï¼Œå³æ—¶åé¦ˆï¼Œå®‰å…¨ç¡®è®¤

Nimbriaåº”è¯¥**å®Œå…¨éµå¾ªJiuZhangçš„äº¤äº’æµç¨‹è®¾è®¡**ï¼Œåªåœ¨UIç»„ä»¶å±‚é¢è¿›è¡Œé€‚é…ï¼Œæ ¸å¿ƒé€»è¾‘ã€æ•°æ®æµã€çŠ¶æ€ç®¡ç†å‡åº”ä¿æŒä¸€è‡´ã€‚

---

**åˆ†æå®Œæˆï¼** ğŸ‰

