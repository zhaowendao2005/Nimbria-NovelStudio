# Obsidian é£æ ¼ Markdown ç¼–è¾‘å™¨å®ç°æ€»ç»“

**é¡¹ç›®**: Nimbria-NovelStudio  
**æ—¶é—´**: 2025å¹´10æœˆ05æ—¥11:44:00  
**é˜¶æ®µ**: Reference-Page é¡¹ç›®é¡µé¢ Markdown ç¼–è¾‘å™¨ç³»ç»Ÿå®ç°

---

## ğŸ“‹ ç›®å½•

1. [å·²å®ç°çš„åŠŸèƒ½](#å·²å®ç°çš„åŠŸèƒ½)
2. [æŠ€æœ¯æ ˆä¸æ ¸å¿ƒä¾èµ–](#æŠ€æœ¯æ ˆä¸æ ¸å¿ƒä¾èµ–)
3. [é¡¹ç›®æ¶æ„ä¸è§„èŒƒ](#é¡¹ç›®æ¶æ„ä¸è§„èŒƒ)
4. [æ ¸å¿ƒå®ç°ç»†èŠ‚](#æ ¸å¿ƒå®ç°ç»†èŠ‚)
5. [è¸©å‘è®°å½•ä¸è§£å†³æ–¹æ¡ˆ](#è¸©å‘è®°å½•ä¸è§£å†³æ–¹æ¡ˆ)
6. [ç»éªŒæ€»ç»“](#ç»éªŒæ€»ç»“)
7. [æ ‡å‡†å·¥ä½œæµç¨‹](#æ ‡å‡†å·¥ä½œæµç¨‹)

---

## ğŸ¯ å·²å®ç°çš„åŠŸèƒ½

### 1. Obsidian é£æ ¼ UI å¸ƒå±€
- âœ… **ä¸‰æ å¸ƒå±€**ï¼šå·¦ä¾§å¯¼èˆªæ ï¼ˆ48pxï¼‰+ æ–‡ä»¶æµè§ˆå™¨ï¼ˆ280pxï¼‰+ ä¸»ç¼–è¾‘åŒºï¼ˆflexï¼‰
- âœ… **å¯è°ƒæ•´å®½åº¦**ï¼šæ–‡ä»¶æµè§ˆå™¨å’Œå³ä¾§å¤§çº²é¢æ¿æ”¯æŒæ‹–æ‹½è°ƒæ•´å®½åº¦
- âœ… **ä¸»é¢˜é€‚é…**ï¼šå®Œæ•´çš„ Obsidian é£æ ¼ CSS å˜é‡ç³»ç»Ÿ

### 2. æ–‡ä»¶æ ‘ç³»ç»Ÿ
- âœ… **æ ‘å½¢ç»“æ„å±•ç¤º**ï¼šä½¿ç”¨ `el-tree` å®ç°æ–‡ä»¶å¤¹å’Œæ–‡ä»¶çš„å±‚çº§å±•ç¤º
- âœ… **å•å‡»æ‰“å¼€æ–‡ä»¶**ï¼šç‚¹å‡»æ–‡ä»¶èŠ‚ç‚¹å³å¯åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€
- âœ… **é˜²é‡å¤æ‰“å¼€**ï¼šé€šè¿‡å®Œæ•´è·¯å¾„åˆ¤æ–­ï¼Œé¿å…é‡å¤åˆ›å»ºæ ‡ç­¾é¡µ
- âœ… **å›¾æ ‡åŒºåˆ†**ï¼šæ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä½¿ç”¨ä¸åŒçš„ Element Plus å›¾æ ‡
- âœ… **å·¥å…·æ åŠŸèƒ½**ï¼š
  - æ–°å»ºæ–‡æœ¬æ–‡ä»¶
  - æ–°å»ºæ–‡ä»¶å¤¹
  - è‡ªåŠ¨å®šä½å½“å‰æ–‡ä»¶
  - æ’åºèœå•ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
  - è‡ªåŠ¨å±•å¼€/æŠ˜å æŒ‰é’®ï¼ˆä¸ `el-tree` è”åŠ¨ï¼‰

### 3. æ ‡ç­¾é¡µç³»ç»Ÿ
- âœ… **å¤šæ ‡ç­¾é¡µç®¡ç†**ï¼šåŸºäº `el-tabs` å®ç°
- âœ… **æ ‡ç­¾é¡µçŠ¶æ€**ï¼š
  - æ–‡ä»¶è·¯å¾„ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
  - æ–‡ä»¶åï¼ˆæ˜¾ç¤ºæ ‡é¢˜ï¼‰
  - å†…å®¹ç¼“å­˜
  - ç¼–è¾‘/æŸ¥çœ‹æ¨¡å¼
  - è„æ•°æ®æ ‡è®°ï¼ˆisDirtyï¼‰
- âœ… **æ ‡ç­¾é¡µæ“ä½œ**ï¼š
  - å…³é—­æ ‡ç­¾é¡µ
  - åˆ‡æ¢æ ‡ç­¾é¡µ
  - è‡ªåŠ¨èšç„¦æœ€æ–°æ‰“å¼€çš„æ ‡ç­¾é¡µ

### 4. Markdown ç¼–è¾‘å™¨ï¼ˆåŸºäº Vditorï¼‰
- âœ… **ç¼–è¾‘æ¨¡å¼**ï¼š
  - IRï¼ˆInstant Renderingï¼‰æ¨¡å¼ï¼Œç±»ä¼¼ Obsidian çš„å®æ—¶æ¸²æŸ“
  - å®Œæ•´çš„å·¥å…·æ ï¼ˆè¡¨æƒ…ã€æ ‡é¢˜ã€ç²—ä½“ã€æ–œä½“ã€é“¾æ¥ã€åˆ—è¡¨ç­‰ï¼‰
  - å›ºå®šå·¥å…·æ ï¼ˆ`pin: true`ï¼‰
  - è‡ªåŠ¨å¡«å……å‚ç›´é«˜åº¦ï¼ˆflex å¸ƒå±€ï¼‰
- âœ… **æŸ¥çœ‹æ¨¡å¼**ï¼š
  - çº¯é™æ€æ¸²æŸ“ï¼ˆä½¿ç”¨ Vditor é™æ€æ–¹æ³•ï¼‰
  - æ”¯æŒä»£ç é«˜äº®ï¼ˆ`highlightRender`ï¼‰
  - æ”¯æŒæ•°å­¦å…¬å¼ï¼ˆ`mathRender` - KaTeXï¼‰
  - æ”¯æŒä»£ç å—ï¼ˆ`codeRender`ï¼‰
  - æ”¯æŒå›¾ç‰‡æ‡’åŠ è½½ï¼ˆ`lazyLoadImageRender`ï¼‰
  - æ”¯æŒå¤šåª’ä½“ï¼ˆ`mediaRender`ï¼‰
  - è‡ªå®šä¹‰æ»šåŠ¨æ¡ï¼ˆå®Œå…¨è„±ç¦» Vditor å†…ç½®æ»šåŠ¨ï¼‰

### 5. æ ‡ç­¾é¡µå¤´éƒ¨åŠŸèƒ½
- âœ… **å¯¼èˆªæŒ‰é’®**ï¼š
  - åé€€æŒ‰é’®ï¼ˆç¦ç”¨çŠ¶æ€åˆ¤æ–­ï¼‰
  - å‰è¿›æŒ‰é’®ï¼ˆç¦ç”¨çŠ¶æ€åˆ¤æ–­ï¼‰
- âœ… **é¢åŒ…å±‘è·¯å¾„**ï¼šæ˜¾ç¤ºæ–‡ä»¶ç›¸å¯¹äºé¡¹ç›®çš„è·¯å¾„
- âœ… **æ¨¡å¼åˆ‡æ¢**ï¼š
  - ç¼–è¾‘æ¨¡å¼æŒ‰é’®
  - æŸ¥çœ‹æ¨¡å¼æŒ‰é’®
  - æŒ‰é’®ç»„æ ·å¼ï¼ˆ`el-button-group`ï¼‰

### 6. çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰
- âœ… **æ–‡ä»¶æ ‘çŠ¶æ€**ï¼š`fileTree`
- âœ… **æ ‡ç­¾é¡µçŠ¶æ€**ï¼š`openTabs`ã€`activeTabId`
- âœ… **å¯¼èˆªå†å²**ï¼š`navigationHistory`ã€`currentHistoryIndex`
- âœ… **è®¡ç®—å±æ€§**ï¼š`activeTab`ã€`canGoBack`ã€`canGoForward`ã€`hasDirtyTabs`
- âœ… **æ“ä½œæ–¹æ³•**ï¼š
  - `initializeFileTree()`
  - `openFile(filePath)`
  - `closeTab(tabId)`
  - `updateTabContent(tabId, content)`
  - `switchTabMode(tabId, mode)`
  - `saveTab(tabId)`
  - `goBack()` / `goForward()`

### 7. Mock æ•°æ®ç³»ç»Ÿ
- âœ… **æ–‡ä»¶æ ‘ Mock**ï¼š`markdown.mock.ts`
- âœ… **æ–‡ä»¶æŸ¥æ‰¾å·¥å…·**ï¼š`findMockFileByPath(path)`
- âœ… **ç¤ºä¾‹æ–‡ä»¶**ï¼šREADME.mdã€ç¬”è®°1.mdã€ç¬”è®°2.mdã€å­ç¬”è®°ç­‰

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆä¸æ ¸å¿ƒä¾èµ–

### å‰ç«¯æ¡†æ¶
- **Vue 3**ï¼šComposition API
- **TypeScript**ï¼šç±»å‹å®‰å…¨
- **Vite**ï¼šæ„å»ºå·¥å…·

### UI ç»„ä»¶åº“
- **Element Plus**ï¼š
  - `el-tree`ï¼šæ–‡ä»¶æ ‘
  - `el-tabs` / `el-tab-pane`ï¼šæ ‡ç­¾é¡µ
  - `el-button` / `el-button-group`ï¼šæŒ‰é’®
  - `el-icon`ï¼šå›¾æ ‡
  - `el-tooltip`ï¼šæç¤º
  - `el-dropdown`ï¼šä¸‹æ‹‰èœå•
  - `el-breadcrumb`ï¼šé¢åŒ…å±‘
  - `el-empty`ï¼šç©ºçŠ¶æ€

### Markdown å¼•æ“
- **Vditor** (v3.10.6)ï¼š
  - **ç¼–è¾‘æ¨¡å¼**ï¼š`new Vditor(container, options)`
    - `mode: 'ir'`ï¼šInstant Rendering æ¨¡å¼
    - `height: '100%'`ï¼šè‡ªé€‚åº”é«˜åº¦
    - `toolbarConfig.pin: true`ï¼šå›ºå®šå·¥å…·æ 
    - `cache.enable: false`ï¼šç¦ç”¨ç¼“å­˜
  - **æŸ¥çœ‹æ¨¡å¼**ï¼šé™æ€æ–¹æ³•
    - `Vditor.md2html(markdown, options)`ï¼šMarkdown è½¬ HTML
    - `Vditor.highlightRender(options, element)`ï¼šä»£ç é«˜äº®
    - `Vditor.mathRender(element, options)`ï¼šæ•°å­¦å…¬å¼
    - `Vditor.codeRender(element)`ï¼šä»£ç å—æ¸²æŸ“
    - `Vditor.lazyLoadImageRender(element)`ï¼šå›¾ç‰‡æ‡’åŠ è½½
    - `Vditor.mediaRender(element)`ï¼šå¤šåª’ä½“æ¸²æŸ“

### çŠ¶æ€ç®¡ç†
- **Pinia**ï¼šVue 3 å®˜æ–¹çŠ¶æ€ç®¡ç†åº“
  - `defineStore`ï¼šå®šä¹‰ store
  - `ref`ï¼šå“åº”å¼çŠ¶æ€
  - `computed`ï¼šè®¡ç®—å±æ€§

### æ ·å¼
- **SCSS**ï¼šå…¨å±€æ ·å¼å’Œç»„ä»¶æ ·å¼
- **CSS å˜é‡**ï¼šObsidian ä¸»é¢˜ç³»ç»Ÿ
- **Flexbox**ï¼šå“åº”å¼å¸ƒå±€

---

## ğŸ“ é¡¹ç›®æ¶æ„ä¸è§„èŒƒ

### ç›®å½•ç»“æ„

```
Reference/Reference-Page/ReferencePage/src/pages/project-page/
â”œâ”€â”€ App.vue                          # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ main.ts                          # å…¥å£æ–‡ä»¶ï¼ˆPinia åˆå§‹åŒ–ï¼‰
â”œâ”€â”€ styles.scss                      # å…¨å±€æ ·å¼
â”œâ”€â”€ components/                      # ç»„ä»¶ç›®å½•
â”‚   â”œâ”€â”€ MarkdownEditor.vue          # Markdown ç¼–è¾‘å™¨ï¼ˆVditor IR æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ MarkdownViewer.vue          # Markdown æŸ¥çœ‹å™¨ï¼ˆVditor é™æ€æ¸²æŸ“ï¼‰
â”‚   â””â”€â”€ MarkdownTab.vue             # å•ä¸ªæ ‡ç­¾é¡µç»„ä»¶ï¼ˆåŒ…å«å¤´éƒ¨å’Œä¸»ä½“ï¼‰
â””â”€â”€ stores/                          # Pinia çŠ¶æ€ç®¡ç†
    â”œâ”€â”€ markdown.store.ts           # Markdown ç›¸å…³çŠ¶æ€å’Œæ–¹æ³•
    â””â”€â”€ markdown.mock.ts            # Mock æ•°æ®
```

### æ–‡ä»¶å‘½åè§„èŒƒ

#### Vue ç»„ä»¶
- âœ… **PascalCase**ï¼š`MarkdownEditor.vue`ã€`MarkdownTab.vue`
- âŒ **kebab-case**ï¼š`markdown-editor.vue`ï¼ˆä¸ä½¿ç”¨ï¼‰

#### TypeScript æ–‡ä»¶
- âœ… **Store æ–‡ä»¶**ï¼š`{name}.store.ts`ï¼ˆå¦‚ `markdown.store.ts`ï¼‰
- âœ… **Mock æ–‡ä»¶**ï¼š`{name}.mock.ts`ï¼ˆå¦‚ `markdown.mock.ts`ï¼‰
- âœ… **ç±»å‹æ–‡ä»¶**ï¼š`types.ts` æˆ– `{name}.types.ts`

#### æ ·å¼æ–‡ä»¶
- âœ… **å…¨å±€æ ·å¼**ï¼š`styles.scss`
- âœ… **ç»„ä»¶æ ·å¼**ï¼šåœ¨ç»„ä»¶å†…ä½¿ç”¨ `<style scoped>`

### CSS ç±»å‘½åè§„èŒƒ

- âœ… **kebab-case**ï¼š`.markdown-editor`ã€`.tab-main`ã€`.file-tree`
- âœ… **BEM é£æ ¼**ï¼ˆå¯é€‰ï¼‰ï¼š`.sidebar-left__header`ã€`.button-group--active`

### å¯¼å…¥è·¯å¾„çº¦å®š

```typescript
// âœ… ç›¸å¯¹è·¯å¾„ï¼ˆç»„ä»¶å†…ï¼‰
import MarkdownEditor from './components/MarkdownEditor.vue'
import { useMarkdownStore } from './stores/markdown.store'

// âœ… ç¬¬ä¸‰æ–¹åº“
import { defineStore } from 'pinia'
import Vditor from 'vditor'
import 'vditor/dist/index.css'

// âœ… Element Plusï¼ˆæŒ‰éœ€å¯¼å…¥ï¼‰
import { ElTree, ElTabs, ElIcon } from 'element-plus'
```

### ç»„ä»¶é€šä¿¡è§„èŒƒ

1. **Props**ï¼šçˆ¶ â†’ å­ä¼ é€’æ•°æ®
   ```typescript
   interface Props {
     modelValue?: string
     readonly?: boolean
   }
   ```

2. **Emits**ï¼šå­ â†’ çˆ¶è§¦å‘äº‹ä»¶
   ```typescript
   interface Emits {
     (e: 'update:modelValue', value: string): void
     (e: 'change', value: string): void
   }
   ```

3. **Pinia Store**ï¼šè·¨ç»„ä»¶å…±äº«çŠ¶æ€
   ```typescript
   const markdownStore = useMarkdownStore()
   markdownStore.openFile(filePath)
   ```

4. **defineExpose**ï¼šæš´éœ²å­ç»„ä»¶æ–¹æ³•ç»™çˆ¶ç»„ä»¶
   ```typescript
   defineExpose({
     getValue: () => vditor?.getValue() || '',
     setValue: (value: string) => vditor?.setValue(value)
   })
   ```

---

## ğŸ”§ æ ¸å¿ƒå®ç°ç»†èŠ‚

### 1. Pinia åˆå§‹åŒ–ï¼ˆmain.tsï¼‰

```typescript
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

const app = createApp(App)
const pinia = createPinia()

app.use(pinia)  // âš ï¸ å¿…é¡»åœ¨ä½¿ç”¨ store ä¹‹å‰è°ƒç”¨
app.mount('#app')
```

**å…³é”®ç‚¹**ï¼š
- å¿…é¡»åœ¨ `app.mount()` ä¹‹å‰è°ƒç”¨ `app.use(pinia)`
- å¦åˆ™ä¼šæŠ¥é”™ï¼š`"getActivePinia()" was called but there was no active Pinia`

### 2. æ–‡ä»¶æ ‘å•å‡»æ‰“å¼€æ–‡ä»¶ï¼ˆApp.vueï¼‰

```vue
<el-tree
  ref="treeRef"
  :data="markdownStore.fileTree"
  :props="{ label: 'name', children: 'children' }"
  default-expand-all
  highlight-current
  node-key="id"
  @node-click="handleNodeClick"
>
  <template #default="{ node, data }">
    <span class="tree-node">
      <el-icon v-if="data.isFolder"><Folder /></el-icon>
      <el-icon v-else><Document /></el-icon>
      <span class="node-label">{{ node.label }}</span>
    </span>
  </template>
</el-tree>

<script setup>
const handleNodeClick = (data: any) => {
  if (!data.isFolder) {
    markdownStore.openFile(data.path)  // é€šè¿‡å®Œæ•´è·¯å¾„æ‰“å¼€
  }
}
</script>
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ `@node-click` è€Œé `@node-dblclick`ï¼ˆç”¨æˆ·è¦æ±‚å•å‡»ï¼‰
- é€šè¿‡ `data.path`ï¼ˆå®Œæ•´è·¯å¾„ï¼‰åˆ¤æ–­æ˜¯å¦é‡å¤ï¼Œè€Œé `data.name`
- `node-key="id"` ç¡®ä¿èŠ‚ç‚¹å”¯ä¸€æ€§

### 3. æ ‡ç­¾é¡µé˜²é‡å¤æ‰“å¼€ï¼ˆmarkdown.store.tsï¼‰

```typescript
const openFile = (filePath: string) => {
  // æ£€æŸ¥æ˜¯å¦å·²ç»æ‰“å¼€ï¼ˆé€šè¿‡å®Œæ•´è·¯å¾„ï¼‰
  const existingTab = openTabs.value.find(tab => tab.filePath === filePath)
  
  if (existingTab) {
    // åˆ‡æ¢åˆ°å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ
    activeTabId.value = existingTab.id
    addToHistory(filePath)
    return existingTab
  }
  
  // åˆ›å»ºæ–°æ ‡ç­¾é¡µ
  const file = findFileByPath(fileTree.value, filePath)
  if (!file || file.isFolder) return null
  
  const newTab: MarkdownTab = {
    id: `tab-${Date.now()}-${Math.random()}`,
    filePath: file.path,
    fileName: file.name,
    content: file.content,
    mode: 'view',
    isDirty: false
  }
  
  openTabs.value.push(newTab)
  activeTabId.value = newTab.id
  addToHistory(filePath)
  
  return newTab
}
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ `filePath`ï¼ˆå®Œæ•´è·¯å¾„ï¼‰è€Œé `fileName` åˆ¤æ–­é‡å¤
- é¿å…ä¸åŒç›®å½•ä¸‹åŒåæ–‡ä»¶çš„å†²çª

### 4. Markdown ç¼–è¾‘å™¨è‡ªé€‚åº”é«˜åº¦ï¼ˆMarkdownEditor.vueï¼‰

```vue
<template>
  <div ref="editorContainer" class="markdown-editor"></div>
</template>

<script setup>
onMounted(() => {
  vditor = new Vditor(editorContainer.value, {
    height: '100%',  // âœ… ä½¿ç”¨ç™¾åˆ†æ¯”è€Œéå›ºå®šåƒç´ 
    mode: 'ir',
    // ... å…¶ä»–é…ç½®
  })
})
</script>

<style scoped>
.markdown-editor {
  flex: 1;          /* è‡ªåŠ¨å¡«å……çˆ¶å®¹å™¨ */
  min-height: 0;    /* å…è®¸ flex å‹ç¼© */
  overflow: hidden; /* å†…å®¹æº¢å‡ºç”± Vditor å†…éƒ¨å¤„ç† */
}
</style>
```

**å…³é”®ç‚¹**ï¼š
- `height: '100%'` è€Œé `height: 360`ï¼ˆå›ºå®šåƒç´ ï¼‰
- `flex: 1` ä½¿ç¼–è¾‘å™¨å¡«å……çˆ¶å®¹å™¨å¯ç”¨ç©ºé—´
- `min-height: 0` æ˜¯ Flex å¸ƒå±€ä¸­çš„å…³é”®å±æ€§

### 5. Markdown æŸ¥çœ‹å™¨è‡ªå®šä¹‰æ»šåŠ¨æ¡ï¼ˆMarkdownViewer.vue + styles.scssï¼‰

#### MarkdownViewer.vue
```vue
<template>
  <div class="markdown-viewer" ref="viewerContainer">
    <div v-html="renderedHtml"></div>
  </div>
</template>

<style scoped>
.markdown-viewer {
  width: 100%;
  height: 100%;
  overflow-y: auto;  /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
  padding: 20px 40px;
}
</style>
```

#### styles.scssï¼ˆå…¨å±€æ ·å¼ï¼‰
```scss
// âŒ é”™è¯¯å†™æ³•ï¼ˆåœ¨å…¨å±€ SCSS ä¸­ä½¿ç”¨ :deep()ï¼‰
.markdown-tabs {
  :deep(.el-tabs__content) {
    min-height: 0;  // ä¸ä¼šç”Ÿæ•ˆï¼
  }
}

// âœ… æ­£ç¡®å†™æ³•ï¼ˆç›´æ¥åµŒå¥—é€‰æ‹©å™¨ï¼‰
.markdown-tabs {
  .el-tabs__content {
    min-height: 0 !important;  // ç”Ÿæ•ˆäº†ï¼
  }
  
  .el-tab-pane {
    min-height: 0 !important;
  }
}

.editor-main {
  flex: 1;
  min-height: 0;        // å…³é”®ï¼
  overflow: hidden;     // ä¸æŠ¢æ»šåŠ¨
}

.tab-main {
  flex: 1;
  min-height: 0;        // å…³é”®ï¼
  overflow: hidden;
}
```

**å…³é”®ç‚¹**ï¼š
- `:deep()` åªåœ¨ Vue SFC çš„ `<style scoped>` ä¸­æœ‰æ•ˆ
- å…¨å±€ SCSS æ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨åµŒå¥—é€‰æ‹©å™¨
- ä½¿ç”¨ `!important` è¦†ç›– Element Plus çš„é»˜è®¤æ ·å¼
- Flex é“¾è·¯ä¸­çš„æ¯ä¸€å±‚éƒ½éœ€è¦ `min-height: 0`

### 6. è‡ªåŠ¨å±•å¼€/æŠ˜å æŒ‰é’®ä¸ el-tree è”åŠ¨ï¼ˆApp.vueï¼‰

```vue
<template>
  <!-- å·¥å…·æ æŒ‰é’® -->
  <el-tooltip content="è‡ªåŠ¨å±•å¼€/æŠ˜å " placement="bottom">
    <button class="tool-btn" @click="toggleExpandAll">
      <el-icon><Expand /></el-icon>
    </button>
  </el-tooltip>

  <!-- æ–‡ä»¶æ ‘ -->
  <el-tree
    ref="treeRef"
    :data="markdownStore.fileTree"
    :default-expand-all="isExpandAll"
    node-key="id"
  />
</template>

<script setup>
import { ref } from 'vue'
import type { ElTree } from 'element-plus'

const treeRef = ref<InstanceType<typeof ElTree>>()
const isExpandAll = ref(true)

const toggleExpandAll = () => {
  isExpandAll.value = !isExpandAll.value
  
  if (isExpandAll.value) {
    // å±•å¼€æ‰€æœ‰èŠ‚ç‚¹
    const allKeys = getAllNodeKeys(markdownStore.fileTree)
    allKeys.forEach(key => {
      treeRef.value?.store.nodesMap[key]?.expand()
    })
  } else {
    // æŠ˜å æ‰€æœ‰èŠ‚ç‚¹
    const allKeys = getAllNodeKeys(markdownStore.fileTree)
    allKeys.forEach(key => {
      treeRef.value?.store.nodesMap[key]?.collapse()
    })
  }
}

const getAllNodeKeys = (nodes: any[]): string[] => {
  const keys: string[] = []
  const traverse = (list: any[]) => {
    list.forEach(node => {
      keys.push(node.id)
      if (node.children) traverse(node.children)
    })
  }
  traverse(nodes)
  return keys
}
</script>
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ `ref<InstanceType<typeof ElTree>>()` è·å– `el-tree` å®ä¾‹
- é€šè¿‡ `treeRef.value?.store.nodesMap[key]?.expand()` æ§åˆ¶èŠ‚ç‚¹å±•å¼€
- é€’å½’è·å–æ‰€æœ‰èŠ‚ç‚¹çš„ key

---

## ğŸ•³ï¸ è¸©å‘è®°å½•ä¸è§£å†³æ–¹æ¡ˆ

### å‘ 1ï¼šPinia æœªåˆå§‹åŒ–é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Uncaught Error: [ğŸ]: "getActivePinia()" was called but there was no active Pinia.
```

**åŸå› **ï¼š
- åœ¨ `main.ts` ä¸­æ²¡æœ‰è°ƒç”¨ `app.use(pinia)`
- æˆ–è€…åœ¨ `app.use(pinia)` ä¹‹å‰å°±ä½¿ç”¨äº† store

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// main.ts
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

const app = createApp(App)
const pinia = createPinia()

app.use(pinia)  // âœ… å¿…é¡»åœ¨ mount ä¹‹å‰
app.mount('#app')
```

**ç»éªŒ**ï¼š
- Pinia å¿…é¡»åœ¨ä»»ä½•ç»„ä»¶ä½¿ç”¨ store ä¹‹å‰åˆå§‹åŒ–
- æŒ‰ç…§ Vue æ’ä»¶çš„æ ‡å‡†é¡ºåºï¼š`createApp â†’ use(plugins) â†’ mount`

---

### å‘ 2ï¼š`:deep()` åœ¨å…¨å±€ SCSS ä¸­ä¸ç”Ÿæ•ˆ

**ç°è±¡**ï¼š
- åœ¨ `styles.scss` ä¸­ä½¿ç”¨ `:deep(.el-tabs__content)` è®¾ç½®æ ·å¼
- æµè§ˆå™¨ DevTools ä¸­æŸ¥çœ‹ï¼Œ`min-height` ä»ç„¶æ˜¯ `auto`
- æ ·å¼å®Œå…¨æ²¡æœ‰åº”ç”¨

**åŸå› **ï¼š
- `:deep()` æ˜¯ Vue SFC ä¸­ç”¨äºç©¿é€ scoped CSS çš„ç‰¹æ®Šè¯­æ³•
- `styles.scss` æ˜¯å…¨å±€æ ·å¼æ–‡ä»¶ï¼Œä¸æ˜¯ scoped style
- åœ¨å…¨å±€ SCSS ä¸­ï¼Œ`:deep()` ä¼šè¢«å¿½ç•¥

**é”™è¯¯å†™æ³•**ï¼š
```scss
// styles.scssï¼ˆå…¨å±€æ–‡ä»¶ï¼‰
.markdown-tabs {
  :deep(.el-tabs__content) {
    min-height: 0;  // âŒ ä¸ä¼šç”Ÿæ•ˆ
  }
}
```

**æ­£ç¡®å†™æ³•**ï¼š
```scss
// styles.scssï¼ˆå…¨å±€æ–‡ä»¶ï¼‰
.markdown-tabs {
  .el-tabs__content {
    min-height: 0 !important;  // âœ… ç”Ÿæ•ˆäº†
  }
}
```

**è°ƒè¯•æ–¹æ³•**ï¼š
```javascript
// Chrome DevTools Console
for (const sheet of document.styleSheets) {
  for (const rule of sheet.cssRules) {
    if (rule.selectorText?.includes('el-tabs__content')) {
      console.log(rule.cssText)
    }
  }
}
```

**ç»éªŒ**ï¼š
- `:deep()` åªåœ¨ `<style scoped>` ä¸­ä½¿ç”¨
- å…¨å±€ SCSS ç›´æ¥ä½¿ç”¨åµŒå¥—é€‰æ‹©å™¨
- ä½¿ç”¨ `!important` è¦†ç›–ç»„ä»¶åº“çš„é»˜è®¤æ ·å¼
- ä½¿ç”¨ DevTools æ£€æŸ¥å®é™…ç”Ÿæˆçš„ CSS è§„åˆ™

---

### å‘ 3ï¼šFlex å¸ƒå±€ä¸­æ»šåŠ¨æ¡ä¸æ˜¾ç¤º

**ç°è±¡**ï¼š
- `.markdown-viewer` è®¾ç½®äº† `overflow-y: auto`
- å†…å®¹æ˜æ˜¾è¶…å‡ºå®¹å™¨é«˜åº¦
- ä½†æ»šåŠ¨æ¡ä¸æ˜¾ç¤ºï¼Œæ— æ³•æ»šåŠ¨

**åŸå› **ï¼š
- Flex å­é¡¹é»˜è®¤ `min-height: auto`ï¼ˆä¼š"åŒ…ä½"å†…å®¹ï¼‰
- çˆ¶çº§ `.editor-main` è®¾ç½®äº† `overflow-y: auto`ï¼ŒæŠ¢å äº†æ»šåŠ¨
- Flex é“¾è·¯ä¸­ç¼ºå°‘ `min-height: 0`

**è¯Šæ–­è¿‡ç¨‹**ï¼š
```javascript
// Chrome DevTools Console
const viewer = document.querySelector('.markdown-viewer')
const computed = getComputedStyle(viewer)

console.log({
  clientHeight: viewer.clientHeight,
  scrollHeight: viewer.scrollHeight,
  hasScroll: viewer.scrollHeight > viewer.clientHeight,
  minHeight: computed.minHeight,
  overflow: computed.overflow
})

// æ£€æŸ¥çˆ¶çº§é“¾è·¯
let current = viewer.parentElement
while (current) {
  const style = getComputedStyle(current)
  console.log({
    className: current.className,
    minHeight: style.minHeight,
    overflow: style.overflow,
    flex: style.flex
  })
  current = current.parentElement
}
```

**å‘ç°é—®é¢˜**ï¼š
```json
{
  "el-tabs__content": {
    "minHeight": "auto",  // âŒ åº”è¯¥æ˜¯ 0px
    "overflow": "hidden"
  },
  "editor-main": {
    "overflow": "auto"    // âŒ æŠ¢å äº†æ»šåŠ¨
  }
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```scss
// ä¿®å¤ Flex é“¾è·¯
.editor-main {
  flex: 1;
  min-height: 0;        // âœ… å…³é”®
  overflow: hidden;     // âœ… ä¸æŠ¢æ»šåŠ¨
}

.markdown-tabs {
  min-height: 0;        // âœ… å…³é”®
  
  .el-tabs__content {
    min-height: 0 !important;  // âœ… å…³é”®
  }
  
  .el-tab-pane {
    min-height: 0 !important;  // âœ… å…³é”®
  }
}

.tab-main {
  flex: 1;
  min-height: 0;        // âœ… å…³é”®
  overflow: hidden;
}

.markdown-viewer {
  overflow-y: auto;     // âœ… å”¯ä¸€æ»šåŠ¨å±‚
}
```

**Flex å¸ƒå±€æ»šåŠ¨çš„é»„é‡‘æ³•åˆ™**ï¼š
1. **æ‰€æœ‰çºµå‘ Flex å®¹å™¨å’Œå­é¡¹éƒ½è®¾ç½® `min-height: 0`**
2. **åªåœ¨ç›®æ ‡å±‚è®¾ç½® `overflow-y: auto`**
3. **çˆ¶çº§é“¾è·¯éƒ½è®¾ç½® `overflow: hidden`**

**ç»éªŒ**ï¼š
- Flex å­é¡¹é»˜è®¤ `min-height: auto` æ˜¯æœ€å¸¸è§çš„æ»šåŠ¨é—®é¢˜æ ¹æº
- ä½¿ç”¨ DevTools é€å±‚æ£€æŸ¥ `computed` æ ·å¼ï¼ˆä¸æ˜¯ä»£ç ä¸­å†™çš„å€¼ï¼‰
- æ£€æŸ¥ `clientHeight` vs `scrollHeight` åˆ¤æ–­æ˜¯å¦åº”è¯¥æœ‰æ»šåŠ¨
- ä½¿ç”¨ MCP `chrome-devtools` å·¥å…·é“¾å®æ—¶è°ƒè¯•

---

### å‘ 4ï¼šç¼–è¾‘å™¨é«˜åº¦å›ºå®šï¼Œæ— æ³•å¡«å……çˆ¶å®¹å™¨

**ç°è±¡**ï¼š
- ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œç¼–è¾‘å™¨é«˜åº¦å›ºå®šä¸º 360px
- çˆ¶å®¹å™¨ `.tab-main` æœ‰ 839px å¯ç”¨ç©ºé—´
- ç¼–è¾‘å™¨ä¸‹æ–¹æœ‰å¤§é‡ç©ºç™½

**åŸå› **ï¼š
- Vditor åˆå§‹åŒ–æ—¶ä½¿ç”¨äº†å›ºå®šé«˜åº¦ï¼š`height: 360`
- `.markdown-editor` å®¹å™¨ç¼ºå°‘ `flex: 1`

**é”™è¯¯å†™æ³•**ï¼š
```typescript
// MarkdownEditor.vue
vditor = new Vditor(editorContainer.value, {
  height: 360,  // âŒ å›ºå®šåƒç´ 
  // ...
})
```

**æ­£ç¡®å†™æ³•**ï¼š
```typescript
// MarkdownEditor.vue
vditor = new Vditor(editorContainer.value, {
  height: '100%',  // âœ… ç™¾åˆ†æ¯”é«˜åº¦
  // ...
})
```

```scss
// MarkdownEditor.vue <style scoped>
.markdown-editor {
  flex: 1;          // âœ… è‡ªåŠ¨å¡«å……
  min-height: 0;    // âœ… å…è®¸ flex ç”Ÿæ•ˆ
  overflow: hidden;
}
```

**éªŒè¯ç»“æœ**ï¼š
```json
{
  "markdown-editor": {
    "clientHeight": 838,
    "flex": "1 1 0%",
    "heightRatio": "99.9%"  // âœ… å¡«æ»¡äº†çˆ¶å®¹å™¨
  }
}
```

**ç»éªŒ**ï¼š
- ç¬¬ä¸‰æ–¹åº“çš„é«˜åº¦é…ç½®ä¼˜å…ˆä½¿ç”¨ç™¾åˆ†æ¯”æˆ– `'100%'`
- å®¹å™¨éœ€è¦é…åˆ `flex: 1` å’Œ `min-height: 0`
- ä½¿ç”¨ DevTools æ£€æŸ¥å®é™…é«˜åº¦å’Œ flex å±æ€§

---

### å‘ 5ï¼šæ–‡ä»¶æ ‘èŠ‚ç‚¹åŒå‡»ä¸è§¦å‘äº‹ä»¶

**ç°è±¡**ï¼š
- ä½¿ç”¨ `@node-dblclick` ç»‘å®šåŒå‡»äº‹ä»¶
- åŒå‡»æ–‡ä»¶èŠ‚ç‚¹åï¼Œäº‹ä»¶è§¦å‘äº†
- ä½† `markdownStore.openFile()` æ²¡æœ‰æ‰§è¡Œï¼Œæ ‡ç­¾é¡µæ²¡æœ‰åˆ›å»º

**åŸå› **ï¼š
- ç”¨æˆ·åæ¥è¦æ±‚æ”¹ä¸ºå•å‡»æ‰“å¼€æ–‡ä»¶
- éœ€è¦å°† `@node-dblclick` æ”¹ä¸º `@node-click`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```vue
<!-- âŒ é”™è¯¯ï¼šåŒå‡» -->
<el-tree @node-dblclick="handleNodeDoubleClick" />

<!-- âœ… æ­£ç¡®ï¼šå•å‡» -->
<el-tree @node-click="handleNodeClick" />

<script setup>
const handleNodeClick = (data: any) => {
  if (!data.isFolder) {
    markdownStore.openFile(data.path)
  }
}
</script>
```

**ç»éªŒ**ï¼š
- æ˜ç¡®ç”¨æˆ·äº¤äº’æ–¹å¼ï¼ˆå•å‡» vs åŒå‡»ï¼‰
- æ–‡ä»¶ç®¡ç†å™¨é€šå¸¸ä½¿ç”¨å•å‡»é€‰ä¸­ã€åŒå‡»æ‰“å¼€
- Obsidian é£æ ¼æ˜¯å•å‡»ç›´æ¥æ‰“å¼€

---

### å‘ 6ï¼šåŒåæ–‡ä»¶é‡å¤æ‰“å¼€æ ‡ç­¾é¡µ

**ç°è±¡**ï¼š
- ä¸åŒç›®å½•ä¸‹æœ‰åŒåæ–‡ä»¶ï¼ˆå¦‚ `ç¬”è®°1.md` å’Œ `æ–‡ä»¶å¤¹1/ç¬”è®°1.md`ï¼‰
- ç‚¹å‡»åéƒ½åˆ›å»ºäº†æ–°æ ‡ç­¾é¡µï¼Œæ²¡æœ‰å¤ç”¨

**åŸå› **ï¼š
- ä½¿ç”¨ `fileName` åˆ¤æ–­æ˜¯å¦é‡å¤
- åº”è¯¥ä½¿ç”¨ `filePath`ï¼ˆå®Œæ•´è·¯å¾„ï¼‰

**é”™è¯¯å†™æ³•**ï¼š
```typescript
const existingTab = openTabs.value.find(tab => tab.fileName === fileName)
```

**æ­£ç¡®å†™æ³•**ï¼š
```typescript
const existingTab = openTabs.value.find(tab => tab.filePath === filePath)
```

**ç»éªŒ**ï¼š
- æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†åº”è¯¥æ˜¯å®Œæ•´è·¯å¾„ï¼Œè€Œéæ–‡ä»¶å
- è€ƒè™‘ä¸åŒç›®å½•ä¸‹åŒåæ–‡ä»¶çš„åœºæ™¯

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### 1. Flex å¸ƒå±€æ»šåŠ¨çš„æ ¸å¿ƒåŸåˆ™

**é»„é‡‘æ³•åˆ™**ï¼š
```scss
// çˆ¶çº§é“¾è·¯ï¼ˆæ‰€æœ‰çºµå‘ Flex å®¹å™¨å’Œå­é¡¹ï¼‰
.parent {
  display: flex;
  flex-direction: column;
  min-height: 0;      // âœ… å¿…éœ€ï¼
  overflow: hidden;   // âœ… ä¸æŠ¢æ»šåŠ¨
}

.child {
  flex: 1;
  min-height: 0;      // âœ… å¿…éœ€ï¼
  overflow: hidden;   // âœ… ä¸æŠ¢æ»šåŠ¨
}

// æœ€ç»ˆæ»šåŠ¨å±‚
.scroll-target {
  overflow-y: auto;   // âœ… å”¯ä¸€æ»šåŠ¨
  height: 100%;
}
```

**ä¸ºä»€ä¹ˆéœ€è¦ `min-height: 0`ï¼Ÿ**
- Flex å­é¡¹é»˜è®¤ `min-height: auto`
- `auto` ä¼šæ ¹æ®å†…å®¹è®¡ç®—æœ€å°é«˜åº¦ï¼Œå¯¼è‡´å®¹å™¨"åŒ…ä½"å†…å®¹
- è®¾ç½® `min-height: 0` å…è®¸ flex å‹ç¼©å­é¡¹

**è°ƒè¯•æŠ€å·§**ï¼š
- ä½¿ç”¨ Chrome DevTools é€å±‚æ£€æŸ¥ `computed` æ ·å¼
- æ£€æŸ¥ `clientHeight` vs `scrollHeight`
- æ£€æŸ¥æ‰€æœ‰çˆ¶çº§çš„ `min-height`ã€`overflow`ã€`flex`

### 2. `:deep()` çš„æ­£ç¡®ä½¿ç”¨åœºæ™¯

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… Vue SFC çš„ `<style scoped>` ä¸­
- âœ… éœ€è¦ç©¿é€ scoped CSS ä¿®æ”¹å­ç»„ä»¶æ ·å¼

**ä¸é€‚ç”¨åœºæ™¯**ï¼š
- âŒ å…¨å±€ SCSS/CSS æ–‡ä»¶
- âŒ é scoped çš„ `<style>` æ ‡ç­¾

**ç¤ºä¾‹**ï¼š
```vue
<!-- ç»„ä»¶å†… scoped style -->
<style scoped>
.parent {
  :deep(.child) {
    color: red;  // âœ… å¯ä»¥ç©¿é€åˆ°å­ç»„ä»¶
  }
}
</style>
```

```scss
// å…¨å±€ styles.scss
.parent {
  .child {
    color: red;  // âœ… ç›´æ¥åµŒå¥—å³å¯
  }
}
```

### 3. Pinia åˆå§‹åŒ–é¡ºåº

**æ­£ç¡®é¡ºåº**ï¼š
```typescript
import { createApp } from 'vue'
import { createPinia } from 'pinia'

const app = createApp(App)
const pinia = createPinia()

app.use(pinia)      // 1. å…ˆæ³¨å†Œ Pinia
app.use(ElementPlus) // 2. å†æ³¨å†Œå…¶ä»–æ’ä»¶
app.mount('#app')   // 3. æœ€åæŒ‚è½½åº”ç”¨
```

**é”™è¯¯ç¤ºä¾‹**ï¼š
```typescript
// âŒ åœ¨ mount ä¹‹åæ³¨å†Œ
app.mount('#app')
app.use(pinia)  // å¤ªæ™šäº†ï¼

// âŒ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ store ä¹‹å‰æ²¡æœ‰æ³¨å†Œ
const app = createApp(App)
// ç»„ä»¶å†…å·²ç»è°ƒç”¨äº† useMarkdownStore()
app.use(pinia)  // å¤ªæ™šäº†ï¼
```

### 4. ç¬¬ä¸‰æ–¹åº“çš„é«˜åº¦é…ç½®

**ä¼˜å…ˆçº§**ï¼š
1. **ç™¾åˆ†æ¯”**ï¼š`height: '100%'`ï¼ˆæ¨èï¼‰
2. **CSS å˜é‡**ï¼š`height: 'var(--editor-height)'`
3. **å›ºå®šåƒç´ **ï¼š`height: 360`ï¼ˆä¸æ¨èï¼Œé™¤éæ˜ç¡®éœ€è¦ï¼‰

**ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ¨èï¼šç™¾åˆ†æ¯”é«˜åº¦ + flex å¸ƒå±€
new Vditor(container, {
  height: '100%'
})

// âŒ ä¸æ¨èï¼šå›ºå®šåƒç´ 
new Vditor(container, {
  height: 360
})
```

### 5. æ–‡ä»¶è·¯å¾„ä½œä¸ºå”¯ä¸€æ ‡è¯†

**åŸåˆ™**ï¼š
- ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼ˆ`filePath`ï¼‰è€Œéæ–‡ä»¶åï¼ˆ`fileName`ï¼‰
- è€ƒè™‘ä¸åŒç›®å½•ä¸‹åŒåæ–‡ä»¶çš„åœºæ™¯

**ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨å®Œæ•´è·¯å¾„
const existingTab = openTabs.value.find(tab => 
  tab.filePath === 'reference/notes/note1.md'
)

// âŒ é”™è¯¯ï¼šä½¿ç”¨æ–‡ä»¶å
const existingTab = openTabs.value.find(tab => 
  tab.fileName === 'note1.md'  // å¯èƒ½æœ‰å¤šä¸ªåŒåæ–‡ä»¶
)
```

### 6. ä½¿ç”¨ MCP å·¥å…·é“¾è°ƒè¯•

**ä¼˜åŠ¿**ï¼š
- å®æ—¶è·å– DOM è®¡ç®—æ ·å¼å’Œå°ºå¯¸
- å¯è§†åŒ–éªŒè¯ï¼ˆæˆªå›¾ï¼‰
- é¿å…å£å¤´æè¿° â†’ çŒœæµ‹ â†’ æ”¹ä»£ç  â†’ åˆ·æ–°çš„å¾ªç¯

**å¸¸ç”¨å·¥å…·**ï¼š
- `list_pages`ï¼šåˆ—å‡ºæµè§ˆå™¨æ ‡ç­¾é¡µ
- `navigate_page`ï¼šå¯¼èˆªåˆ°æŒ‡å®š URL
- `take_snapshot`ï¼šè·å–é¡µé¢å†…å®¹å¿«ç…§
- `evaluate_script`ï¼šæ‰§è¡Œ JavaScript è·å–çŠ¶æ€
- `take_screenshot`ï¼šæˆªå›¾éªŒè¯

**ç¤ºä¾‹**ï¼š
```javascript
// æ£€æŸ¥å…ƒç´ çŠ¶æ€
const viewer = document.querySelector('.markdown-viewer')
const computed = getComputedStyle(viewer)

return {
  clientHeight: viewer.clientHeight,
  scrollHeight: viewer.scrollHeight,
  hasScroll: viewer.scrollHeight > viewer.clientHeight,
  minHeight: computed.minHeight,
  overflow: computed.overflow
}
```

### 7. ç»„ä»¶è®¾è®¡åŸåˆ™

**å•ä¸€èŒè´£**ï¼š
- `MarkdownEditor.vue`ï¼šåªè´Ÿè´£ç¼–è¾‘åŠŸèƒ½
- `MarkdownViewer.vue`ï¼šåªè´Ÿè´£æŸ¥çœ‹åŠŸèƒ½
- `MarkdownTab.vue`ï¼šè´Ÿè´£æ ‡ç­¾é¡µå¸ƒå±€å’Œæ¨¡å¼åˆ‡æ¢

**çŠ¶æ€ç®¡ç†**ï¼š
- è·¨ç»„ä»¶å…±äº«çŠ¶æ€ä½¿ç”¨ Pinia
- ç»„ä»¶å†…éƒ¨çŠ¶æ€ä½¿ç”¨ `ref` / `reactive`
- çˆ¶å­ç»„ä»¶é€šä¿¡ä½¿ç”¨ Props / Emits

**æ ·å¼éš”ç¦»**ï¼š
- ç»„ä»¶ä¸“ç”¨æ ·å¼ä½¿ç”¨ `<style scoped>`
- å…¨å±€æ ·å¼ä½¿ç”¨ `styles.scss`
- é¿å…æ ·å¼æ±¡æŸ“

---

## ğŸ”„ æ ‡å‡†å·¥ä½œæµç¨‹

### å·¥ä½œæµç¨‹ 1ï¼šæ·»åŠ æ–°çš„ Markdown åŠŸèƒ½

#### 1. éœ€æ±‚åˆ†æ
- æ˜ç¡®åŠŸèƒ½éœ€æ±‚ï¼ˆç¼–è¾‘ / æŸ¥çœ‹ / å¯¼å‡ºç­‰ï¼‰
- ç¡®å®šäº¤äº’æ–¹å¼ï¼ˆå•å‡» / åŒå‡» / å¿«æ·é”®ç­‰ï¼‰
- è¯„ä¼°æŠ€æœ¯å¯è¡Œæ€§

#### 2. æŠ€æœ¯é€‰å‹
- ä¼˜å…ˆæŸ¥æ‰¾ç°æˆçš„åº“ï¼ˆå¦‚ Vditorã€Markedã€Remarkï¼‰
- è¯„ä¼°åº“çš„åŠŸèƒ½ã€æ€§èƒ½ã€æ–‡æ¡£è´¨é‡
- ç¡®è®¤æ˜¯å¦æ”¯æŒæ‰€éœ€åŠŸèƒ½ï¼ˆä»£ç é«˜äº®ã€æ•°å­¦å…¬å¼ç­‰ï¼‰

#### 3. çŠ¶æ€è®¾è®¡
- ç¡®å®šéœ€è¦å“ªäº›çŠ¶æ€ï¼ˆæ–‡ä»¶åˆ—è¡¨ã€æ‰“å¼€çš„æ ‡ç­¾é¡µã€å½“å‰æ¨¡å¼ç­‰ï¼‰
- è®¾è®¡ Pinia store ç»“æ„
- å®šä¹‰ TypeScript ç±»å‹

**ç¤ºä¾‹**ï¼š
```typescript
// stores/markdown.store.ts
export interface MarkdownFile {
  id: string
  name: string
  path: string
  content: string
  isFolder: boolean
  children?: MarkdownFile[]
}

export interface MarkdownTab {
  id: string
  filePath: string
  fileName: string
  content: string
  mode: 'edit' | 'view'
  isDirty: boolean
}
```

#### 4. Mock æ•°æ®å‡†å¤‡
- åˆ›å»º `{name}.mock.ts` æ–‡ä»¶
- æä¾›ç¤ºä¾‹æ•°æ®ç”¨äºå¼€å‘å’Œæµ‹è¯•

**ç¤ºä¾‹**ï¼š
```typescript
// stores/markdown.mock.ts
export const mockMarkdownFiles: MarkdownFile[] = [
  {
    id: 'folder-1',
    name: 'å‚è€ƒèµ„æ–™æº',
    path: 'reference',
    content: '',
    isFolder: true,
    children: [
      {
        id: 'file-1',
        name: 'README.md',
        path: 'reference/README.md',
        content: '# å‚è€ƒèµ„æ–™æº\n\n...',
        isFolder: false
      }
    ]
  }
]
```

#### 5. ç»„ä»¶å®ç°
- åˆ›å»º Vue ç»„ä»¶ï¼ˆ`{Name}.vue`ï¼‰
- å®ç° UI å¸ƒå±€
- é›†æˆç¬¬ä¸‰æ–¹åº“
- ç»‘å®šçŠ¶æ€å’Œäº‹ä»¶

**ç¤ºä¾‹**ï¼š
```vue
<!-- components/MarkdownEditor.vue -->
<template>
  <div ref="editorContainer" class="markdown-editor"></div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import Vditor from 'vditor'

const editorContainer = ref<HTMLElement>()
let vditor: Vditor | null = null

onMounted(() => {
  vditor = new Vditor(editorContainer.value, {
    height: '100%',
    mode: 'ir',
    // ...
  })
})
</script>

<style scoped>
.markdown-editor {
  flex: 1;
  min-height: 0;
  overflow: hidden;
}
</style>
```

#### 6. æ ·å¼è°ƒæ•´
- å®ç° Obsidian é£æ ¼ä¸»é¢˜
- ç¡®ä¿å“åº”å¼å¸ƒå±€
- å¤„ç† Flex å¸ƒå±€æ»šåŠ¨é—®é¢˜

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ CSS å˜é‡ç»Ÿä¸€ä¸»é¢˜
- Flex é“¾è·¯ä¸­çš„ `min-height: 0`
- åªåœ¨ç›®æ ‡å±‚è®¾ç½® `overflow-y: auto`

#### 7. è°ƒè¯•éªŒè¯
- ä½¿ç”¨ Chrome DevTools æ£€æŸ¥æ ·å¼
- ä½¿ç”¨ MCP å·¥å…·é“¾å®æ—¶è°ƒè¯•
- éªŒè¯å„ç§äº¤äº’åœºæ™¯

#### 8. æ–‡æ¡£æ›´æ–°
- æ›´æ–°ç»„ä»¶æ–‡æ¡£
- è®°å½•è¸©å‘å’Œè§£å†³æ–¹æ¡ˆ
- æ€»ç»“ç»éªŒæ•™è®­

---

### å·¥ä½œæµç¨‹ 2ï¼šä¿®å¤ Flex å¸ƒå±€æ»šåŠ¨é—®é¢˜

#### 1. é—®é¢˜ç¡®è®¤
- ç¡®è®¤æ»šåŠ¨æ¡åº”è¯¥å‡ºç°åœ¨å“ªä¸ªå…ƒç´ 
- æ£€æŸ¥å†…å®¹æ˜¯å¦ç¡®å®è¶…å‡ºå®¹å™¨

**æ£€æŸ¥æ–¹æ³•**ï¼š
```javascript
const el = document.querySelector('.target')
console.log({
  clientHeight: el.clientHeight,
  scrollHeight: el.scrollHeight,
  shouldScroll: el.scrollHeight > el.clientHeight
})
```

#### 2. æ£€æŸ¥ Flex é“¾è·¯
- ä»ç›®æ ‡å…ƒç´ å‘ä¸Šéå†æ‰€æœ‰çˆ¶çº§
- æ£€æŸ¥æ¯ä¸€å±‚çš„ `min-height`ã€`overflow`ã€`flex`

**æ£€æŸ¥æ–¹æ³•**ï¼š
```javascript
let current = document.querySelector('.target')
while (current) {
  const style = getComputedStyle(current)
  console.log({
    className: current.className,
    minHeight: style.minHeight,
    overflow: style.overflow,
    flex: style.flex
  })
  current = current.parentElement
}
```

#### 3. åº”ç”¨ä¿®å¤
- æ‰€æœ‰ Flex å®¹å™¨å’Œå­é¡¹è®¾ç½® `min-height: 0`
- çˆ¶çº§é“¾è·¯è®¾ç½® `overflow: hidden`
- ç›®æ ‡å±‚è®¾ç½® `overflow-y: auto`

**ä¿®å¤æ¨¡æ¿**ï¼š
```scss
// çˆ¶çº§é“¾è·¯
.parent-1, .parent-2, .parent-3 {
  min-height: 0;
  overflow: hidden;
}

// ç›®æ ‡æ»šåŠ¨å±‚
.scroll-target {
  overflow-y: auto;
  height: 100%;
}
```

#### 4. éªŒè¯ä¿®å¤
- åˆ·æ–°é¡µé¢
- æ£€æŸ¥æ»šåŠ¨æ¡æ˜¯å¦å‡ºç°
- æµ‹è¯•æ»šåŠ¨åŠŸèƒ½

**éªŒè¯æ–¹æ³•**ï¼š
```javascript
const el = document.querySelector('.scroll-target')
console.log({
  hasScroll: el.scrollHeight > el.clientHeight,
  canScroll: el.scrollTop !== undefined
})
```

---

### å·¥ä½œæµç¨‹ 3ï¼šé›†æˆç¬¬ä¸‰æ–¹ Markdown åº“

#### 1. è°ƒç ”åº“çš„åŠŸèƒ½
- æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å’Œç¤ºä¾‹
- ç¡®è®¤æ”¯æŒçš„åŠŸèƒ½ï¼ˆä»£ç é«˜äº®ã€æ•°å­¦å…¬å¼ã€è¡¨æ ¼ç­‰ï¼‰
- è¯„ä¼°æ€§èƒ½å’ŒåŒ…å¤§å°

**æ¨èåº“**ï¼š
- **Vditor**ï¼šåŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒå¤šç§æ¨¡å¼ï¼Œé€‚åˆç¼–è¾‘å™¨
- **Marked**ï¼šè½»é‡çº§ï¼Œé€‚åˆçº¯æŸ¥çœ‹
- **Remark**ï¼šæ’ä»¶ç”Ÿæ€ä¸°å¯Œï¼Œé€‚åˆå®šåˆ¶åŒ–

#### 2. å®‰è£…ä¾èµ–
```bash
npm install vditor
# æˆ–
npm install marked highlight.js katex
```

#### 3. ç¼–è¾‘æ¨¡å¼é›†æˆ
```typescript
import Vditor from 'vditor'
import 'vditor/dist/index.css'

const vditor = new Vditor(container, {
  height: '100%',
  mode: 'ir',  // Instant Rendering
  placeholder: 'å¼€å§‹ç¼–å†™...',
  theme: 'classic',
  toolbarConfig: {
    pin: true
  },
  cache: {
    enable: false
  },
  input: (value) => {
    // å†…å®¹å˜åŒ–å›è°ƒ
  }
})
```

#### 4. æŸ¥çœ‹æ¨¡å¼é›†æˆ
```typescript
import Vditor from 'vditor'

const html = await Vditor.md2html(markdown, {
  mode: 'light',
  markdown: {
    toc: true,
    mark: true,
    footnotes: true,
    autoSpace: true
  }
})

// æ¸²æŸ“åå¤„ç†
Vditor.highlightRender({ style: 'github' }, container)
Vditor.mathRender(container, { cdn: 'https://cdn.jsdelivr.net/npm/katex' })
Vditor.codeRender(container)
```

#### 5. æ ·å¼å®šåˆ¶
```scss
// è¦†ç›– Vditor é»˜è®¤æ ·å¼
.vditor {
  --vditor-background-color: var(--obsidian-bg-primary);
  --vditor-text-color: var(--obsidian-text-primary);
}

.vditor-content {
  font-family: var(--obsidian-font-text);
  font-size: 14px;
  line-height: 1.6;
}
```

#### 6. API å°è£…
```typescript
// æš´éœ²æ–¹æ³•ç»™çˆ¶ç»„ä»¶
defineExpose({
  getValue: () => vditor?.getValue() || '',
  setValue: (value: string) => vditor?.setValue(value),
  focus: () => vditor?.focus(),
  blur: () => vditor?.blur()
})
```

---

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- **Vue 3**ï¼šhttps://vuejs.org/
- **Pinia**ï¼šhttps://pinia.vuejs.org/
- **Element Plus**ï¼šhttps://element-plus.org/
- **Vditor**ï¼šhttps://b3log.org/vditor/

### æŠ€æœ¯æ–‡ç« 
- **Flexbox å®Œå…¨æŒ‡å—**ï¼šhttps://css-tricks.com/snippets/css/a-guide-to-flexbox/
- **Vue 3 Composition API**ï¼šhttps://vuejs.org/guide/extras/composition-api-faq.html
- **Pinia æœ€ä½³å®è·µ**ï¼šhttps://pinia.vuejs.org/cookbook/

### å·¥å…·
- **Chrome DevTools**ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·
- **MCP chrome-devtools**ï¼šå®æ—¶è°ƒè¯•å·¥å…·é“¾
- **Vue DevTools**ï¼šVue ä¸“ç”¨è°ƒè¯•å·¥å…·

---

## ğŸ¯ ä¸‹ä¸€é˜¶æ®µè®¡åˆ’

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2 å‘¨ï¼‰
1. **å®ç°æ–‡ä»¶ä¿å­˜åŠŸèƒ½**ï¼š
   - ç›‘å¬ `Ctrl/Cmd + S` å¿«æ·é”®
   - è°ƒç”¨åç«¯ API ä¿å­˜æ–‡ä»¶
   - æ›´æ–° `isDirty` çŠ¶æ€

2. **å®ç°å¯¼èˆªå†å²åŠŸèƒ½**ï¼š
   - åé€€/å‰è¿›æŒ‰é’®é€»è¾‘
   - å†å²è®°å½•ç®¡ç†
   - å¿«æ·é”®æ”¯æŒ

3. **å®ç°å¤§çº²é¢æ¿**ï¼š
   - è§£æ Markdown æ ‡é¢˜
   - ç”Ÿæˆç›®å½•æ ‘
   - ç‚¹å‡»è·³è½¬åˆ°å¯¹åº”ä½ç½®

### ä¸­æœŸç›®æ ‡ï¼ˆ1 ä¸ªæœˆï¼‰
1. **æ–‡ä»¶ç³»ç»Ÿé›†æˆ**ï¼š
   - è¿æ¥åç«¯æ–‡ä»¶ç³»ç»Ÿ API
   - å®ç°æ–‡ä»¶çš„å¢åˆ æ”¹æŸ¥
   - æ–‡ä»¶ç›‘å¬å’Œè‡ªåŠ¨åˆ·æ–°

2. **æœç´¢åŠŸèƒ½**ï¼š
   - å…¨å±€æœç´¢
   - å½“å‰æ–‡ä»¶æœç´¢
   - æœç´¢ç»“æœé«˜äº®

3. **å›¾å½¢è§†å›¾**ï¼š
   - æ–‡ä»¶å…³è”å…³ç³»å¯è§†åŒ–
   - åŸºäºé“¾æ¥çš„çŸ¥è¯†å›¾è°±

### é•¿æœŸç›®æ ‡ï¼ˆ3 ä¸ªæœˆï¼‰
1. **æ’ä»¶ç³»ç»Ÿ**ï¼š
   - æ”¯æŒè‡ªå®šä¹‰ Markdown æ‰©å±•
   - æ”¯æŒä¸»é¢˜åˆ‡æ¢
   - æ”¯æŒå¿«æ·é”®è‡ªå®šä¹‰

2. **åä½œåŠŸèƒ½**ï¼š
   - å¤šäººå®æ—¶ç¼–è¾‘
   - ç‰ˆæœ¬æ§åˆ¶é›†æˆ
   - è¯„è®ºå’Œæ‰¹æ³¨

3. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§æ–‡ä»¶ï¼‰
   - æ‡’åŠ è½½ï¼ˆæ–‡ä»¶æ ‘ï¼‰
   - ç¼“å­˜ç­–ç•¥

---

## ğŸ“ æ€»ç»“

æœ¬é˜¶æ®µæˆåŠŸå®ç°äº† Obsidian é£æ ¼çš„ Markdown ç¼–è¾‘å™¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š
- âœ… å®Œæ•´çš„æ–‡ä»¶æ ‘å’Œæ ‡ç­¾é¡µç®¡ç†
- âœ… åŸºäº Vditor çš„ç¼–è¾‘å’ŒæŸ¥çœ‹æ¨¡å¼
- âœ… å“åº”å¼ Flex å¸ƒå±€å’Œè‡ªå®šä¹‰æ»šåŠ¨æ¡
- âœ… Pinia çŠ¶æ€ç®¡ç†å’Œ Mock æ•°æ®ç³»ç»Ÿ

**æ ¸å¿ƒç»éªŒ**ï¼š
- Flex å¸ƒå±€æ»šåŠ¨çš„é»„é‡‘æ³•åˆ™ï¼ˆ`min-height: 0`ï¼‰
- `:deep()` åªåœ¨ scoped style ä¸­ä½¿ç”¨
- Pinia åˆå§‹åŒ–é¡ºåº
- ä½¿ç”¨ MCP å·¥å…·é“¾å®æ—¶è°ƒè¯•

**æ ‡å‡†æµç¨‹**ï¼š
- éœ€æ±‚åˆ†æ â†’ æŠ€æœ¯é€‰å‹ â†’ çŠ¶æ€è®¾è®¡ â†’ Mock æ•°æ® â†’ ç»„ä»¶å®ç° â†’ æ ·å¼è°ƒæ•´ â†’ è°ƒè¯•éªŒè¯ â†’ æ–‡æ¡£æ›´æ–°

è¿™å¥—æµç¨‹å¯ä»¥åº”ç”¨åˆ°åç»­çš„åŠŸèƒ½å¼€å‘ä¸­ï¼Œé™ä½å¼€å‘æˆæœ¬ï¼Œæé«˜ä»£ç è´¨é‡ã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2025å¹´10æœˆ05æ—¥11:44:00  
**ä¸‹æ¬¡æ›´æ–°**ï¼šä¸‹ä¸€é˜¶æ®µåŠŸèƒ½å®ç°å®Œæˆå
