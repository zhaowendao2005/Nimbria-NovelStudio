## 🚀 **Biology-Toolbox 添加页面完整流程**

# 中心思想：
遵循 Vue 架构调用链：App.vue → Index/{MainSystem} → layouts/{主应用布局} → PagesLayout/{页面布局} + components/shell/{shell组件}

## 🏗️ **架构层次调用关系**
```
App.vue
└── Index/{MainSystem}.vue (系统入口)
    └── layouts/{MainLayout}.vue (主应用布局，如左右布局)
        ├── components/shell/{sidebar,topbar}/ (shell组件，限定类型)
        └── <router-view> (内联路由，决定调用哪个页面布局)
            └── PagesLayout/{ModulePage}.vue (页面布局)
                └── components/{ModulePage}/ (业务组件，与页面布局同名)
```

**关键说明：**
- `router/routes.ts` 仅负责对外的主要路由入口
- 大部分具体路由通过 Vue 内联路由 (`<router-view>`) 管理
- `components/shell/` 与 `components/{PageName}/` 保持同级
- 业务组件目录必须与对应的 PagesLayout 同名
### **第零阶段：使用mcp来快速查看Client下面的文件tree与关键文件内容


### **第一阶段：需求分析与规划**

#### **1. 确定页面归属**
```bash
# 确定以下信息：
✅ 页面属于哪个业务模块？ (如: DataVisualization)
✅ 页面属于哪个系统入口？ (如: MainSystem)
✅ 页面需要哪些shell组件？ (如: sidebar/topbar 等)
✅ 页面的主要功能类型？ (如: 数据展示/表单编辑/仪表板)
✅ 需要哪些业务组件？ (如: 图表组件/表格组件/筛选组件)
```

#### **2. 文件命名规范确认**
```bash
# 按架构约定命名：
页面布局名称: {ModuleName}Page (如: DataVisualizationPage)
业务组件目录: components/{ModuleName}Page/ (与页面布局同名)
Shell组件目录: components/shell/{ComponentType}/ (如: sidebar, topbar)
服务名称: {ModuleName.业务功能}.service.ts
状态名称: {ModuleName.数据类型}.store.ts  
工具名称: {ModuleName.工具功能}.utils.ts
组合式函数: {ModuleName.功能}.composables.ts
```

---

### **第二阶段：文件结构创建**


#### **3. 创建页面布局组件**
```bash
📁 Client/GUI/PagesLayout/
└── {ModuleName}Page.vue ⭐ 新增页面布局组件
└── {ModuleName}Page.scss ⭐ 页面样式文件
这里存放静态资产(图标等等)
```

#### **4. 创建业务组件目录结构**
```bash
📁 Client/GUI/components/{ModuleName}Page/  ⭐ 业务组件目录(与页面布局同名)
├── Component1.vue                          ⭐ 业务组件1
├── Component2.vue                          ⭐ 业务组件2
├── Component3.vue                          ⭐ 业务组件3
└── {ModuleName}Page.scss                   ⭐ 业务组件样式文件
```

**注意：** shell组件目录 `components/shell/{sidebar,topbar}/` 已存在，无需为新页面创建

#### **5. 创建业务逻辑层 (根据需要)**
```bash
📁 Client/Service/{ModuleName}/                 ⭐ 新增服务模块 (独立性强的系统性工具)
├── index.ts                                    ⭐ 服务导出入口
├── {ModuleName}.{业务功能1}.service.ts         ⭐ 系统性业务功能1
├── {ModuleName}.{业务功能2}.service.ts         ⭐ 系统性业务功能2
└── types.ts                                    ⭐ 服务类型定义 (作为附属)
```

**注意：** Service 用于独立性较强的系统性工具，一般工具函数请使用 Utils

#### **6. 创建状态管理层**
```bash
📁 Client/stores/{ModuleName}/                  ⭐ 新增状态模块
├── index.ts                                    ⭐ 统一导出入口 & 数据源管理
├── {ModuleName}.{数据类型1}.store.ts           ⭐ 数据类型1状态管理
├── {ModuleName}.{数据类型2}.store.ts           ⭐ 数据类型2状态管理
├── mock.ts                                     ⭐ 模拟数据定义
├── DataSource/                          ⭐ 数据源定义 (Database/Electron层等)
└── types.ts                                    ⭐ 状态类型定义 (作为附属)
```

**关键职责：**
- `index.ts` 统一管理所有状态的数据来源与走向 (mock vs DataSource)
- `store.ts` 仅负责给 Vue 提供调用的数据，不处理数据获取逻辑
- `DataSource.ts` 负责定义数据如何获取及计算逻辑

#### **7. 创建工具函数层**
```bash
📁 Client/Utils/{ModuleName}/                   ⭐ 新增工具模块
├── index.ts                                    ⭐ 工具导出入口
├── {ModuleName}.helper.utils.ts                ⭐ 辅助工具函数
├── {ModuleName}.validator.utils.ts             ⭐ 验证工具函数
├── {ModuleName}.formatter.utils.ts             ⭐ 格式化工具函数
└── types.ts                                    ⭐ 工具类型定义 (作为附属)
```

#### **8. 创建组合式函数层**
```bash
📁 Client/GUI/composables/{ModuleName}/         ⭐ 新增组合式函数模块
├── index.ts                                    ⭐ composables导出入口
├── use{ModuleName}{功能1}.ts                   ⭐ 功能1组合式函数
├── use{ModuleName}{功能2}.ts                   ⭐ 功能2组合式函数
└── types.ts                                    ⭐ composables类型定义 (作为附属)
```

**注意：** composables 用于集中管理 Vue 的组合式函数，按业务模块分目录组织

---

### **第三阶段：路由与入口配置**

#### **9. 更新外部路由 (仅在需要新的对外入口时)**
```typescript
// Client/GUI/router/routes.ts (仅负责对外的主要路由入口)
const routes = [
  // 现有路由...
  // 注意：大部分路由通过Vue内联路由管理，此处仅添加新的系统级入口
  {
    path: '/newSystem',
    component: () => import('Index/NewSystemEntry.vue'), // 系统入口
    meta: { requiresAuth: true }
  }
];
```

#### **10. 配置主应用布局的内联路由**
```vue
<!-- Client/GUI/layouts/MainLayout.vue -->
<template>
  <div class="main-layout">
    <!-- Shell组件 -->
    <SidebarComponent />
    <TopbarComponent />
    
    <!-- 主内容区 - 通过内联路由决定调用哪个页面布局 -->
    <div class="main-content">
      <router-view />  <!-- 这里显示具体的PagesLayout组件 -->
    </div>
  </div>
</template>

<script setup>
// 内联路由配置示例
const routes = [
  { path: '/dashboard', component: () => import('PagesLayout/DashboardPage.vue') },
  { path: '/datavisualization', component: () => import('PagesLayout/DataVisualizationPage.vue') },
  // 更多页面路由...
];
</script>
```

#### **11. 更新系统入口导航**
```vue
<!-- Client/GUI/Index/MainSystem.vue -->
<template>
  <div class="main-system">
    <nav class="system-navigation">
      <!-- 内部导航，通过内联路由跳转 -->
      <router-link to="/dashboard">仪表板</router-link>
      <router-link to="/datavisualization">数据可视化</router-link>
      <!-- 更多导航项... -->
    </nav>
    
    <!-- 主应用布局容器 -->
    <router-view />
  </div>
</template>
```

---

### **第四阶段：配置更新**

#### **12. 更新导出入口**
```typescript
// Client/stores/index.ts - 添加新store导出
export * from './{ModuleName}';

// Client/GUI/composables/index.ts - 添加新composables导出
export * from './{ModuleName}';

// Client/Service/shared/index.ts - 如果有共享服务，添加导出
// Client/Utils/shared/index.ts - 如果有共享工具，添加导出
```

#### **13. 更新路径别名 (如果需要)**
```typescript
// quasar.config.ts - 在 alias 数组中添加：
{ 
  find: '@{ModuleName}Service', 
  replacement: path.resolve(__dirname, 'Client/Service/{ModuleName}') 
},
{ 
  find: '@{ModuleName}Store', 
  replacement: path.resolve(__dirname, 'Client/stores/{ModuleName}') 
},
```

---

### **第五阶段：开发与测试**

#### **14. 开发顺序建议**
```bash
1️⃣ 先开发 types.ts (各模块附属的类型定义)
2️⃣ 再开发 utils.ts (工具函数层)
3️⃣ 然后开发 DataSource.ts (数据源定义与获取逻辑)
4️⃣ 接着开发 store.ts (状态管理层)
5️⃣ 开发 composables.ts (Vue组合式函数)
6️⃣ 开发 service.ts (系统性工具，如需要)
7️⃣ 开发 PagesLayout Vue组件 (页面布局)
8️⃣ 开发业务 Vue组件 (具体功能组件)
9️⃣ 配置内联路由和导航
🔟 测试完整功能流程
```

#### **15. 验证清单**
```bash
✅ 外部路由能正常访问系统入口
✅ 内联路由能正确跳转到页面布局  
✅ Shell组件能正常显示 (sidebar, topbar等)
✅ 业务组件能正常渲染
✅ 状态管理正常工作 (mock/DataSource切换)
✅ DataSource数据获取和计算逻辑正常
✅ Composables组合式函数工作正常
✅ Utils工具函数工作正常
✅ Service系统性工具正常 (如有)
✅ 静态资源能正确加载 (public/assets)
✅ 类型定义无错误
✅ 完整业务流程测试通过
```

---

### **📋 完整示例文件清单**

假设添加一个 **DataVisualization** 页面：

```
新增文件清单:
├── Client/GUI/PagesLayout/
│   ├── DataVisualizationPage.vue              ⭐ 页面布局组件
│   └── DataVisualizationPage.scss             ⭐ 页面样式
├── Client/GUI/components/DataVisualizationPage/  ⭐ 业务组件目录(与页面布局同名)
│   ├── ChartComponent.vue                     ⭐ 图表组件
│   ├── TableComponent.vue                     ⭐ 表格组件
│   ├── FilterComponent.vue                    ⭐ 筛选组件
│   └── DataVisualizationPage.scss             ⭐ 业务组件样式
├── Client/GUI/composables/DataVisualization/  ⭐ 组合式函数目录
│   ├── index.ts
│   ├── useDataVisualizationChart.ts
│   ├── useDataVisualizationFilter.ts
│   └── types.ts
├── Client/stores/DataVisualization/           ⭐ 状态管理目录
│   ├── index.ts                               ⭐ 数据源管理
│   ├── DataVisualization.chartData.store.ts  ⭐ 图表数据状态
│   ├── DataVisualization.filterState.store.ts ⭐ 筛选状态
│   ├── mock.ts                                ⭐ 模拟数据
│   ├── DataSource.ts                          ⭐ 数据源定义
│   └── types.ts
├── Client/Utils/DataVisualization/            ⭐ 工具函数目录
│   ├── index.ts
│   ├── DataVisualization.chartHelper.utils.ts
│   ├── DataVisualization.formatter.utils.ts
│   └── types.ts
└── Client/Service/DataVisualization/          ⭐ 系统性工具目录(如需要)
    ├── index.ts
    ├── DataVisualization.export.service.ts   ⭐ 导出服务
    └── types.ts

修改文件:
├── Client/GUI/layouts/MainLayout.vue (添加内联路由配置)
├── Client/GUI/Index/MainSystem.vue (添加导航链接)
├── Client/stores/index.ts (导出新store)
├── Client/GUI/composables/index.ts (导出新composables)
└── quasar.config.ts (如需要，添加别名)
注意这个是一个示例，如果不归属于mainlayout或者mainsystem等等，自然不进行归属
注意事项:
⚠️  静态资源按照验证过的规范使用: public/ 或 assets/
⚠️  types.ts 作为各业务目录的附属，不独立设置
⚠️  Service 仅用于独立性强的系统性工具
```

