## ğŸ“ **LlmTranslate ç±»å‹ç³»ç»Ÿè§„èŒƒ**

### **æ ¸å¿ƒè®¾è®¡ç†å¿µ**

```
ğŸ¯ èŒè´£æ˜ç¡®ï¼šå‰ç«¯ç±»å‹ â†” IPC è½¬å‘ â†” åç«¯äº‹ä»¶
ğŸ¯ å•å‘ä¾èµ–ï¼šåç«¯å¯¼å…¥å‰ç«¯ç±»å‹ï¼Œå‰ç«¯æ°¸ä¸å¯¼å…¥åç«¯ç±»å‹
ğŸ¯ åˆ«åè½¬å‘ï¼šæ‰€æœ‰è·¨è¿›ç¨‹å¯¼å…¥ç»Ÿä¸€é€šè¿‡ä¸­è½¬å±‚
ğŸ¯ åˆ†ç¦»ç§æœ‰ï¼šæœåŠ¡å†…éƒ¨ç±»å‹ä¸æš´éœ²ç»™ IPC å±‚
```

---

### **ç›®å½•ç»“æ„åŠæ–‡ä»¶èŒè´£**

#### **ç¬¬1å±‚ï¼šå‰ç«¯ç±»å‹å®šä¹‰**
ğŸ“ **ä½ç½®ï¼š** `Nimbria/Client/GUI/DemoPage/LlmTranslate/types/`

```
LlmTranslate/types/
â”œâ”€â”€ index.ts          â­ ç»Ÿä¸€å¯¼å‡ºå£ï¼Œæ‰€æœ‰ç±»å‹ä»è¿™é‡Œå‡º
â”œâ”€â”€ config.ts         ã€æ ¸å¿ƒã€‘ç”¨æˆ·å¡«å†™çš„é…ç½® + BatchConfig + å¯¼å‡ºé…ç½®
â”œâ”€â”€ batch.ts          ã€æ ¸å¿ƒã€‘æ‰¹æ¬¡æ•°æ®ç»“æ„ + BatchStats
â”œâ”€â”€ task.ts           ã€æ ¸å¿ƒã€‘ä»»åŠ¡æ•°æ®ç»“æ„ + TaskMetadata
â””â”€â”€ api.ts            ã€æ ¸å¿ƒã€‘IPC API è¯·æ±‚/å“åº”ç±»å‹
```

**æ–‡ä»¶èŒè´£è¯¦è§£ï¼š**

| æ–‡ä»¶ | èŒè´£ | è°ä½¿ç”¨ | å¯¼å‡ºå†…å®¹ |
|------|------|--------|--------|
| `config.ts` | **åŸç‚¹ï¼š** ç”¨æˆ·åœ¨ HomePage å¡«å†™è¡¨å•æ—¶çš„ç±»å‹æºå¤´ | å‰ç«¯Storeã€åç«¯IPCã€åç«¯Service | `TranslateConfig`, `BatchConfig`, `ExportConfig` |
| `batch.ts` | **æ•°æ®åº“æ˜ å°„ï¼š** å‰ç«¯æ¸²æŸ“æ‰¹æ¬¡å¡ç‰‡ | å‰ç«¯ç»„ä»¶ã€åç«¯IPC | `Batch`, `BatchStats`, `BatchStatus` |
| `task.ts` | **ä»»åŠ¡è¯¦æƒ…ï¼š** æ¯ä¸ªä»»åŠ¡çš„å®Œæ•´æ•°æ®ï¼ˆå«å…ƒæ•°æ®ï¼‰ | å‰ç«¯ç»„ä»¶ã€åç«¯IPC | `Task`, `TaskMetadata`, `TaskStatus` |
| `api.ts` | **å¥‘çº¦å®šä¹‰ï¼š** IPC è¯·æ±‚å’Œå“åº”çš„æ ¼å¼ | IPC Handlerã€å‰ç«¯Datasource | API ç±»å‹ |

**è§„èŒƒï¼š** è¿™é‡Œçš„ç±»å‹ **ç»ä¸æ¶‰åŠ** åç«¯çš„æœåŠ¡é€»è¾‘æˆ–äº‹ä»¶ï¼Œåªå®šä¹‰æ•°æ®ç»“æ„ã€‚

---

#### **ç¬¬2å±‚ï¼šåç«¯ç±»å‹è½¬å‘ï¼ˆæ¡¥æ¥å±‚ï¼‰**
ğŸ“ **ä½ç½®ï¼š** `Nimbria/src-electron/types/LlmTranslate/`

```
LlmTranslate/
â”œâ”€â”€ index.ts          â­ æ ¹å¯¼å‡ºå£ï¼ˆexport client å’Œ backendï¼‰
â”œâ”€â”€ client/
â”‚   â””â”€â”€ index.ts      ğŸŒ‰ å°†å‰ç«¯ç±»å‹é€šè¿‡åˆ«åé‡æ–°å¯¼å‡ºç»™åç«¯
â””â”€â”€ backend/
    â”œâ”€â”€ index.ts      ã€æ ¹å¯¼å‡ºã€‘
    â”œâ”€â”€ events.ts     ã€åç«¯ç‹¬æœ‰ã€‘äº‹ä»¶ç±»å‹ï¼ˆå¤–éƒ¨ä¸åº”ä½¿ç”¨ï¼‰
    â””â”€â”€ database.ts   ã€åç«¯ç‹¬æœ‰ã€‘æ•°æ®åº“è¡Œç»“æ„ï¼ˆå¤–éƒ¨ä¸åº”ä½¿ç”¨ï¼‰
```

**client/index.ts çš„ä½œç”¨ï¼š**
```typescript
// âœ… åˆ«åå¯¼å…¥å‰ç«¯è·¯å¾„
export type { TranslateConfig, Batch, Task, ... } from '@demo/LlmTranslate/types'

// ğŸ“ æ³¨é‡Šæ˜ç¡®æ ‡æ³¨ï¼šè¿™äº›æ˜¯å‰ç«¯å®šä¹‰çš„ï¼Œæˆ‘åªæ˜¯è½¬å‘
```

**backend/events.ts çš„ä½œç”¨ï¼š**
```typescript
// âŒ è¿™é‡Œå®šä¹‰çš„äº‹ä»¶ç±»å‹ç»ä¸å¯¼å‡º
export interface BatchCreatedEvent { ... }      // åªåœ¨ llm-translate-service å†…éƒ¨å’Œ handlers ä¸­ä½¿ç”¨
export interface TaskProgressEvent { ... }      // ä¸é€šè¿‡ client/index.ts å¯¼å‡º
```

**ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸ªæ¡¥æ¥å±‚ï¼š**
1. **æ¸…æ™°èŒè´£ï¼š** å¼€å‘è€…çœ‹åˆ° `src-electron/types/LlmTranslate` å°±çŸ¥é“è¿™æ˜¯ LlmTranslate çš„å®Œæ•´ç±»å‹
2. **æ˜“äºè¿ç§»ï¼š** å¦‚æœå‰ç«¯ç±»å‹è·¯å¾„æ”¹äº†ï¼Œåªéœ€æ”¹ä¸€ä¸ªæ–‡ä»¶
3. **é˜²æ­¢æ··ä¹±ï¼š** åç«¯ Service å¯¼å…¥è‡ªå·±çš„ç±»å‹æ—¶ï¼Œä¸ä¼šææ··è·¯å¾„

---

#### **ç¬¬3å±‚ï¼šå‰ç«¯ Store å’Œ Datasource**
ğŸ“ **ä½ç½®ï¼š** `Nimbria/Client/GUI/DemoPage/LlmTranslate/stores/`

```
stores/
â”œâ”€â”€ index.ts                      ã€Store å¯¼å‡ºã€‘
â”œâ”€â”€ translate.store.ts            ã€Pinia Storeã€‘æ ¸å¿ƒçŠ¶æ€ç®¡ç†
â”œâ”€â”€ translate.datasource.ts       ã€IPC é€‚é…å±‚ã€‘
â”œâ”€â”€ translate.mock.ts             ã€Mock æ•°æ®ã€‘
â”œâ”€â”€ translate.types.ts            ã€Store å†…éƒ¨çŠ¶æ€ç±»å‹ã€‘
â””â”€â”€ types/
    â”œâ”€â”€ state.ts                  ã€å¯é€‰ã€‘å¦‚æœ types.ts å¤ªå¤§å¯æ‹†åˆ†
    â”œâ”€â”€ operations.ts             ã€å¯é€‰ã€‘æ“ä½œç›¸å…³ç±»å‹
    â””â”€â”€ context.ts                ã€å¯é€‰ã€‘ä¸Šä¸‹æ–‡ç±»å‹
```

**ç±»å‹å¯¼å…¥è§„èŒƒï¼š**
```typescript
// âœ… ä»å‰ç«¯ç±»å‹å¯¼å…¥ï¼ˆè¿™æ˜¯æºå¤´ï¼‰
import type { Batch, Task, TranslateConfig } from '../types'

// âŒ ä¸¥ç¦å¯¼å…¥åç«¯ç±»å‹
import type { BatchCreatedEvent } from 'src-electron/types/LlmTranslate/backend'  // ğŸš«
```

---

#### **ç¬¬4å±‚ï¼šåç«¯ Service å±‚**
ğŸ“ **ä½ç½®ï¼š** `Nimbria/src-electron/services/llm-translate-service/`

```
llm-translate-service/
â”œâ”€â”€ llm-translate-service.ts      ã€Service ä¸»ç±»ã€‘
â”œâ”€â”€ types.ts                      ã€ç§æœ‰ç±»å‹ã€‘ä¸æš´éœ²ï¼Œä¸å¯¼å‡º
â””â”€â”€ utils/                         ã€å·¥å…·å‡½æ•°ã€‘
```

**Service å†…éƒ¨çš„ç±»å‹å¯¼å…¥è§„èŒƒï¼š**
```typescript
// âœ… å¯¼å…¥å‰ç«¯å®šä¹‰çš„æ•°æ®ç»“æ„
import type { Batch, Task, TranslateConfig, BatchConfig } from '../../types/LlmTranslate'

// âœ… å¯¼å…¥åç«¯äº‹ä»¶ç±»å‹ï¼ˆç§æœ‰ï¼‰
import type { BatchCreatedEvent } from '../../types/LlmTranslate/backend'

// âŒ ä¸è¦å¯¼å…¥ Service è‡ªå·±ç›®å½•ä¸‹çš„ types.ts
import type { SomeInternalType } from './types'  // ğŸš« é™¤éæ˜¯çœŸæ­£å†…éƒ¨ä½¿ç”¨
```

---

#### **ç¬¬5å±‚ï¼šIPC Handler å±‚**
ğŸ“ **ä½ç½®ï¼š** `Nimbria/src-electron/ipc/main-renderer/llm-translate-handlers.ts`

```typescript
/**
 * IPC çš„èŒè´£ï¼šå……å½“ç¿»è¯‘å®˜
 * - æ¥æ”¶ IPC è¯·æ±‚ï¼ˆè¯·æ±‚ç±»å‹æ¥è‡ª types/api.tsï¼‰
 * - è°ƒç”¨ Service æ‰§è¡Œä¸šåŠ¡é€»è¾‘
 * - è¿”å› IPC å“åº”
 */

// âœ… å¯¼å…¥è§„èŒƒ
import type { TranslateConfig, Batch, Task } from '../../types/LlmTranslate'
import type { BatchCreatedEvent } from '../../types/LlmTranslate/backend'
import type { LlmTranslateService } from '../../services/llm-translate-service/llm-translate-service'
```

---

### **å®Œæ•´è°ƒç”¨é“¾ï¼šä»å‰ç«¯åˆ°åç«¯**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£  å‰ç«¯ HomePage è¡¨å•                                  â”‚
â”‚    ï¼ˆç”¨æˆ·å¡«å†™é…ç½®ï¼‰                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€ ç»„è£… TranslateConfig å¯¹è±¡
                   â”‚   æ¥æº: types/config.ts
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£  å‰ç«¯ Store (translate.store.ts)                     â”‚
â”‚    ï¼ˆè°ƒç”¨ Datasource.createBatch()ï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€ è½¬æ¢ Proxy â†’ Plain Object
                   â”‚   ä½¿ç”¨ JSON.parse(JSON.stringify())
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£  Datasource (translate.datasource.ts)                â”‚
â”‚    ï¼ˆé€šè¿‡ IPC å‘é€è¯·æ±‚ï¼‰                                â”‚
â”‚                                                         â”‚
â”‚    electronAPI.createBatch({ config: plainConfig })    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â•â•â•â•â•â•â•â•â•â•â•â• IPC è¾¹ç•Œ â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£  IPC Handler (llm-translate-handlers.ts)             â”‚
â”‚    ç›‘å¬ 'create-batch' é€šé“                              â”‚
â”‚                                                         â”‚
â”‚    ipcMain.handle('create-batch', (event, args) => {  â”‚
â”‚      return llmTranslateService.createBatchAsync()    â”‚
â”‚    })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€ æå– config: TranslateConfig
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5ï¸âƒ£  Service (llm-translate-service.ts)                  â”‚
â”‚    ï¼ˆæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼‰                                      â”‚
â”‚                                                         â”‚
â”‚    createBatchAsync(config: TranslateConfig) {        â”‚
â”‚      - æå– BatchConfig                               â”‚
â”‚      - åˆ†ç‰‡å†…å®¹                                        â”‚
â”‚      - åˆ›å»º Task å¯¹è±¡ï¼ˆå« TaskMetadataï¼‰              â”‚
â”‚      - å†™å…¥æ•°æ®åº“                                      â”‚
â”‚      - å‘å‡ºäº‹ä»¶ ('batch:created')                     â”‚
â”‚      - è¿”å› Batch å¯¹è±¡                                â”‚
â”‚    }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€ å‘å‡ºäº‹ä»¶ç»™æ‰€æœ‰çª—å£
                   â”‚   event: 'batch:created'
                   â”‚   data: BatchCreatedEvent
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6ï¸âƒ£  IPC Handler äº‹ä»¶å¹¿æ’­                                â”‚
â”‚    ï¼ˆå‘æ‰€æœ‰æ¸²æŸ“çª—å£å¹¿æ’­äº‹ä»¶ï¼‰                            â”‚
â”‚                                                         â”‚
â”‚    llmTranslateService.on('batch:created', (data) => {â”‚
â”‚      BrowserWindow.getAllWindows().forEach(win => {   â”‚
â”‚        win.webContents.send('llm-translate:batch-..', data)
â”‚      })                                                â”‚
â”‚    })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â•â•â•â•â•â•â•â•â•â•â•â• IPC è¾¹ç•Œ â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7ï¸âƒ£  å‰ç«¯ç›‘å¬äº‹ä»¶ (translate.store.ts)                   â”‚
â”‚    ï¼ˆæ›´æ–°å‰ç«¯çŠ¶æ€ï¼‰                                      â”‚
â”‚                                                         â”‚
â”‚    electronAPI.on('llm-translate:batch-created', ...) â”‚
â”‚      â†“                                                 â”‚
â”‚      æ›´æ–° store.batchList                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **åˆ«åé…ç½®è¯¦è§£**

**ğŸ“ åœ¨ `tsconfig.json` ä¸­å®šä¹‰ï¼š**
```json
{
  "paths": {
    "@demo": ["Client/GUI/DemoPage"],
    "@demo/*": ["Client/GUI/DemoPage/*"]
  }
}
```

**âœ… æ­£ç¡®ä½¿ç”¨åˆ«åï¼š**

| ä½ç½® | å¯¼å…¥è¯­å¥ | è§£æä¸º |
|------|---------|------|
| å‰ç«¯ç»„ä»¶ | `import type { Batch } from '@demo/LlmTranslate/types'` | `Client/GUI/DemoPage/LlmTranslate/types/index.ts` |
| åç«¯ client/index.ts | `export from '@demo/LlmTranslate/types'` | åŒä¸Š |
| åç«¯ Service | `import type { Batch } from '../../types/LlmTranslate'` | `src-electron/types/LlmTranslate/client/index.ts` |

**âŒ é”™è¯¯ç”¨æ³•ï¼š**
```typescript
// âŒ ç›´æ¥å¯¼å…¥åç«¯è·¯å¾„ï¼ˆä¸èµ°åˆ«åï¼‰
import { Batch } from 'src-electron/types/LlmTranslate'

// âŒ è·¨è¶Šè½¬å‘å±‚ç›´æ¥å¯¼å…¥å‰ç«¯
import { Batch } from 'Client/GUI/DemoPage/LlmTranslate/types'  // åœ¨åç«¯ä¸­
```

---

### **æ•°æ®æµä¸ç±»å‹æ˜ å°„**

```
ç”¨æˆ·è¾“å…¥è¡¨å•
    â†“
TranslateConfigï¼ˆå‰ç«¯ types/config.tsï¼‰
    â†“ [IPC]
IPC Request: CreateBatchRequestï¼ˆå‰ç«¯ types/api.tsï¼‰
    â†“ [Handler]
æå– content + BatchConfig
    â†“ [Service]
1. åˆ†ç‰‡å†…å®¹å¾—åˆ°å¤šä¸ª chunk
2. ä¸ºæ¯ä¸ª chunk åˆ›å»º Taskï¼š
   {
     id: '...',
     content: chunk,
     metadataJson: JSON.stringify({
       systemPrompt: config.systemPrompt,
       modelId: config.modelId,
       ...
     })
   }
3. æ‰¹é‡æ’å…¥æ•°æ®åº“ Llmtranslate_tasks
    â†“ [å‘å‡ºäº‹ä»¶]
BatchCreatedEventï¼ˆåç«¯ backend/events.tsï¼‰
    â†“ [IPC å¹¿æ’­]
win.webContents.send('llm-translate:batch-created')
    â†“ [å‰ç«¯ç›‘å¬]
æ›´æ–° store.batchList: Batch[]
```

---

### **å¸¸è§é”™è¯¯æ¨¡å¼ âŒ å’Œçº æ­£æ–¹æ³• âœ…**

#### **é”™è¯¯1ï¼šå‰ç«¯å¯¼å…¥åç«¯ç±»å‹**
```typescript
// âŒ å‰ç«¯ç»„ä»¶ä¸­
import { BatchCreatedEvent } from '../../backend/types'

// âœ… æ­£ç¡®åšæ³•
// åç«¯äº‹ä»¶åªåœ¨åç«¯å¤„ç†ï¼Œå‰ç«¯æ— éœ€å¯¼å…¥
// å‰ç«¯é€šè¿‡ IPC æ¶ˆæ¯æ¥æ”¶æ•°æ®ï¼Œç±»å‹ç”± api.ts å®šä¹‰
```

#### **é”™è¯¯2ï¼šåç«¯ç›´æ¥å¯¼å…¥å‰ç«¯è·¯å¾„**
```typescript
// âŒ åç«¯ Service ä¸­
import { Batch } from 'Client/GUI/DemoPage/LlmTranslate/types'

// âœ… æ­£ç¡®åšæ³•
import type { Batch } from '../../types/LlmTranslate'
// è¿™æ ·å¯¼å…¥çš„æ˜¯ src-electron/types/LlmTranslate/client/index.ts
// å®ƒåœ¨åº•å±‚è½¬å‘äº†å‰ç«¯ç±»å‹ï¼Œä½†å¼€å‘è€…çœ‹èµ·æ¥"ç”¨çš„å°±æ˜¯åç«¯çš„"
```

#### **é”™è¯¯3ï¼šService å†…éƒ¨ç±»å‹æš´éœ²**
```typescript
// âŒ src-electron/services/llm-translate-service/types.ts
export interface InternalChunkTask { ... }

// ç„¶ååœ¨ IPC Handler ä¸­
import { InternalChunkTask } from '../services/llm-translate-service/types'

// âœ… æ­£ç¡®åšæ³•
// æŠŠéœ€è¦è·¨å±‚å…±äº«çš„ç±»å‹æ”¾åˆ° src-electron/types/LlmTranslate/backend/
// Service å†…éƒ¨ç§æœ‰çš„ç±»å‹ç›´æ¥åœ¨ service.ts ä¸­å®šä¹‰æˆ–ä½¿ç”¨
```

#### **é”™è¯¯4ï¼šIPC API ç±»å‹å®šä¹‰æ··ä¹±**
```typescript
// âŒ æ²¡æœ‰ç»Ÿä¸€çš„ API ç±»å‹å®šä¹‰
// Store ç›´æ¥è°ƒç”¨ electronAPI.createBatch(config)
// æ²¡æœ‰çº¦å®šè¯·æ±‚/å“åº”æ ¼å¼

// âœ… æ­£ç¡®åšæ³•
// types/api.ts ä¸­å®šä¹‰
export interface CreateBatchRequest {
  config: TranslateConfig
}
export interface CreateBatchResponse {
  batch: Batch
}

// Store ä¸­
const result: CreateBatchResponse = await electronAPI.createBatch(request)
```

---

### **æ–°å¢æ¨¡å—æ—¶çš„æ¨¡æ¿**

å½“éœ€è¦æ–°å¢ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼ˆå¦‚ `OtherFeature`ï¼‰æ—¶ï¼š

```
1ï¸âƒ£  å‰ç«¯ç±»å‹ï¼ˆå‰ç«¯è‡ªå·±ç»´æŠ¤ï¼‰
   Client/GUI/DemoPage/OtherFeature/types/
   â”œâ”€â”€ index.ts
   â”œâ”€â”€ config.ts        ã€é…ç½®ç±»å‹ã€‘
   â”œâ”€â”€ models.ts        ã€æ•°æ®æ¨¡å‹ã€‘
   â””â”€â”€ api.ts           ã€IPC æ¥å£ã€‘

2ï¸âƒ£  åç«¯è½¬å‘ï¼ˆåç«¯ç»´æŠ¤ï¼‰
   src-electron/types/OtherFeature/
   â”œâ”€â”€ index.ts
   â”œâ”€â”€ client/index.ts  ã€è½¬å‘å‰ç«¯ç±»å‹ã€‘
   â””â”€â”€ backend/
       â”œâ”€â”€ index.ts
       â”œâ”€â”€ events.ts    ã€åç«¯äº‹ä»¶ã€‘
       â””â”€â”€ database.ts  ã€DB ç»“æ„ã€‘

3ï¸âƒ£  å¯¼å…¥è§„èŒƒ
   å‰ç«¯ï¼šfrom '@demo/OtherFeature/types'
   åç«¯ï¼šfrom '../../types/OtherFeature'
```

---

### **æ£€æŸ¥æ¸…å• âœ…**

åˆ›å»ºæ–°æ¨¡å—æˆ–ä¿®æ”¹ç±»å‹æ—¶ï¼Œæ£€æŸ¥ä»¥ä¸‹é¡¹ï¼š

- [ ] å‰ç«¯ç±»å‹æ˜¯å¦éƒ½åœ¨ `Client/GUI/DemoPage/<Module>/types/` ä¸­ï¼Ÿ
- [ ] åç«¯æ˜¯å¦é€šè¿‡ `src-electron/types/<Module>/client/` è½¬å‘ï¼Ÿ
- [ ] åç«¯ç‹¬æœ‰çš„ç±»å‹ï¼ˆäº‹ä»¶ã€DBï¼‰æ˜¯å¦åœ¨ `backend/` ä¸­ï¼Ÿ
- [ ] Service å†…éƒ¨ç±»å‹æ˜¯å¦æœªè¢«æš´éœ²ï¼Ÿ
- [ ] IPC API ç±»å‹æ˜¯å¦åœ¨ `api.ts` ä¸­å®šä¹‰ï¼Ÿ
- [ ] æ‰€æœ‰å¯¼å…¥æ˜¯å¦éƒ½ä½¿ç”¨äº†åˆ«åæˆ–æ­£ç¡®çš„ç›¸å¯¹è·¯å¾„ï¼Ÿ
- [ ] å‰ç«¯æ˜¯å¦æœ‰å¯¼å…¥åç«¯ç±»å‹ï¼Ÿï¼ˆåº”è¯¥æ²¡æœ‰ï¼‰
- [ ] æ˜¯å¦æœ‰é‡å¤å®šä¹‰ç›¸åŒç±»å‹ï¼Ÿ

