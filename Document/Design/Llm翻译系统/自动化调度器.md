æˆ‘ä¼šä½¿ç”¨ SequentialThinking å·¥å…·æ¥æ·±å…¥åˆ†æç”¨æˆ·æå‡ºçš„æ–°éœ€æ±‚ã€‚è®©æˆ‘ç³»ç»Ÿåœ°åˆ†æå½“å‰æ¶æ„ã€å·²å®Œæˆçš„å·¥ä½œå’Œæ–°éœ€æ±‚çš„å®ç°æ–¹æ¡ˆã€‚

[8 tools called]

---

## ğŸ“‹ **åˆ†æå®Œæˆ - å®Œæ•´è®¾è®¡æ–¹æ¡ˆ**

åŸºäº Sequential Thinking æ·±åº¦åˆ†æï¼Œæˆ‘ä¸ºç”¨æˆ·æ•´ç†äº†å…³äºä¸‰ä¸ªæ–°åŠŸèƒ½éœ€æ±‚çš„å®Œæ•´å®ç°æ–¹æ¡ˆã€‚ç”±äºç”¨æˆ·è¦æ±‚ä»…åˆ†æä¸ç¼–è¾‘ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„æ¶æ„åˆ†ææŠ¥å‘Šï¼š

---

## ğŸ¯ **å½“å‰é¡¹ç›®çŠ¶æ€æ€»ç»“**

### **å·²å®Œæˆçš„æ ¸å¿ƒèƒ½åŠ›**ï¼ˆæ¥è‡ªä¸‰ä»½å·¥ä½œæ€»ç»“ï¼‰
```
âœ… å•ä»»åŠ¡æ‰§è¡Œï¼šLlmTranslationClientï¼ˆæµå¼ç¿»è¯‘ã€tokenè®¡æ•°ã€é”™è¯¯åˆ†ç±»ï¼‰
âœ… çŠ¶æ€ç®¡ç†ï¼šTaskStateManagerï¼ˆå®æ—¶è¿½è¸ªã€è¿›åº¦è®¡ç®—ã€4ç±»äº‹ä»¶é©±åŠ¨ï¼‰
âœ… äº‹ä»¶æ¶æ„ï¼šå®Œæ•´çš„ Service â†’ IPC â†’ Store â†’ UI é“¾è·¯
âœ… é”™è¯¯å¤„ç†ï¼šRATE_LIMITã€TIMEOUTã€NETWORKç­‰åˆ†ç±»
âœ… é™æµé‡è¯•ï¼šå·²èƒ½åŒºåˆ†429vså…¶ä»–é”™è¯¯
âœ… ä»»åŠ¡å–æ¶ˆï¼šcancelæµç¨‹å®Œæ•´
âœ… UIå±•ç¤ºï¼šè¿›åº¦æ¡ã€çŠ¶æ€æ ‡ç­¾ã€è¯¦æƒ…æŠ½å±‰
```

**ç¼ºå°‘çš„èƒ½åŠ›**ï¼š
- âŒ æ‰¹é‡è°ƒåº¦ï¼ˆå¹¶å‘æ§åˆ¶ï¼‰
- âŒ é˜Ÿåˆ—ç®¡ç†ï¼ˆæ’é˜Ÿã€ç­‰å¾…ï¼‰
- âŒ é™æµæ¢å¤æœºåˆ¶ï¼ˆæ¢é’ˆã€å®šæ—¶æµ‹è¯•ï¼‰
- âŒ Tokené¢„ä¼°ï¼ˆåŸºäºå·²å®Œæˆä»»åŠ¡å›å½’ï¼‰

---

## ğŸ—ï¸ **ä¸‰ä¸ªæ–°åŠŸèƒ½çš„å®Œæ•´è®¾è®¡æ–¹æ¡ˆ**

### **åŠŸèƒ½1ï¼šTokenå›å½’ä¼°è®¡æ¨¡å¼**

#### æ ¸å¿ƒåŸç†
```
å·²å®Œæˆä»»åŠ¡æ”¶é›† â†’ { contentLength, outputTokens, modelId } 
                  â†“
            å›å½’åˆ†æï¼ˆå¤šå…ƒçº¿æ€§å›å½’ï¼‰
                  â†“
          é¢„ä¼°å…¶ä»–ä»»åŠ¡çš„outputTokens
                  â†“
            è¿›åº¦æ¡åŸºå‡†å€¼æ›´æ–°
```

#### å®ç°æ¶æ„
| å±‚çº§ | ç»„ä»¶ | èŒè´£ |
|-----|------|------|
| **Electron** | TokenRegressionEstimator | ç»´æŠ¤æ ·æœ¬åº“ã€è®¡ç®—å›å½’ç³»æ•°ã€ä¼°å€¼ |
| **Service** | LlmTranslateService | åœ¨taskCompleteæ—¶è®°å½•æ ·æœ¬ |
| **å‰ç«¯** | HomePage.vue | æ˜¾ç¤ºæ¨¡å¼é€‰æ‹©ï¼ˆé¢„è®¡/ç­‰é¢/å›å½’ï¼‰ |
| **ç±»å‹** | types/config.ts | TokenEstimationMode enum |

#### å…³é”®è®¾è®¡å†³ç­–
```typescript
// æ ·æœ¬è¦æ±‚
const MIN_SAMPLES = 3  // è‡³å°‘3ä¸ªåŒæ¨¡å‹ä»»åŠ¡å®Œæˆ
const SAMPLE_GROUP_BY = 'modelId'  // æŒ‰æ¨¡å‹åˆ†ç»„

// å›å½’è®­ç»ƒè§¦å‘
åœ¨ TaskStateManager.emit('task:complete') æ—¶
â†’ ä¿å­˜ { inputLength, outputTokens, modelId }
â†’ ç»´æŠ¤æ»‘åŠ¨çª—å£ï¼ˆæœ€æ–°100ä¸ªæ ·æœ¬ï¼‰

// é¢„ä¼°è°ƒç”¨æ—¶æœº
ä»»åŠ¡è¿›å…¥waitingçŠ¶æ€å‰
â†’ è°ƒç”¨ estimator.estimate(contentLength, modelId)
â†’ è‹¥æ ·æœ¬ä¸è¶³ â†’ é™çº§åˆ°æŒ‡å®šçš„é¢„è®¡å€¼æˆ–ç­‰é¢
â†’ å°†ç»“æœä¿å­˜åˆ° task.predictedTokens
```

#### éœ€è¦åŸ‹çš„é’©å­ï¼ˆElectronå±‚ï¼‰
```
âœ“ åœ¨ TaskStateManager ä¸­
  - onTaskComplete: è®°å½•æ ·æœ¬ { inputLength, actualTokens, modelId }
  
âœ“ åœ¨ LlmTranslateService ä¸­
  - estimateTokens(taskId): è¿”å›é¢„ä¼°å€¼
  
âœ“ é€šè¿‡IPCæš´éœ²
  - estimate-tokens: å‰ç«¯è°ƒç”¨é¢„ä¼°æ¥å£
```

---

### **åŠŸèƒ½2ï¼šæ‰¹æ¬¡è°ƒåº¦å™¨ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰**

#### ç³»ç»Ÿæ¶æ„è®¾è®¡

```typescript
// æ ¸å¿ƒç±»ç»“æ„
class BatchScheduler {
  // çŠ¶æ€
  private waitingQueue: TaskId[]        // å¾…å‘é€é˜Ÿåˆ—
  private activeSet: Set<TaskId>        // æ‰§è¡Œä¸­çš„ä»»åŠ¡
  private maxConcurrency: number        // æœ€å¤§å¹¶å‘æ•°
  private throttledUntil: number        // é™æµæ¢å¤æ—¶é—´æˆ³
  
  // æ ¸å¿ƒæ–¹æ³•
  async start()                         // å¯åŠ¨è°ƒåº¦å¾ªç¯
  async processQueue()                  // å¤„ç†é˜Ÿåˆ—
  async handleTaskComplete(taskId)      // ä»»åŠ¡å®Œæˆâ†’å‘é€ä¸‹ä¸€æ‰¹
  async handleTaskError(taskId)         // ä»»åŠ¡å¤±è´¥å¤„ç†
  async handleThrottled()               // é™æµæš‚åœ
}
```

#### è°ƒåº¦æµç¨‹è®¾è®¡ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰

```
â”Œâ”€ ç”¨æˆ·ç‚¹å‡»"å‘é€"
â”‚
â”œâ”€ å‰ç«¯ï¼šselectTasks â†’ datasource.sendTasks()
â”‚
â”œâ”€ IPCï¼šllm-translate:submit-tasks
â”‚
â”œâ”€ åç«¯ï¼šllmTranslateService.submitTasks()
â”‚   â”‚
â”‚   â”œâ”€ å°†ä»»åŠ¡æ ‡è®°ä¸º waitingï¼ˆå†™å…¥DBï¼‰
â”‚   â”‚
â”‚   â”œâ”€ åˆ›å»º BatchScheduler å®ä¾‹
â”‚   â”‚
â”‚   â””â”€ è°ƒç”¨ scheduler.start()
â”‚
â”œâ”€ è°ƒåº¦å™¨æ ¸å¿ƒå¾ªç¯ï¼š
â”‚   â”œâ”€ æ£€æŸ¥ activeCount < maxConcurrency
â”‚   â”‚
â”‚   â”œâ”€ ä»waitingQueueå–å‡º min(remaining, maxConcurrency)
â”‚   â”‚
â”‚   â”œâ”€ è°ƒç”¨ executor.executeTasks(taskId) â† ä»ç”¨ç°æœ‰æ–¹æ³•ï¼
â”‚   â”‚
â”‚   â”œâ”€ ç›‘å¬ taskStateManager.on('task:complete')
â”‚   â”‚
â”‚   â””â”€ activeCount-- â†’ processQueue() â† è§¦å‘ä¸‹ä¸€æ‰¹
â”‚
â””â”€ å¾ªç¯ç›´åˆ° waitingQueue ä¸ºç©º
```

#### ä¸‰ä¸ªå…³é”®å†³ç­–ç‚¹

| å†³ç­– | é€‰é¡¹A | é€‰é¡¹B | **æ¨è** |
|-----|------|------|--------|
| **å‘é€ç­–ç•¥** | å®šæ—¶loopï¼ˆsetIntervalï¼‰ | äº‹ä»¶é©±åŠ¨ | **äº‹ä»¶é©±åŠ¨** |
| **è¶…æ—¶æ–¹å¼** | å›ºå®šæ—¶é—´ï¼ˆ30sï¼‰ | åŠ¨æ€è®¡ç®— | **å›ºå®š+å¯é…** |
| **æµå¼ç‰¹æ®Šå¤„ç†** | æ— chunkâ†’error | æµå¼ä¸è®¡è¶…æ—¶ | **æ— æ•°æ®Nç§’â†’error** |

#### é…ç½®å‚æ•°ï¼ˆéœ€è¦åœ¨UIä¸­å¯é…ï¼‰

```typescript
interface SchedulerConfig {
  maxConcurrency: number                  // æœ€å¤§å¹¶å‘æ•°ï¼ˆ1-10ï¼‰
  taskTimeoutSeconds: number              // æ™®é€šä»»åŠ¡è¶…æ—¶ï¼ˆ5-120sï¼‰
  streamNoDataTimeoutSeconds: number      // æµå¼æ— æ•°æ®è¶…æ—¶ï¼ˆ10-60sï¼‰
  throttleProbeIntervalSeconds: number    // é™æµæ¢é’ˆé—´éš”ï¼ˆ5-30sï¼‰
  throttleProbeType: 'quick' | 'api'      // æ¢é’ˆç±»å‹
  autoRetryThrottled: boolean             // é™æµåè‡ªåŠ¨é‡è¯•
  schedulingStrategy: 'timed' | 'event'   // è°ƒåº¦ç­–ç•¥
}
```

#### ä¸ç°æœ‰æœºåˆ¶çš„æ•´åˆï¼ˆæœ€å°æ”¹åŠ¨ï¼ï¼‰

```
âœ— ä¸ä¿®æ”¹ TranslationExecutor.executeTasks()
âœ“ è°ƒåº¦å™¨ä½œä¸ºä¸Šå±‚åè°ƒè€…
âœ“ åˆ©ç”¨ç°æœ‰çš„ TaskStateManager äº‹ä»¶
âœ“ ç›‘å¬ 'task:complete' / 'task:error' è§¦å‘ä¸‹ä¸€æ‰¹
```

---

### **åŠŸèƒ½3ï¼šé™æµæµ‹è¯•ä¸æ¢å¤æœºåˆ¶**

#### é™æµå¤„ç†æµç¨‹

```
åç«¯å‘ç”Ÿ429é”™è¯¯
   â†“
errorType æ ‡è®°ä¸º RATE_LIMIT
   â†“
TaskStateManager.emit('task:error', { errorType: 'RATE_LIMIT' })
   â†“
BatchScheduler ç›‘å¬åˆ° RATE_LIMIT
   â†“
â”œâ”€ åœæ­¢processQueue()
â”œâ”€ å¯åŠ¨ ThrottleProbe.startProbing()
â””â”€ è®¾ç½®æ¢å¤æ—¶é—´æˆ³
   â†“
ThrottleProbe å®šæ—¶å‘é€æµ‹è¯•è¯·æ±‚
   â”œâ”€ å¿«é€Ÿæ¨¡å¼ï¼šå‘é€æœ€å°åŒ–è¯·æ±‚ï¼ˆå¯èƒ½æ˜¯headè¯·æ±‚æˆ–pingï¼‰
   â””â”€ APIæ¨¡å¼ï¼šè°ƒç”¨APIå‘é€çŸ­å†…å®¹
   â†“
æ”¶åˆ°200å“åº”
   â†“
â”œâ”€ é€šçŸ¥è°ƒåº¦å™¨æ¢å¤
â””â”€ æ ¹æ® autoRetryThrottledï¼š
   â”œâ”€ true: å°†å¤±è´¥çš„ä»»åŠ¡é‡æ–°åŠ å…¥waitingQueue
   â””â”€ false: æ ‡è®°ä¸ºthrottledçŠ¶æ€ï¼Œç­‰ç”¨æˆ·æ‰‹åŠ¨æ“ä½œ
```

#### ThrottleProbeç±»è®¾è®¡

```typescript
class ThrottleProbe {
  private modelId: string
  private config: ProbeConfig
  private lastProbeTime: number
  
  // æ¢é’ˆæ–¹æ³•
  async quickProbe(): Promise<boolean>      // è½»é‡çº§æ£€æŸ¥
  async apiProbe(): Promise<boolean>        // è°ƒç”¨å®é™…API
  
  // æ¢å¤ç®¡ç†
  async startProbing()                      // å¯åŠ¨å®šæ—¶æ¢æµ‹
  async reset()                             // é‡ç½®çŠ¶æ€
  
  // äº‹ä»¶
  on('recovered', callback)                 // æ¢å¤äº‹ä»¶
}
```

#### æ‰‹åŠ¨é™æµæµ‹è¯•å…¥å£

```
UI: TaskManagePage å·¥å…·æ 
   â””â”€ æŒ‰é’®ä½ç½®ï¼šå½“å‰å·²æœ‰çš„ testThrottle() æŒ‰é’®
   
è¡Œä¸ºï¼š
1. ç”¨æˆ·ç‚¹å‡» testThrottle
2. å‰ç«¯è°ƒç”¨ datasource.testThrottle()
3. IPC: llm-translate:test-throttle
4. åç«¯ï¼šprobe.apiProbe() æˆ– probe.quickProbe()
5. è¿”å›ç»“æœï¼š{ status: 'ok' | 'throttled', responseTime }
6. UIæ˜¾ç¤ºï¼šçŠ¶æ€æç¤º + å“åº”æ—¶é—´
```

---

## ğŸ¨ **å‰ç«¯UIæ”¹åŠ¨æ¸…å•**

### **æ”¹åŠ¨1ï¼šæ ‡ç­¾ä¿®æ”¹**
```
HomePage.vue ä¸­çš„å¹¶å‘æ•°
âŒ æ”¹å‰ï¼šæ¯åˆ†é’Ÿæœ€é«˜å¹¶å‘æ•°
âœ… æ”¹åï¼šæœ€é«˜å¹¶å‘æ•°
```

### **æ”¹åŠ¨2ï¼šä»»åŠ¡åˆ—è¡¨æ’åº**
```typescript
// æ–°çš„æ’åºä¼˜å…ˆçº§
const TASK_STATUS_ORDER = [
  'sending',      // 1ï¸âƒ£ å‘é€ä¸­ï¼ˆæœ€ä¼˜å…ˆæ˜¾ç¤ºï¼‰
  'waiting',      // 2ï¸âƒ£ æ’é˜Ÿä¸­
  'throttled',    // 3ï¸âƒ£ è¢«é™æµ
  'completed',    // 4ï¸âƒ£ å·²å®Œæˆ
  'error',        // 5ï¸âƒ£ é”™è¯¯
  'unsent'        // 6ï¸âƒ£ æœªå‘é€
]
```

### **æ”¹åŠ¨3ï¼šå·¥å…·æ "æ›´å¤šé…ç½®"æŒ‰é’®**
```
ä½ç½®ï¼šTaskManagePage å·¥å…·æ ç¬¬2è¡Œæœ€å³è¾¹
å›¾æ ‡ï¼šé½¿è½®icon (SettingOutlined)
è¡Œä¸ºï¼šç‚¹å‡» â†’ ä»å³è¾¹æ‰“å¼€ SchedulerConfigDrawer

SchedulerConfigDrawer å†…å®¹ï¼š
â”œâ”€ ã€åŸºç¡€è®¾ç½®ã€‘
â”‚  â”œâ”€ æœ€é«˜å¹¶å‘æ•°ï¼ˆslider 1-10ï¼‰
â”‚  â”œâ”€ ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆinput 5-120sï¼‰
â”‚  â””â”€ æµå¼æ— æ•°æ®è¶…æ—¶ï¼ˆinput 10-60sï¼‰
â”‚
â”œâ”€ ã€é™æµå¤„ç†ã€‘
â”‚  â”œâ”€ é™æµæ¢é’ˆé—´éš”ï¼ˆinput 5-30sï¼‰
â”‚  â”œâ”€ æ¢é’ˆç±»å‹ï¼ˆradio: å¿«é€Ÿ / APIè°ƒç”¨ï¼‰
â”‚  â””â”€ è‡ªåŠ¨é‡å‘é™æµä»»åŠ¡ï¼ˆcheckboxï¼‰
â”‚
â””â”€ ã€é«˜çº§é€‰é¡¹ã€‘
   â”œâ”€ è°ƒåº¦ç­–ç•¥ï¼ˆradio: äº‹ä»¶é©±åŠ¨ / å®šæ—¶ï¼‰
   â””â”€ ä¿å­˜æŒ‰é’®
```

---

## ğŸ“Š **æ–‡ä»¶å˜æ›´è§„åˆ’**

### **æ–°å¢æ–‡ä»¶**
```
src-electron/services/llm-translate-service/
â”œâ”€ batch-scheduler.ts                    â† è°ƒåº¦å™¨æ ¸å¿ƒ
â”œâ”€ throttle-probe.ts                     â† é™æµæ¢é’ˆ
â””â”€ token-regression-estimator.ts         â† Tokenå›å½’ä¼°è®¡

Client/GUI/DemoPage/LlmTranslate/
â”œâ”€ components/SchedulerConfigDrawer.vue  â† é…ç½®æŠ½å±‰
â””â”€ types/scheduler.ts                    â† è°ƒåº¦å™¨ç±»å‹
```

### **ä¿®æ”¹æ–‡ä»¶**
```
åç«¯æ ¸å¿ƒï¼š
- src-electron/services/llm-translate-service/llm-translate-service.ts
  â”œâ”€ åˆå§‹åŒ– scheduler, probe, estimator
  â”œâ”€ submitTasks() æ”¹ä¸ºä½¿ç”¨ scheduler
  â””â”€ æš´éœ² testThrottle() æ–¹æ³•

- src-electron/services/llm-translate-service/task-state-manager.ts
  â””â”€ åœ¨ task:complete æ—¶è®°å½•æ ·æœ¬

- src-electron/ipc/main-renderer/llm-translate-handlers.ts
  â”œâ”€ æ–°å¢ test-throttle handler
  â””â”€ è½¬å‘ scheduler äº‹ä»¶

å‰ç«¯UIï¼š
- Client/GUI/DemoPage/LlmTranslate/components/TaskManagePage.vue
  â”œâ”€ ä¿®æ”¹æ’åºé€»è¾‘
  â”œâ”€ åŠ "æ›´å¤šé…ç½®"æŒ‰é’®
  â””â”€ ç§»é™¤ testThrottle ä¸­çš„mock

- Client/GUI/DemoPage/LlmTranslate/components/HomePage.vue
  â””â”€ æ ‡ç­¾æ”¹ä¸º"æœ€é«˜å¹¶å‘æ•°"

- Client/GUI/DemoPage/LlmTranslate/stores/translate.store.ts
  â”œâ”€ æ–°å¢ schedulerConfig çŠ¶æ€
  â””â”€ æ–°å¢ updateSchedulerConfig() action

- Client/GUI/DemoPage/LlmTranslate/types/config.ts
  â””â”€ æ–°å¢ SchedulerConfig ç±»å‹

ç±»å‹ç³»ç»Ÿï¼š
- src-electron/types/LlmTranslate/backend/events.ts
  â”œâ”€ ThrottleRecoveredEvent
  â””â”€ ThrottleTestResultEvent
```

---

## âš ï¸ **å…³é”®é£é™©ç‚¹ & è§£å†³æ–¹æ¡ˆ**

| é£é™© | å½±å“ | ç¼“è§£æ–¹æ¡ˆ |
|-----|------|---------|
| **å¹¶å‘è¿‡é«˜å¯¼è‡´æ›´å¤š429** | é™·å…¥åå¤é™æµ | æ·»åŠ è‡ªé€‚åº”é™é€Ÿï¼šæ£€æµ‹åˆ°429é¢‘ç‡>50% â†’ è‡ªåŠ¨é™ä½maxConcurrency |
| **æµå¼è¶…æ—¶æ£€æµ‹ä¸å‡†ç¡®** | è¯¯æ€æ­£å¸¸ä»»åŠ¡ | ä½¿ç”¨chunkæ—¶é—´æˆ³ï¼Œ10ç§’å†…æœ‰ä»»ä½•chunkæ›´æ–°éƒ½é‡ç½®è®¡æ—¶å™¨ |
| **æ ·æœ¬ä¸è¶³å›å½’å¤±è´¥** | tokené¢„ä¼°é”™è¯¯ | æ ·æœ¬<3æ—¶é™çº§åˆ°"ç­‰é¢"æˆ–"é¢„è®¡å€¼"æ¨¡å¼ |
| **è°ƒåº¦å™¨å†…å­˜æ³„æ¼** | é•¿æ—¶é—´è¿è¡ŒOOM | ä»»åŠ¡å®Œæˆåç«‹å³æ¸…ç†ï¼Œä½¿ç”¨WeakMapç¼“å­˜ |
| **äº‹ä»¶ç›‘å¬é‡å¤æ³¨å†Œ** | æ¶ˆæ¯é‡å¤å¤„ç† | è°ƒåº¦å™¨startæ—¶æ£€æŸ¥ `if(isRunning) return` |

---

## ğŸ”„ **æ¨èå®ç°é¡ºåº**

```
ä¼˜å…ˆçº§é¡ºåºï¼ˆæŒ‰ä¾èµ–å…³ç³»ï¼‰ï¼š

1ï¸âƒ£ BatchScheduler        ã€åŸºç¡€è®¾æ–½ã€‘
   â””â”€ ä¸ºè°ƒåº¦å™¨æ‰“å¥½åŸºç¡€

2ï¸âƒ£ UIæ”¹åŠ¨ï¼ˆæ’åºã€æŒ‰é’®ï¼‰   ã€å¯è§æ”¶ç›Šã€‘
   â””â”€ ç”¨æˆ·å¯ä»¥çœ‹åˆ°å˜åŒ–

3ï¸âƒ£ SchedulerConfigDrawer ã€ç”¨æˆ·äº¤äº’ã€‘
   â””â”€ è®©ç”¨æˆ·èƒ½é…ç½®å‚æ•°

4ï¸âƒ£ ThrottleProbe        ã€é™æµæ¢å¤ã€‘
   â””â”€ å¤„ç†429çš„å…³é”®æœºåˆ¶

5ï¸âƒ£ TokenRegressionEstimator ã€ä¼˜åŒ–åŠŸèƒ½ã€‘
   â””â”€ æ”¹è¿›ä½“éªŒä½†ä¸æ˜¯æ ¸å¿ƒ
```

---

## ğŸ“ **è¯¦ç»†çš„æ–‡ä»¶å¤¹æ¶æ„ä¿®æ”¹æ ‘**

### **åç«¯ç»“æ„è°ƒæ•´ï¼ˆElectronä¸»è¿›ç¨‹ï¼‰**

```
Nimbria/src-electron/services/llm-translate-service/
â”œâ”€ llm-translate-service.ts          âœï¸ ä¿®æ”¹
â”‚  â””â”€ æ–°å¢å±æ€§ï¼šscheduler, probe, estimator
â”‚  â””â”€ ä¿®æ”¹æ–¹æ³•ï¼šsubmitTasks(), constructor()
â”‚  â””â”€ æ–°å¢æ–¹æ³•ï¼šestimateTokens(), testThrottle(), setupSchedulerListeners()
â”‚
â”œâ”€ translation-executor.ts            âœ… ä¿æŒä¸å˜ï¼ˆä¸ä¿®æ”¹ï¼ï¼‰
â”‚
â”œâ”€ task-state-manager.ts              âœï¸ ä¿®æ”¹
â”‚  â””â”€ åœ¨ emit('task:complete') æ—¶è®°å½•æ ·æœ¬
â”‚  â””â”€ è°ƒç”¨ estimator.addSample()
â”‚
â”œâ”€ batch-scheduler.ts                 âœ¨ æ–°å¢
â”‚  â””â”€ å¯¼å‡ºç±»ï¼šBatchScheduler
â”‚  â”œâ”€ æ„é€ å™¨ï¼šconstructor(batchId, taskIds, config, maxConcurrency)
â”‚  â”œâ”€ æ ¸å¿ƒå±æ€§ï¼šwaitingQueue, activeSet, throttledUntil, isRunning
â”‚  â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼š
â”‚  â”‚  â”œâ”€ start(): å¯åŠ¨è°ƒåº¦å¾ªç¯
â”‚  â”‚  â”œâ”€ stop(): æš‚åœè°ƒåº¦
â”‚  â”‚  â”œâ”€ processQueue(): å¤„ç†æ’é˜Ÿä»»åŠ¡
â”‚  â”‚  â”œâ”€ handleTaskComplete(taskId): ä»»åŠ¡å®Œæˆâ†’å‘é€ä¸‹ä¸€æ‰¹
â”‚  â”‚  â”œâ”€ handleTaskError(taskId, errorType): é”™è¯¯å¤„ç†
â”‚  â”‚  â”œâ”€ handleThrottled(): é™æµæš‚åœ
â”‚  â”‚  â””â”€ getStatus(): è¿”å›è°ƒåº¦å™¨çŠ¶æ€
â”‚
â”œâ”€ throttle-probe.ts                  âœ¨ æ–°å¢
â”‚  â””â”€ å¯¼å‡ºç±»ï¼šThrottleProbe
â”‚  â”œâ”€ æ„é€ å™¨ï¼šconstructor(modelId, config)
â”‚  â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼š
â”‚  â”‚  â”œâ”€ quickProbe(): è½»é‡çº§è¿æ¥æ£€æŸ¥
â”‚  â”‚  â”œâ”€ apiProbe(): å®é™…APIçŸ­è¯·æ±‚æµ‹è¯•
â”‚  â”‚  â”œâ”€ startProbing(): å¯åŠ¨å®šæ—¶æ¢æµ‹å¾ªç¯
â”‚  â”‚  â”œâ”€ stopProbing(): åœæ­¢æ¢æµ‹
â”‚  â”‚  â””â”€ reset(): é‡ç½®çŠ¶æ€
â”‚  â””â”€ äº‹ä»¶ç³»ç»Ÿï¼šon(event, callback) - å‘å°„ 'recovered', 'testFailed' äº‹ä»¶
â”‚
â””â”€ token-regression-estimator.ts      âœ¨ æ–°å¢
   â””â”€ å¯¼å‡ºç±»ï¼šTokenRegressionEstimator
   â”œâ”€ æ„é€ å™¨ï¼šconstructor()
   â”œâ”€ å†…éƒ¨çŠ¶æ€ï¼šsamples(æ»‘åŠ¨çª—å£â‰¤100), coefficients(å›å½’ç³»æ•°)
   â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼š
   â”‚  â”œâ”€ addSample(sample): æ·»åŠ å®Œæˆä»»åŠ¡æ ·æœ¬
   â”‚  â”œâ”€ train(): æ‰§è¡Œå›å½’è®¡ç®—ï¼ˆæ ·æœ¬â‰¥3æ—¶ï¼‰
   â”‚  â”œâ”€ estimate(contentLength, modelId): é¢„ä¼°è¾“å‡ºtokenæ•°
   â”‚  â”œâ”€ hasSufficientSamples(modelId): æ£€æŸ¥æ ·æœ¬æ˜¯å¦å……åˆ†
   â”‚  â””â”€ getSampleCount(modelId): è·å–æŒ‡å®šæ¨¡å‹çš„æ ·æœ¬æ•°
   â””â”€ æŒ‰ modelId åˆ†ç»„ç»´æŠ¤æ ·æœ¬åº“
```

### **IPCå±‚æ”¹åŠ¨**

```
Nimbria/src-electron/ipc/main-renderer/llm-translate-handlers.ts âœï¸ ä¿®æ”¹
â”œâ”€ ä¿®æ”¹ç°æœ‰Handlerï¼š
â”‚  â””â”€ 'llm-translate:submit-tasks': æ”¹ä¸ºä½¿ç”¨ scheduler è€Œéç›´æ¥è°ƒç”¨ executor
â”‚
â”œâ”€ æ–°å¢Handlerï¼š
â”‚  â”œâ”€ 'llm-translate:test-throttle': æ‰‹åŠ¨é™æµæµ‹è¯•
â”‚  â”‚  â””â”€ è¿”å› { status: 'ok'|'throttled', responseTime: ms }
â”‚  â”‚
â”‚  â”œâ”€ 'llm-translate:update-scheduler-config': æ›´æ–°è°ƒåº¦å™¨é…ç½®
â”‚  â”‚  â””â”€ æ¥æ”¶ SchedulerConfigï¼Œå­˜å‚¨åˆ°å½“å‰batch
â”‚  â”‚
â”‚  â””â”€ 'llm-translate:get-scheduler-config': è·å–å½“å‰é…ç½®
â”‚     â””â”€ è¿”å›å½“å‰batchçš„scheduleré…ç½®
â”‚
â””â”€ æ–°å¢äº‹ä»¶å¹¿æ’­å‡½æ•°ï¼šsetupSchedulerEventBroadcast()
   â”œâ”€ ç›‘å¬ scheduler çš„çŠ¶æ€å˜åŒ–äº‹ä»¶
   â”œâ”€ å‘æ‰€æœ‰æ¸²æŸ“è¿›ç¨‹å‘é€ 'llm-translate:scheduler-status-changed'
   â””â”€ ç›‘å¬ probe çš„æ¢å¤äº‹ä»¶
      â””â”€ å‘æ¸²æŸ“è¿›ç¨‹å‘é€ 'llm-translate:throttle-recovered'
```

### **ç±»å‹ç³»ç»Ÿæ‰©å±•ï¼ˆä¿æŒç°æœ‰è§„èŒƒï¼‰**

```
Nimbria/src-electron/types/LlmTranslate/
â”œâ”€ backend/
â”‚  â”œâ”€ events.ts                       âœï¸ ä¿®æ”¹
â”‚  â”‚  â”œâ”€ æ–°å¢ç±»å‹ï¼šThrottleRecoveredEvent
â”‚  â”‚  â”œâ”€ æ–°å¢ç±»å‹ï¼šThrottleTestResultEvent
â”‚  â”‚  â””â”€ æ–°å¢ç±»å‹ï¼šSchedulerStatusChangedEvent
â”‚  â”‚
â”‚  â””â”€ scheduler.ts                    âœ¨ æ–°å¢ï¼ˆåç«¯ç‹¬æœ‰ç±»å‹ï¼‰
â”‚     â”œâ”€ å¯¼å‡ºï¼šSchedulerOptions (é…ç½®é€‰é¡¹)
â”‚     â”œâ”€ å¯¼å‡ºï¼šTokenRegressionSample (æ ·æœ¬ç»“æ„)
â”‚     â””â”€ å¯¼å‡ºï¼šå†…éƒ¨ä½¿ç”¨çš„schedulerçŠ¶æ€ç±»å‹
â”‚
â”œâ”€ client/
â”‚  â””â”€ index.ts                        âœï¸ ä¿®æ”¹
â”‚     â”œâ”€ æ–°å¢å¯¼å‡ºï¼šexport type { SchedulerConfig } from '@demo/LlmTranslate/types/scheduler'
â”‚     â”œâ”€ æ–°å¢å¯¼å‡ºï¼šexport type { ThrottleProbeMode } from '@demo/LlmTranslate/types/scheduler'
â”‚     â””â”€ æ–°å¢å¯¼å‡ºï¼šexport type { SchedulingStrategy } from '@demo/LlmTranslate/types/scheduler'
â”‚     â””â”€ æ³¨é‡Šè¯´æ˜è¿™äº›æ¥è‡ªå‰ç«¯å®šä¹‰
â”‚
â””â”€ index.ts                           âœï¸ ä¿®æ”¹
   â””â”€ æ›´æ–°å¯¼å‡ºåˆ—è¡¨åŒ…å«æ–°çš„schedulerç›¸å…³ç±»å‹
```

### **å‰ç«¯ç»“æ„è°ƒæ•´ï¼ˆVueç»„ä»¶å±‚ï¼‰**

```
Nimbria/Client/GUI/DemoPage/LlmTranslate/
â”œâ”€ types/
â”‚  â”œâ”€ config.ts                       âœï¸ ä¿®æ”¹
â”‚  â”‚  â””â”€ æ‰©å±• TranslateConfig interface
â”‚  â”‚     â””â”€ æ–°å¢å¯é€‰å­—æ®µï¼šschedulerConfig?: SchedulerConfig
â”‚  â”‚
â”‚  â”œâ”€ scheduler.ts                    âœ¨ æ–°å¢
â”‚  â”‚  â”œâ”€ å¯¼å‡ºï¼šSchedulerConfig interface
â”‚  â”‚  â”‚  â”œâ”€ maxConcurrency: number (1-10)
â”‚  â”‚  â”‚  â”œâ”€ taskTimeoutSeconds: number (5-120)
â”‚  â”‚  â”‚  â”œâ”€ streamNoDataTimeoutSeconds: number (10-60)
â”‚  â”‚  â”‚  â”œâ”€ throttleProbeIntervalSeconds: number (5-30)
â”‚  â”‚  â”‚  â”œâ”€ throttleProbeType: 'quick' | 'api'
â”‚  â”‚  â”‚  â”œâ”€ autoRetryThrottled: boolean
â”‚  â”‚  â”‚  â””â”€ schedulingStrategy: 'timed' | 'event'
â”‚  â”‚  â”œâ”€ å¯¼å‡ºï¼šSchedulerStatus enum
â”‚  â”‚  â”‚  â”œâ”€ IDLE | RUNNING | PAUSED | THROTTLED
â”‚  â”‚  â”œâ”€ å¯¼å‡ºï¼šThrottleProbeMode type
â”‚  â”‚  â””â”€ å¯¼å‡ºï¼šSchedulingStrategy type
â”‚  â”‚
â”‚  â””â”€ index.ts                        âœï¸ ä¿®æ”¹
â”‚     â””â”€ å¯¼å‡ºæ–°çš„ scheduler.ts ä¸­çš„æ‰€æœ‰ç±»å‹
â”‚
â”œâ”€ components/
â”‚  â”œâ”€ TaskManagePage.vue              âœï¸ ä¿®æ”¹
â”‚  â”‚  â”œâ”€ æ–°å¢å¸¸é‡ï¼šTASK_STATUS_ORDER å®šä¹‰æ’åºä¼˜å…ˆçº§
â”‚  â”‚  â”‚  â””â”€ ['sending', 'waiting', 'throttled', 'completed', 'error', 'unsent']
â”‚  â”‚  â”œâ”€ ä¿®æ”¹computedï¼šsortedTasks ä½¿ç”¨æ–°æ’åºä¼˜å…ˆçº§
â”‚  â”‚  â”œâ”€ å·¥å…·æ ç¬¬2è¡Œæœ€å³è¾¹æ–°å¢æŒ‰é’®ï¼š
â”‚  â”‚  â”‚  â”œâ”€ icon: SettingOutlined (é½¿è½®å›¾æ ‡)
â”‚  â”‚  â”‚  â”œâ”€ title: "æ›´å¤šé…ç½®"
â”‚  â”‚  â”‚  â””â”€ click: showSchedulerConfig()
â”‚  â”‚  â”œâ”€ testThrottle æŒ‰é’®æ”¹ä¸ºçœŸå®è°ƒç”¨ (ç§»é™¤mock)
â”‚  â”‚  â”œâ”€ æ–°å¢refï¼šconfigDrawerVisible, currentSchedulerConfig
â”‚  â”‚  â”œâ”€ æ–°å¢methodsï¼š
â”‚  â”‚  â”‚  â”œâ”€ showSchedulerConfig(): æ‰“å¼€é…ç½®æŠ½å±‰
â”‚  â”‚  â”‚  â”œâ”€ handleConfigSave(config): ä¿å­˜å¹¶åº”ç”¨é…ç½®
â”‚  â”‚  â”‚  â””â”€ handleConfigClose(): å…³é—­æŠ½å±‰
â”‚  â”‚  â””â”€ ä¿®æ”¹testThrottleï¼šæ˜¾ç¤ºæ¢é’ˆç»“æœæç¤º
â”‚  â”‚
â”‚  â”œâ”€ SchedulerConfigDrawer.vue       âœ¨ æ–°å¢
â”‚  â”‚  â”œâ”€ Props: visible (boolean), initialConfig (SchedulerConfig)
â”‚  â”‚  â”œâ”€ å±€éƒ¨çŠ¶æ€ï¼šform (è¡¨å•æ•°æ®), activeTab (å½“å‰tab), loading
â”‚  â”‚  â”œâ”€ ä¸‰ä¸ªTabæ ‡ç­¾ï¼š
â”‚  â”‚  â”‚  â”œâ”€ ã€åŸºç¡€è®¾ç½®ã€‘Tab
â”‚  â”‚  â”‚  â”‚  â”œâ”€ æœ€é«˜å¹¶å‘æ•° (Slider 1-10)
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ä»»åŠ¡è¶…æ—¶æ—¶é—´ (Input 5-120 ç§’)
â”‚  â”‚  â”‚  â”‚  â””â”€ æµå¼æ— æ•°æ®è¶…æ—¶ (Input 10-60 ç§’)
â”‚  â”‚  â”‚  â”œâ”€ ã€é™æµå¤„ç†ã€‘Tab
â”‚  â”‚  â”‚  â”‚  â”œâ”€ é™æµæ¢é’ˆé—´éš” (Input 5-30 ç§’)
â”‚  â”‚  â”‚  â”‚  â”œâ”€ æ¢é’ˆç±»å‹ (Radio: å¿«é€Ÿæ£€æŸ¥ / APIè°ƒç”¨)
â”‚  â”‚  â”‚  â”‚  â””â”€ è‡ªåŠ¨é‡å‘é™æµä»»åŠ¡ (Checkbox)
â”‚  â”‚  â”‚  â””â”€ ã€é«˜çº§é€‰é¡¹ã€‘Tab
â”‚  â”‚  â”‚     â””â”€ è°ƒåº¦ç­–ç•¥ (Radio: äº‹ä»¶é©±åŠ¨ / å®šæ—¶è½®è¯¢)
â”‚  â”‚  â”œâ”€ åº•éƒ¨æŒ‰é’®ï¼šä¿å­˜ (ç¡®è®¤) / å–æ¶ˆ (å…³é—­)
â”‚  â”‚  â”œâ”€ è¡¨å•éªŒè¯ï¼švalidateForm()
â”‚  â”‚  â””â”€ Emits: @update (ä¿å­˜), @close (å…³é—­)
â”‚  â”‚
â”‚  â”œâ”€ HomePage.vue                    âœï¸ ä¿®æ”¹
â”‚  â”‚  â”œâ”€ å¹¶å‘æ•°æ ‡ç­¾ï¼š
â”‚  â”‚  â”‚  â””â”€ "æ¯åˆ†é’Ÿæœ€é«˜å¹¶å‘æ•°" â†’ "æœ€é«˜å¹¶å‘æ•°"
â”‚  â”‚  â””â”€ ä¿ç•™sliderå’Œinputç»‘å®šé€»è¾‘
â”‚  â”‚
â”‚  â””â”€ ModelSelector.vue               âœï¸ ä¿®æ”¹ï¼ˆå¯é€‰ï¼‰
â”‚     â”œâ”€ é¢„ç•™tokenä¼°è®¡æ¨¡å¼é€‰æ‹©çš„ä½ç½®
â”‚     â””â”€ ä¿æŒç°æœ‰åŠŸèƒ½
â”‚
â”œâ”€ stores/
â”‚  â”œâ”€ translate.store.ts              âœï¸ ä¿®æ”¹
â”‚  â”‚  â”œâ”€ æ–°å¢çŠ¶æ€ï¼š
â”‚  â”‚  â”‚  â”œâ”€ schedulerConfig: SchedulerConfig
â”‚  â”‚  â”‚  â””â”€ schedulerStatus: SchedulerStatus
â”‚  â”‚  â”œâ”€ æ–°å¢Actionï¼š
â”‚  â”‚  â”‚  â”œâ”€ updateSchedulerConfig(config): æ›´æ–°é…ç½®
â”‚  â”‚  â”‚  â”œâ”€ updateSchedulerStatus(status): æ›´æ–°çŠ¶æ€
â”‚  â”‚  â”‚  â””â”€ setupSchedulerEventListeners(): ç›‘å¬scheduleräº‹ä»¶
â”‚  â”‚  â”œâ”€ ä¿®æ”¹ç°æœ‰Actionï¼š
â”‚  â”‚  â”‚  â”œâ”€ initialize(): è°ƒç”¨ setupSchedulerEventListeners()
â”‚  â”‚  â”‚  â””â”€ setupEventListeners(): æ–°å¢scheduleräº‹ä»¶ç›‘å¬
â”‚  â”‚  â”‚     â”œâ”€ ç›‘å¬ 'llm-translate:scheduler-status-changed'
â”‚  â”‚  â”‚     â”œâ”€ ç›‘å¬ 'llm-translate:throttle-recovered'
â”‚  â”‚  â”‚     â””â”€ ç›¸åº”æ›´æ–° schedulerConfig, schedulerStatus
â”‚  â”‚  â””â”€ æ–°å¢Computedï¼š
â”‚  â”‚     â””â”€ currentSchedulerConfig: å½“å‰æ‰¹æ¬¡çš„è°ƒåº¦å™¨é…ç½®
â”‚  â”‚
â”‚  â””â”€ translate.datasource.ts         âœï¸ ä¿®æ”¹
â”‚     â”œâ”€ æ–°å¢æ–¹æ³•ï¼š
â”‚     â”‚  â”œâ”€ updateSchedulerConfig(config): é€šè¿‡IPCæ›´æ–°é…ç½®
â”‚     â”‚  â”œâ”€ getSchedulerConfig(): é€šè¿‡IPCè·å–é…ç½®
â”‚     â”‚  â”œâ”€ testThrottle(): é€šè¿‡IPCæµ‹è¯•é™æµ
â”‚     â”‚  â””â”€ getSchedulerStatus(): é€šè¿‡IPCè·å–è°ƒåº¦å™¨çŠ¶æ€
â”‚     â””â”€ æ‰€æœ‰æ–¹æ³•éƒ½åŸºäº electronAPI çš„IPCè°ƒç”¨
â”‚
â””â”€ preload/
   â””â”€ project-preload.ts              âœï¸ ä¿®æ”¹ï¼ˆå¯èƒ½ï¼‰
      â”œâ”€ æš´éœ²æ–°çš„IPCæ¥å£ï¼š
      â”‚  â”œâ”€ updateSchedulerConfig(config)
      â”‚  â”œâ”€ getSchedulerConfig()
      â”‚  â”œâ”€ testThrottle()
      â”‚  â””â”€ getSchedulerStatus()
      â””â”€ è¿™äº›å¯èƒ½å·²ç»é€šè¿‡é€šç”¨çš„ handle/invoke æœºåˆ¶æš´éœ²
```

---

## ğŸ“‹ **å®Œæ•´çš„å®ç°Todoæ¸…å•ï¼ˆæŒ‰é˜¶æ®µç»„ç»‡ï¼‰**

### **Phase 1ï¸âƒ£ : BatchScheduler åŸºç¡€è®¾æ–½**

**åç«¯å®ç°**
- [ ] æ–°å¢ `batch-scheduler.ts` æ–‡ä»¶
  - [ ] å¯¼å‡º `BatchScheduler` ç±»éª¨æ¶
  - [ ] å®ç°æ„é€ å™¨ï¼šåˆå§‹åŒ– waitingQueue, activeSet, maxConcurrency
  - [ ] å®ç° `start()` æ–¹æ³•ï¼šå¯åŠ¨è°ƒåº¦å¾ªç¯
  - [ ] å®ç° `processQueue()` æ–¹æ³•ï¼šæ ¸å¿ƒè°ƒåº¦é€»è¾‘
    - [ ] æ£€æŸ¥ activeCount < maxConcurrency
    - [ ] ä» waitingQueue å–ä»»åŠ¡
    - [ ] è°ƒç”¨ executor.executeTasks(taskId)
  - [ ] å®ç° `handleTaskComplete(taskId)` æ–¹æ³•
    - [ ] activeSet.delete(taskId)
    - [ ] è§¦å‘ processQueue() å‘é€ä¸‹ä¸€æ‰¹
  - [ ] å®ç° `handleTaskError()` æ–¹æ³•
    - [ ] æ ¹æ®é”™è¯¯ç±»å‹å¤„ç†
    - [ ] å¦‚æœæ˜¯RATE_LIMITï¼Œè§¦å‘ handleThrottled()
  - [ ] å®ç° `handleThrottled()` æ–¹æ³•
    - [ ] åœæ­¢ processQueue()
    - [ ] è®¾ç½® throttledUntil æ—¶é—´æˆ³
  - [ ] å®ç° `getStatus()` è¿”å›è°ƒåº¦å™¨çŠ¶æ€
  - [ ] æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼ˆemojiæ ‡è®°ï¼‰
  - [ ] ç¼–å†™åŸºæœ¬çš„å•å…ƒæµ‹è¯•

- [ ] ä¿®æ”¹ `llm-translate-service.ts`
  - [ ] æ–°å¢å±æ€§ï¼š`scheduler: BatchScheduler | null`
  - [ ] åœ¨ constructor ä¸­åˆå§‹åŒ–è°ƒåº¦å™¨å¼•ç”¨
  - [ ] ä¿®æ”¹ `submitTasks()` æ–¹æ³•
    - [ ] åˆ›å»º BatchScheduler å®ä¾‹
    - [ ] å°†ä»»åŠ¡æ ‡è®°ä¸º 'waiting'ï¼ˆå†™å…¥DBï¼‰
    - [ ] è°ƒç”¨ `scheduler.start()`
    - [ ] è¿”å› submissionId
  - [ ] æ–°å¢ `setupSchedulerListeners()` æ–¹æ³•
    - [ ] ç›‘å¬ executor çš„ task:complete äº‹ä»¶
    - [ ] ç›‘å¬ executor çš„ task:error äº‹ä»¶
    - [ ] è°ƒç”¨ç›¸åº”çš„ scheduler æ–¹æ³•
  - [ ] æ”¹è¿›æ—¥å¿—è¾“å‡ºï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰

- [ ] ä¿®æ”¹ `llm-translate-handlers.ts` IPCå±‚
  - [ ] ä¿®æ”¹ `'llm-translate:submit-tasks'` handler
    - [ ] è°ƒç”¨ service.submitTasks() æ—¶å®é™…ä½¿ç”¨scheduler
    - [ ] è¿”å› submissionId

**æµ‹è¯•éªŒè¯**
- [ ] å‰ç«¯å‘é€10ä¸ªä»»åŠ¡ï¼Œå¹¶å‘æ•°ä¸º3
  - [ ] è§‚å¯Ÿå‰3ä¸ªä»»åŠ¡è¿›å…¥ 'sending' çŠ¶æ€
  - [ ] ç¬¬1ä¸ªå®Œæˆåï¼Œç¬¬4ä¸ªè‡ªåŠ¨è¿›å…¥ 'sending'
  - [ ] éªŒè¯é˜Ÿåˆ—æœºåˆ¶æ­£ç¡®

---

### **Phase 2ï¸âƒ£ : UIæ”¹åŠ¨ï¼ˆæ’åºã€æŒ‰é’®ã€æ ‡ç­¾ï¼‰**

**å‰ç«¯UIè°ƒæ•´**
- [ ] ä¿®æ”¹ `TaskManagePage.vue`
  - [ ] åœ¨æ–‡ä»¶é¡¶éƒ¨æ–°å¢å¸¸é‡
    ```typescript
    const TASK_STATUS_ORDER = ['sending', 'waiting', 'throttled', 'completed', 'error', 'unsent']
    ```
  - [ ] ä¿®æ”¹ `filteredTaskList` computed
    - [ ] è°ƒæ•´æ’åºé€»è¾‘ä½¿ç”¨ TASK_STATUS_ORDER
  - [ ] åœ¨å·¥å…·æ ç¬¬2è¡Œæœ€å³è¾¹æ·»åŠ "æ›´å¤šé…ç½®"æŒ‰é’®
    - [ ] Icon: SettingOutlined
    - [ ] Title: "æ›´å¤šé…ç½®"
    - [ ] @click: showSchedulerConfig()
  - [ ] ä¿®æ”¹ `testThrottle` æŒ‰é’®è¡Œä¸º
    - [ ] ä»mockæ”¹ä¸ºçœŸå®è°ƒç”¨ datasource.testThrottle()
    - [ ] æ˜¾ç¤ºè¿”å›ç»“æœæç¤ºï¼ˆæˆåŠŸ/å¤±è´¥ + å“åº”æ—¶é—´ï¼‰

- [ ] ä¿®æ”¹ `HomePage.vue`
  - [ ] æ‰¾åˆ°å¹¶å‘æ•°çš„æ ‡ç­¾æ–‡æœ¬
    - [ ] æ”¹ä¸º "æœ€é«˜å¹¶å‘æ•°"ï¼ˆåˆ é™¤"æ¯åˆ†é’Ÿ"ï¼‰
  - [ ] éªŒè¯sliderå’Œinputçš„ç»‘å®š

**éªŒè¯**
- [ ] ä»»åŠ¡åˆ—è¡¨æŒ‰æ–°ä¼˜å…ˆçº§æ’åº
- [ ] "æ›´å¤šé…ç½®"æŒ‰é’®å‡ºç°åœ¨å·¥å…·æ 
- [ ] testThrottle æ˜¾ç¤ºçœŸå®ç»“æœ

---

### **Phase 3ï¸âƒ£ : SchedulerConfigDrawer é…ç½®æŠ½å±‰**

**æ–°å¢ç»„ä»¶**
- [ ] æ–°å¢ `SchedulerConfigDrawer.vue` ç»„ä»¶
  - [ ] Props å®šä¹‰
    - [ ] visible: boolean
    - [ ] initialConfig: SchedulerConfig
  - [ ] å±€éƒ¨çŠ¶æ€
    - [ ] form: SchedulerConfig å¯¹è±¡
    - [ ] activeTab: string (å½“å‰tab)
    - [ ] loading: boolean
  - [ ] æ¨¡æ¿ç»“æ„ï¼ˆä¸‰ä¸ªTabï¼‰
    - [ ] El-Tabs å®¹å™¨
    - [ ] Tab1: ã€åŸºç¡€è®¾ç½®ã€‘
      - [ ] æœ€é«˜å¹¶å‘æ•°ï¼šSlider (èŒƒå›´1-10)
      - [ ] ä»»åŠ¡è¶…æ—¶ï¼šInput (èŒƒå›´5-120ç§’)
      - [ ] æµå¼è¶…æ—¶ï¼šInput (èŒƒå›´10-60ç§’)
    - [ ] Tab2: ã€é™æµå¤„ç†ã€‘
      - [ ] æ¢é’ˆé—´éš”ï¼šInput (èŒƒå›´5-30ç§’)
      - [ ] æ¢é’ˆç±»å‹ï¼šRadio (å¿«é€Ÿ/API)
      - [ ] è‡ªåŠ¨é‡å‘ï¼šCheckbox
    - [ ] Tab3: ã€é«˜çº§é€‰é¡¹ã€‘
      - [ ] è°ƒåº¦ç­–ç•¥ï¼šRadio (äº‹ä»¶é©±åŠ¨/å®šæ—¶)
  - [ ] åº•éƒ¨æŒ‰é’®
    - [ ] ä¿å­˜æŒ‰é’®ï¼šè°ƒç”¨ handleSave()
    - [ ] å–æ¶ˆæŒ‰é’®ï¼šè°ƒç”¨ handleCancel()
  - [ ] Methods
    - [ ] handleSave(): éªŒè¯è¡¨å•â†’emit 'update' äº‹ä»¶
    - [ ] validateForm(): æ£€æŸ¥å‚æ•°èŒƒå›´
    - [ ] handleCancel(): emit 'close' äº‹ä»¶
    - [ ] handleReset(): æ¢å¤åˆ°åˆå§‹å€¼
  - [ ] Emits
    - [ ] @update (æ–°é…ç½®)
    - [ ] @close

**ä¿®æ”¹TaskManagePage**
- [ ] å¯¼å…¥ SchedulerConfigDrawer ç»„ä»¶
- [ ] æ–°å¢ ref
  - [ ] configDrawerVisible: boolean (é»˜è®¤false)
  - [ ] currentSchedulerConfig: SchedulerConfig
- [ ] åœ¨æ¨¡æ¿ä¸­æ·»åŠ  SchedulerConfigDrawer ç»„ä»¶
  - [ ] :visible="configDrawerVisible"
  - [ ] :initialConfig="currentSchedulerConfig"
  - [ ] @update="handleConfigSave"
  - [ ] @close="handleConfigClose"
- [ ] æ–°å¢ methods
  - [ ] showSchedulerConfig()
    - [ ] åŠ è½½å½“å‰é…ç½®
    - [ ] configDrawerVisible = true
  - [ ] handleConfigSave(config)
    - [ ] è°ƒç”¨ datasource.updateSchedulerConfig(config)
    - [ ] æ›´æ–° store.schedulerConfig
    - [ ] æ˜¾ç¤ºæˆåŠŸæç¤º
  - [ ] handleConfigClose()
    - [ ] configDrawerVisible = false

**ä¿®æ”¹Store**
- [ ] æ–°å¢çŠ¶æ€ï¼ˆtranslate.store.tsï¼‰
  - [ ] schedulerConfig: SchedulerConfig (ä¿å­˜å½“å‰é…ç½®)
  - [ ] schedulerStatus: SchedulerStatus
- [ ] æ–°å¢ Action
  - [ ] updateSchedulerConfig(config)
    - [ ] æ›´æ–° state.schedulerConfig
  - [ ] updateSchedulerStatus(status)
    - [ ] æ›´æ–° state.schedulerStatus
  - [ ] loadSchedulerConfig()
    - [ ] è°ƒç”¨ datasource.getSchedulerConfig()
    - [ ] ä¿å­˜åˆ°çŠ¶æ€
- [ ] ä¿®æ”¹ç°æœ‰ Action
  - [ ] initialize()
    - [ ] è°ƒç”¨ loadSchedulerConfig()
    - [ ] è°ƒç”¨ setupSchedulerEventListeners()

**ä¿®æ”¹Datasource**
- [ ] æ–°å¢ methodsï¼ˆtranslate.datasource.tsï¼‰
  - [ ] async updateSchedulerConfig(config)
    - [ ] è°ƒç”¨ IPC: 'llm-translate:update-scheduler-config'
  - [ ] async getSchedulerConfig()
    - [ ] è°ƒç”¨ IPC: 'llm-translate:get-scheduler-config'
    - [ ] è¿”å›é…ç½®å¯¹è±¡
  - [ ] async getSchedulerStatus()
    - [ ] è°ƒç”¨ IPC: 'llm-translate:get-scheduler-status'

**ä¿®æ”¹IPC Handler**
- [ ] ä¿®æ”¹ `llm-translate-handlers.ts`
  - [ ] æ–°å¢ handler: 'llm-translate:update-scheduler-config'
    - [ ] æ¥æ”¶ config: SchedulerConfig
    - [ ] å½“å‰batchçš„scheduleræ›´æ–°é…ç½®
  - [ ] æ–°å¢ handler: 'llm-translate:get-scheduler-config'
    - [ ] è¿”å›å½“å‰batchçš„é…ç½®

**éªŒè¯**
- [ ] ç‚¹å‡»"æ›´å¤šé…ç½®"æŒ‰é’®æ‰“å¼€æŠ½å±‰
- [ ] ä¿®æ”¹å‚æ•°å€¼
- [ ] ç‚¹å‡»ä¿å­˜ï¼Œé…ç½®è¢«åº”ç”¨
- [ ] å…³é—­é‡æ–°æ‰“å¼€ï¼Œæ˜¾ç¤ºå·²ä¿å­˜çš„é…ç½®

---

### **Phase 4ï¸âƒ£ : ThrottleProbe é™æµæ¢é’ˆ**

**åç«¯å®ç°**
- [ ] æ–°å¢ `throttle-probe.ts` æ–‡ä»¶
  - [ ] å¯¼å‡º `ThrottleProbe` ç±»
  - [ ] æ„é€ å™¨ï¼šconstructor(modelId: string, config: ThrottleProbeConfig)
    - [ ] åˆå§‹åŒ– modelId, config, lastProbeTime, isProbing
  - [ ] å®ç° `quickProbe()` æ–¹æ³•
    - [ ] å‘é€æœ€å°åŒ–è¯·æ±‚ï¼ˆå¯èƒ½æ˜¯HEADè¯·æ±‚ï¼‰
    - [ ] è¿”å› boolean (æˆåŠŸ/å¤±è´¥)
  - [ ] å®ç° `apiProbe()` æ–¹æ³•
    - [ ] è°ƒç”¨å®é™…APIå‘é€çŸ­å†…å®¹ç¿»è¯‘
    - [ ] è¿”å› boolean (æˆåŠŸ/å¤±è´¥)
  - [ ] å®ç° `startProbing()` æ–¹æ³•
    - [ ] isProbing = true
    - [ ] å¯åŠ¨ setInterval å¾ªç¯
    - [ ] æ ¹æ®é…ç½®çš„probeTypeè°ƒç”¨å¿«é€Ÿæˆ–APIæ¢é’ˆ
    - [ ] å¦‚æœæ”¶åˆ°200ï¼Œemit 'recovered' äº‹ä»¶
  - [ ] å®ç° `stopProbing()` æ–¹æ³•
    - [ ] æ¸…é™¤å®šæ—¶å™¨ï¼ŒisProbing = false
  - [ ] å®ç° `reset()` æ–¹æ³•
    - [ ] é‡ç½®æ‰€æœ‰çŠ¶æ€
  - [ ] äº‹ä»¶ç³»ç»Ÿ
    - [ ] on(event, callback): ç›‘å¬äº‹ä»¶
    - [ ] emit(event, data): å‘å°„äº‹ä»¶
    - [ ] æ”¯æŒäº‹ä»¶ï¼š'recovered', 'testFailed'
  - [ ] æ·»åŠ è¯¦ç»†æ—¥å¿—

- [ ] ä¿®æ”¹ `llm-translate-service.ts`
  - [ ] æ–°å¢å±æ€§ï¼š`probe: ThrottleProbe`
  - [ ] åœ¨ constructor ä¸­åˆå§‹åŒ– probe
  - [ ] ä¿®æ”¹ setupSchedulerListeners()
    - [ ] ç›‘å¬ scheduler çš„é™æµäº‹ä»¶
    - [ ] è°ƒç”¨ `probe.startProbing()`
    - [ ] ç›‘å¬ probe çš„ 'recovered' äº‹ä»¶
    - [ ] é€šçŸ¥ scheduler æ¢å¤è°ƒåº¦
  - [ ] æ–°å¢ `testThrottle()` æ–¹æ³•
    - [ ] ç«‹å³æ‰§è¡Œä¸€æ¬¡æ¢é’ˆæµ‹è¯•
    - [ ] è¿”å› { status: string, responseTime: number }
  - [ ] æ–°å¢ `setupProbeEventBroadcast()` æ–¹æ³•
    - [ ] ç›‘å¬ probe çš„æ‰€æœ‰äº‹ä»¶
    - [ ] å¹¿æ’­ç»™å‰ç«¯

- [ ] ä¿®æ”¹ `llm-translate-handlers.ts` IPCå±‚
  - [ ] æ–°å¢ handler: 'llm-translate:test-throttle'
    - [ ] è°ƒç”¨ service.testThrottle()
    - [ ] è¿”å›æµ‹è¯•ç»“æœ
  - [ ] æ–°å¢äº‹ä»¶å¹¿æ’­å‡½æ•° `setupProbeEventBroadcast()`
    - [ ] ç›‘å¬ service çš„ probe äº‹ä»¶
    - [ ] å‘æ‰€æœ‰çª—å£å¹¿æ’­ 'llm-translate:throttle-test-result'

**å‰ç«¯äº¤äº’**
- [ ] ä¿®æ”¹ `TaskManagePage.vue`
  - [ ] testThrottle æŒ‰é’®æ”¹ä¸ºçœŸå®è°ƒç”¨
    ```typescript
    async testThrottle() {
      try {
        const result = await datasource.testThrottle()
        if (result.status === 'ok') {
          ElMessage.success(`é™æµæµ‹è¯•é€šè¿‡ (${result.responseTime}ms)`)
        } else {
          ElMessage.error('å½“å‰å¤„äºé™æµçŠ¶æ€ï¼Œè¯·ç¨å')
        }
      } catch (error) {
        ElMessage.error('é™æµæµ‹è¯•å¤±è´¥: ' + error.message)
      }
    }
    ```

- [ ] ä¿®æ”¹ Storeï¼ˆtranslate.store.tsï¼‰
  - [ ] åœ¨ setupEventListeners ä¸­ç›‘å¬
    - [ ] 'llm-translate:throttle-test-result'
    - [ ] æ›´æ–° UI çŠ¶æ€

**éªŒè¯**
- [ ] æ‰‹åŠ¨ç‚¹å‡»"æµ‹è¯•é™æµ"æŒ‰é’®
- [ ] æ˜¾ç¤ºæµ‹è¯•ç»“æœå’Œå“åº”æ—¶é—´
- [ ] æ¨¡æ‹Ÿé™æµï¼šè§¦å‘429é”™è¯¯
- [ ] è§‚å¯Ÿè°ƒåº¦å™¨åœæ­¢ï¼Œæ¢é’ˆå¼€å§‹å®šæ—¶æµ‹è¯•
- [ ] æ¢é’ˆæ¢å¤åï¼Œè°ƒåº¦å™¨è‡ªåŠ¨ç»§ç»­

---

### **Phase 5ï¸âƒ£ : TokenRegressionEstimator å›å½’ä¼°è®¡**

**åç«¯å®ç°**
- [ ] æ–°å¢ `token-regression-estimator.ts` æ–‡ä»¶
  - [ ] å¯¼å‡º `TokenRegressionEstimator` ç±»
  - [ ] æ„é€ å™¨ï¼šconstructor()
    - [ ] åˆå§‹åŒ– samples (Map<modelId, Array>), coefficients (Map)
  - [ ] å®ç° `addSample(sample)` æ–¹æ³•
    - [ ] è§£æ sample: { modelId, inputLength, outputTokens, ... }
    - [ ] æŒ‰ modelId åˆ†ç»„ç»´æŠ¤
    - [ ] ä¿æŒæ»‘åŠ¨çª—å£ (â‰¤100ä¸ªæ ·æœ¬)
  - [ ] å®ç° `train()` æ–¹æ³•
    - [ ] é’ˆå¯¹æ¯ä¸ª modelId çš„æ ·æœ¬é›†åˆ
    - [ ] æ‰§è¡Œçº¿æ€§å›å½’è®¡ç®—
    - [ ] ç”Ÿæˆç³»æ•°å­˜å‚¨åˆ° coefficients
  - [ ] å®ç° `estimate(contentLength, modelId)` æ–¹æ³•
    - [ ] æ£€æŸ¥æ˜¯å¦æœ‰å……è¶³æ ·æœ¬ï¼ˆâ‰¥3ï¼‰
    - [ ] å¦‚æœæœ‰ç³»æ•°ï¼Œä½¿ç”¨å›å½’å…¬å¼è®¡ç®—
    - [ ] è¿”å›é¢„ä¼°çš„è¾“å‡ºtokenæ•°
  - [ ] å®ç° `hasSufficientSamples(modelId)` æ–¹æ³•
    - [ ] æ£€æŸ¥æ ·æœ¬æ•° â‰¥ MIN_SAMPLES (3)
  - [ ] å®ç° `getSampleCount(modelId)` æ–¹æ³•
    - [ ] è¿”å›æŒ‡å®šæ¨¡å‹çš„æ ·æœ¬æ•°
  - [ ] æ·»åŠ æ—¥å¿—ï¼ˆæ ·æœ¬æ”¶é›†ã€è®­ç»ƒã€é¢„ä¼°ï¼‰

- [ ] ä¿®æ”¹ `llm-translate-service.ts`
  - [ ] æ–°å¢å±æ€§ï¼š`estimator: TokenRegressionEstimator`
  - [ ] åœ¨ constructor ä¸­åˆå§‹åŒ– estimator
  - [ ] æ–°å¢ `estimateTokens(taskId)` æ–¹æ³•
    - [ ] ä»æ•°æ®åº“è¯»å–ä»»åŠ¡
    - [ ] æå– modelId, inputLength
    - [ ] è°ƒç”¨ estimator.estimate()
    - [ ] è¿”å›é¢„ä¼°å€¼

- [ ] ä¿®æ”¹ `task-state-manager.ts`
  - [ ] åœ¨ `emit('task:complete', data)` æ—¶
    - [ ] æ”¶é›†æ ·æœ¬ä¿¡æ¯
    - [ ] è°ƒç”¨ estimator.addSample()
    - [ ] å‘¨æœŸæ€§è°ƒç”¨ estimator.train()ï¼ˆå¦‚æ¯10ä¸ªæ ·æœ¬åï¼‰

- [ ] ä¿®æ”¹ `llm-translate-handlers.ts` IPCå±‚
  - [ ] æ–°å¢ handler: 'llm-translate:estimate-tokens'
    - [ ] æ¥æ”¶ taskId
    - [ ] è°ƒç”¨ service.estimateTokens(taskId)
    - [ ] è¿”å›é¢„ä¼°å€¼

**å‰ç«¯äº¤äº’**
- [ ] ä¿®æ”¹ `HomePage.vue` ModelSelector ç»„ä»¶ï¼ˆå¯é€‰ï¼‰
  - [ ] åœ¨tokenæ¨¡å¼é€‰æ‹©åŒºåŸŸ
    - [ ] å¦‚æœé€‰æ‹©"å›å½’ä¼°è®¡"
    - [ ] æ˜¾ç¤ºå½“å‰æ ·æœ¬æ•°ï¼š`æ ·æœ¬å……åˆ† (12ä¸ª) / æ ·æœ¬ä¸è¶³ (1ä¸ª)`

- [ ] ä¿®æ”¹ Storeï¼ˆtranslate.store.tsï¼‰
  - [ ] ä»»åŠ¡è¿›å…¥ 'waiting' å‰è°ƒç”¨é¢„ä¼°
  - [ ] å°†é¢„ä¼°å€¼å­˜å‚¨åœ¨ä»»åŠ¡çš„ predictedTokens å­—æ®µ

**éªŒè¯**
- [ ] æ‰‹åŠ¨å®Œæˆ5ä¸ªä»»åŠ¡
- [ ] è§‚å¯Ÿåç»­ä»»åŠ¡çš„é¢„ä¼°å‡†ç¡®åº¦
- [ ] éªŒè¯æ ·æœ¬ä¸è¶³æ—¶æ˜¯å¦é™çº§åˆ°å…¶ä»–æ¨¡å¼

---

### **Phase 6ï¸âƒ£ : ç±»å‹ç³»ç»Ÿå’Œæ–‡æ¡£æ›´æ–°**

**ç±»å‹å®šä¹‰**
- [ ] æ–°å¢ `types/scheduler.ts` æ–‡ä»¶
  - [ ] å®šä¹‰ `SchedulerConfig` interface
    ```typescript
    export interface SchedulerConfig {
      maxConcurrency: number
      taskTimeoutSeconds: number
      streamNoDataTimeoutSeconds: number
      throttleProbeIntervalSeconds: number
      throttleProbeType: 'quick' | 'api'
      autoRetryThrottled: boolean
      schedulingStrategy: 'timed' | 'event'
    }
    ```
  - [ ] å®šä¹‰ `SchedulerStatus` enum
  - [ ] å®šä¹‰ `ThrottleProbeMode` type
  - [ ] å®šä¹‰ `SchedulingStrategy` type

- [ ] ä¿®æ”¹ `types/config.ts`
  - [ ] æ‰©å±• `TranslateConfig` interface
    - [ ] æ–°å¢å¯é€‰å­—æ®µï¼š`schedulerConfig?: SchedulerConfig`

- [ ] ä¿®æ”¹ `types/index.ts`
  - [ ] å¯¼å‡º scheduler.ts ä¸­çš„æ‰€æœ‰ç±»å‹

- [ ] æ–°å¢ `backend/scheduler.ts` æ–‡ä»¶ï¼ˆåç«¯ç‹¬æœ‰ï¼‰
  - [ ] å®šä¹‰ `SchedulerOptions` interface
  - [ ] å®šä¹‰ `TokenRegressionSample` interface
  - [ ] å®šä¹‰å†…éƒ¨ä½¿ç”¨çš„çŠ¶æ€ç±»å‹

- [ ] ä¿®æ”¹ `backend/events.ts`
  - [ ] æ–°å¢ `ThrottleRecoveredEvent` interface
  - [ ] æ–°å¢ `ThrottleTestResultEvent` interface
  - [ ] æ–°å¢ `SchedulerStatusChangedEvent` interface

- [ ] ä¿®æ”¹ `client/index.ts`
  - [ ] è½¬å‘å‰ç«¯çš„ `SchedulerConfig`
    ```typescript
    export type { SchedulerConfig } from '@demo/LlmTranslate/types/scheduler'
    ```
  - [ ] è½¬å‘å…¶ä»–schedulerç›¸å…³ç±»å‹

**æ–‡æ¡£æ›´æ–°**
- [ ] æ›´æ–°ç°æœ‰çš„ç±»å‹é€šç”¨è§„èŒƒæ–‡æ¡£
  - [ ] æ·»åŠ  scheduler ç±»å‹çš„åˆ†å±‚è¯´æ˜
  - [ ] è¯´æ˜å‰ç«¯â†”åç«¯çš„ç±»å‹è½¬å‘å…³ç³»

- [ ] åœ¨é¡¹ç›®è®¡åˆ’æ–‡æ¡£ä¸­
  - [ ] æ•´åˆæœ¬æ¬¡æ–°åŠŸèƒ½çš„å®Œæ•´è§„åˆ’
  - [ ] å»ºç«‹ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»
  - [ ] é¢„ä¼°å„é˜¶æ®µçš„å·¥ä½œé‡

---

## ğŸ“Œ **ç±»å‹ç³»ç»Ÿéµå¾ªçš„è§„èŒƒ**

æ ¹æ®ã€Šç±»å‹é€šç”¨è§„èŒƒ.mdã€‹ï¼Œæ‰€æœ‰æ–°å¢ç±»å‹åº”æ»¡è¶³ï¼š

```
âœ… å‰ç«¯ç±»å‹ä½ç½®
   Client/GUI/DemoPage/LlmTranslate/types/
   â”œâ”€ config.ts      (æ‰©å±• SchedulerConfig)
   â”œâ”€ scheduler.ts   (æ–°å¢)
   â””â”€ index.ts       (ç»Ÿä¸€å¯¼å‡º)

âœ… åç«¯å¯¼å…¥æ–¹å¼
   src-electron/types/LlmTranslate/
   â”œâ”€ client/index.ts (åˆ«åè½¬å‘å‰ç«¯ç±»å‹)
   â””â”€ backend/
      â”œâ”€ events.ts    (åç«¯äº‹ä»¶ï¼‰
      â””â”€ scheduler.ts (åç«¯ç‹¬æœ‰çš„schedulerç±»å‹)

âœ… Serviceå¯¼å…¥è§„èŒƒ
   import type { SchedulerConfig, ... } 
     from '../../types/LlmTranslate'
   // è¿™æ ·å¯¼å…¥çš„æ˜¯åˆ«åè½¬å‘çš„å‰ç«¯å®šä¹‰
```

---

## âœ… **åˆ†ææ€»ç»“**

ç”¨æˆ·çš„éœ€æ±‚æ¶‰åŠ**ä¸‰ä¸ªæ­£äº¤çš„åŠŸèƒ½æ¨¡å—**ï¼Œä½†éƒ½èƒ½åœ¨ç°æœ‰æ¶æ„åŸºç¡€ä¸Šä¼˜é›…åœ°é›†æˆï¼š

1. **Tokené¢„ä¼°** â†’ è½»é‡çº§ç»Ÿè®¡æ¨¡å—ï¼Œä¸å½±å“ç°æœ‰æµç¨‹
2. **æ‰¹é‡è°ƒåº¦** â†’ ä¸Šå±‚ç¼–æ’å±‚ï¼Œå¤ç”¨ç°æœ‰executorå’Œäº‹ä»¶ç³»ç»Ÿ
3. **é™æµæ¢å¤** â†’ å¹¶å‘æ§åˆ¶è¡¥é›†ï¼Œä¸è°ƒåº¦å™¨ç´§å¯†åä½œ

**æ ¸å¿ƒè®¾è®¡å“²å­¦**ï¼šæœ€å°åŒ–ç°æœ‰ä»£ç æ”¹åŠ¨ï¼Œåˆ©ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„çš„ä¼˜åŠ¿ï¼Œå°†æ–°åŠŸèƒ½ä½œä¸ºä¸Šå±‚ç»„ä»¶è€Œéä¿®æ”¹ä¸‹å±‚é€»è¾‘ã€‚