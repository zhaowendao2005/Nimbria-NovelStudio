# StandaloneWindowShell - 独立窗口壳子

## 📝 概述

`StandaloneWindowShell` 是一个通用的**纯净独立窗口壳子**组件，为需要独立窗口的业务场景提供统一的外壳。

## ✨ 特点

- ✅ **完全无状态**：不持有任何业务逻辑
- ✅ **完全独立**：每个使用它的业务窗口状态完全独立
- ✅ **统一标题栏**：提供 Nimbria 标准标题栏（最小化、最大化、关闭）
- ✅ **可拖拽外壳**：支持窗口拖拽
- ✅ **纯净内容槽**：业务组件完全控制内容区域

## 🎯 使用场景

适用于需要创建独立Electron窗口的场景：

- 数据可视化窗口（如 Sigma.js 图表）
- 独立的工具面板
- 预览窗口
- 任何需要独立窗口的业务场景

## 📖 使用示例

### 1. 创建路由

```typescript
// router/routes.ts
{
  path: '/my-window',
  name: 'my-window',
  component: () => import('components/MyBusinessWindow.vue'),
  meta: {
    title: '我的窗口',
    requiresAuth: false
  }
}
```

### 2. 创建业务组件

```vue
<!-- components/MyBusinessWindow.vue -->
<template>
  <StandaloneWindowShell title="我的业务窗口">
    <!-- 业务内容：完全独立控制 -->
    <div class="my-business-content">
      <h1>我的业务内容</h1>
      <!-- 你的业务逻辑 -->
    </div>
  </StandaloneWindowShell>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import StandaloneWindowShell from '@pages/StandaloneWindowShell.vue'

// 你的业务逻辑
const data = ref([])

onMounted(() => {
  // 初始化你的业务数据
})
</script>

<style scoped lang="scss">
.my-business-content {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  // 你的样式
}
</style>
```

### 3. 创建IPC Handler打开窗口

```typescript
// src-electron/ipc/main-renderer/my-handlers.ts
import { ipcMain, BrowserWindow, app } from 'electron'
import path from 'path'

function resolvePreloadPath(): string {
  const isDev = !!process.env.DEV || !!process.env.DEBUGGING
  if (isDev) {
    return path.join(app.getAppPath(), 'preload', 'project-preload.cjs')
  }
  const preloadFolder = process.env.QUASAR_ELECTRON_PRELOAD_FOLDER || 'electron-preload'
  const preloadExtension = process.env.QUASAR_ELECTRON_PRELOAD_EXTENSION || '.cjs'
  return path.join(app.getAppPath(), preloadFolder, `project-preload${preloadExtension}`)
}

export function registerMyHandlers(): void {
  ipcMain.handle('my:open-window', async (event, request) => {
    try {
      const myWindow = new BrowserWindow({
        width: 1200,
        height: 800,
        title: '我的窗口',
        titleBarStyle: 'hidden',
        backgroundColor: '#1e1e1e',
        webPreferences: {
          contextIsolation: true,
          nodeIntegration: false,
          preload: resolvePreloadPath()
        },
        parent: BrowserWindow.fromWebContents(event.sender) || undefined
      })

      const params = new URLSearchParams({
        data: encodeURIComponent(JSON.stringify(request.data))
      })

      if (process.env.DEV) {
        await myWindow.loadURL(`${process.env.APP_URL}/#/my-window?${params}`)
      } else {
        await myWindow.loadFile('index.html', {
          hash: `/my-window?${params}`
        })
      }

      return { success: true, windowId: myWindow.id }
    } catch (error) {
      return { success: false, error: { message: (error as Error).message } }
    }
  })
}
```

## 📋 Props

| 名称 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| title | string | 'Nimbria' | 窗口标题 |

## 🎨 插槽

| 名称 | 说明 |
|------|------|
| default | 业务内容区域，完全由业务组件控制 |

## 💡 注意事项

1. **状态管理**：所有业务状态由业务组件自己管理，不要依赖 StandaloneWindowShell
2. **样式控制**：内容区域的样式完全由业务组件控制
3. **生命周期**：业务组件的生命周期钩子正常使用
4. **完全独立**：每个窗口实例完全独立，互不影响

## 📦 已有使用示例

- `LinkNodeViewWindow.vue` - 链接节点可视化窗口

